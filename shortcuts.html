<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Microsoft Office Shortcuts Hub â€“ Master Your Productivity</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');

:root {
  --bg-gradient-start: #0f172a;
  --bg-gradient-end: #1e293b;
  --card-bg: #ffffff;
  --card-hover: #f8fafc;
  --text-primary: #0f172a;
  --text-secondary: #64748b;
  --shadow: rgba(15, 23, 42, 0.08);
  --shadow-hover: rgba(15, 23, 42, 0.16);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 25%, #d946ef 50%, #f97316 75%, #fb923c 100%);
  background-attachment: fixed;
  color: #fff;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  overflow-x: hidden;
}

/* Animated background particles */
.bg-particles {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  opacity: 0.1;
}

.particle {
  position: absolute;
  background: white;
  border-radius: 50%;
  animation: float 20s infinite ease-in-out;
}

@keyframes float {
  0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
  50% { transform: translate(50px, -50px) scale(1.2); opacity: 0.6; }
}

/* Header Section */
.hero {
  text-align: center;
  padding: 40px 20px 30px;
  position: relative;
  z-index: 15000;
  animation: fadeInDown 0.8s ease-out;
}

.hero h1 {
  font-size: 42px;
  font-weight: 900;
  margin-bottom: 12px;
  color: #ffffff;
  letter-spacing: -1.5px;
  text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.hero p {
  font-size: 16px;
  opacity: 0.95;
  max-width: 650px;
  margin: 0 auto 16px;
  line-height: 1.5;
  font-weight: 400;
}

/* Search Container */
.search-container {
  max-width: 650px;
  margin: 20px auto 0;
  position: relative;
  z-index: 20000;
}

.search-box {
  position: relative;
  width: 100%;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 8px 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.3);
  transition: all 0.3s ease;
}

.search-box:focus-within {
  box-shadow: 0 12px 48px rgba(102, 126, 234, 0.4);
  border-color: #667eea;
  transform: translateY(-2px);
}

.search-icon {
  color: #667eea;
  flex-shrink: 0;
}

#searchInput {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  font-size: 16px;
  color: #0f172a;
  font-weight: 500;
  padding: 12px 0;
}

#searchInput::placeholder {
  color: #94a3b8;
}

.clear-btn {
  background: rgba(239, 68, 68, 0.1);
  border: none;
  color: #ef4444;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.clear-btn:hover {
  background: rgba(239, 68, 68, 0.2);
  transform: scale(1.1);
}

/* Search Results */
.search-results {
  position: absolute;
  top: calc(100% + 12px);
  left: 0;
  right: 0;
  background: white;
  border-radius: 16px;
  box-shadow: 0 12px 48px rgba(0, 0, 0, 0.25);
  max-height: 500px;
  overflow-y: auto;
  z-index: 25000;
  animation: slideDown 0.3s ease;
}

/* Ensure search results text is dark (overrides body white) */
.search-results,
.search-results .search-result-group,
.search-results .search-result-item,
.search-results .search-result-item span,
.search-results .search-result-program,
.search-results .search-result-program-icon {
  color: var(--text-primary) !important;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.search-result-group {
  padding: 20px;
  border-bottom: 1px solid rgba(100, 116, 139, 0.1);
}

.search-result-group:last-child {
  border-bottom: none;
}

.search-result-program {
  font-size: 18px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.search-result-program-icon {
  width: 24px;
  height: 24px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 800;
  color: white;
}

/* Ensure images used inside search result icons fit nicely */
.search-result-program-img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 6px;
  display: block;
}

/* Make the key badge and description fit on a single line where possible
   Use ellipsis if text is too long. Reduce min-width so items don't force wrapping. */
.search-result-item strong {
  min-width: 90px;
  font-size: 11px;
  padding: 4px 8px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.search-result-item span {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 13px;
}

.search-result-item {
  padding: 10px 12px;
  margin-bottom: 6px;
  background: rgba(102, 126, 234, 0.05);
  border-radius: 8px;
  border-left: 3px solid;
  transition: all 0.2s ease;
  cursor: pointer;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 10px;
}

.search-result-item:hover {
  background: rgba(102, 126, 234, 0.1);
  transform: translateX(4px);
}

.search-result-item strong {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  padding: 3px 10px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 700;
  min-width: 120px;
  text-align: center;
  flex-shrink: 0;
}

.search-result-item span {
  text-align: left;
  flex: 1;
}

.no-results {
  padding: 40px 20px;
  text-align: center;
  color: #64748b;
}

.no-results-icon {
  font-size: 48px;
  margin-bottom: 12px;
  opacity: 0.5;
}

.stats-bar {
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.stat-item {
  text-align: center;
}

.stat-number {
  font-size: 28px;
  font-weight: 800;
  display: block;
  color: white;
}

.stat-label {
  font-size: 13px;
  color: #000000;
  opacity: 0.85;
  margin-top: 3px;
}

/* Mobile: ensure stats text is readable on top of hero background */
@media (max-width: 700px) {
  .stats-bar .stat-number,
  .stats-bar .stat-label {
    color: #fff !important;
    text-shadow: 0 1px 2px rgba(0,0,0,0.4);
  }
}

/* Container */
.container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  position: relative;
  z-index: 10;
}

/* Back Button */
.back-button {
  position: fixed;
  top: 20px;
  left: 20px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  color: #0f172a;
  text-decoration: none;
  padding: 12px 24px;
  border-radius: 12px;
  font-weight: 700;
  font-size: 15px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 100;
  border: 2px solid rgba(102, 126, 234, 0.2);
}

.back-button:hover {
  transform: translateX(-4px) translateY(-2px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
  background: white;
}

/* Programs Grid */
.programs-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  padding: 15px;
  align-items: start;
  max-width: 1200px;
  margin: 0 auto;
}

/* Program Cards */
.program-card {
  position: relative;
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(20px);
  border-radius: 16px;
  padding: 20px 18px;
  cursor: pointer;
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease, border-color 0.3s ease;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  border: 2px solid rgba(255, 255, 255, 0.3);
  min-height: 220px;
  overflow: visible;
  animation: fadeInUp 0.8s ease-out backwards;
  will-change: transform;
}

.program-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 6px;
  background: linear-gradient(90deg, var(--program-color), var(--program-color-light));
  opacity: 0;
  transition: opacity 0.4s ease;
}

.program-card:hover::before {
  opacity: 1;
}

.program-card:nth-child(1) { animation-delay: 0.1s; }
.program-card:nth-child(2) { animation-delay: 0.2s; }
.program-card:nth-child(3) { animation-delay: 0.3s; }
.program-card:nth-child(4) { animation-delay: 0.4s; }
.program-card:nth-child(5) { animation-delay: 0.5s; }
.program-card:nth-child(6) { animation-delay: 0.6s; }

.program-card:hover:not(.locked) {
  transform: translateY(-8px);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
  border-color: rgba(102, 126, 234, 0.3);
}

.program-card:focus {
  outline: 3px solid rgba(102, 126, 234, 0.4);
  transform: translateY(-8px);
}

.program-card.locked {
  transform: none !important;
}

/* Icon */
.program-icon-wrapper {
  width: 60px;
  height: 60px;
  margin: 0 auto 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.program-icon-fallback {
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: 900;
  background: linear-gradient(135deg, var(--program-color), var(--program-color-light));
  border-radius: 16px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
  color: white;
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  overflow: hidden;
}

.program-icon-fallback::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transform: rotate(45deg);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

.program-card:hover .program-icon-fallback {
  transform: scale(1.15) rotate(5deg);
}

/* Actual Icon Image */
.program-icon-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15));
}

.program-card:hover .program-icon-image {
  transform: scale(1.15) rotate(5deg);
}

/* Text Content */
.program-name {
  text-align: center;
  font-size: 22px;
  font-weight: 800;
  margin: 0 0 6px;
  color: var(--text-primary);
  letter-spacing: -0.3px;
}

.program-tagline {
  text-align: center;
  color: var(--text-secondary);
  font-size: 13px;
  margin: 0 0 12px;
  font-weight: 500;
}

.hover-instruction {
  text-align: center;
  color: #475569;
  font-size: 11px;
  margin-top: 10px;
  font-style: normal;
  font-weight: 600;
  opacity: 1;
  transition: opacity 0.3s ease;
  background: rgba(102, 126, 234, 0.08);
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid rgba(102, 126, 234, 0.15);
}

.program-card:hover .hover-instruction {
  opacity: 0.4;
}

/* Shortcut Count Badge */
.shortcut-count {
  display: inline-block;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
  color: #667eea;
  padding: 4px 10px;
  border-radius: 16px;
  font-size: 11px;
  font-weight: 700;
  margin: 8px auto 0;
  border: 2px solid rgba(102, 126, 234, 0.2);
}

/* Center utility */
.center { text-align: center; }

/* View Shortcuts Button */
.view-shortcuts {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  border: none;
  padding: 14px 28px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 700;
  font-size: 15px;
  margin-top: 16px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
  position: relative;
  overflow: hidden;
}

.view-shortcuts::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
}

.view-shortcuts:hover::before {
  width: 300px;
  height: 300px;
}

.view-shortcuts:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
}

.view-shortcuts:focus {
  outline: 3px solid rgba(102, 126, 234, 0.4);
}

/* Cheatsheet Preview */
.cheatsheet {
  margin-top: 14px;
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  padding: 0;
  border-radius: 12px;
  border: 2px solid rgba(100, 116, 139, 0.15);
  font-size: 12px;
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transform-origin: top;
  transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), padding 0.4s ease;
  pointer-events: none;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.cheatsheet ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.cheatsheet li {
  padding: 7px 12px;
  border-bottom: 1px solid rgba(100, 116, 139, 0.1);
  color: var(--text-primary);
  font-size: 12px;
  line-height: 1.4;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: background 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.cheatsheet li:hover {
  background: rgba(102, 126, 234, 0.05);
}

.cheatsheet li:last-child {
  border-bottom: none;
}

.cheatsheet li strong {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 700;
  min-width: 110px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(102, 126, 234, 0.25);
  flex-shrink: 0;
  letter-spacing: 0.3px;
}

/* Reveal cheatsheet on hover/focus */
.program-card:hover .cheatsheet,
.program-card:focus .cheatsheet,
.program-card.focused .cheatsheet {
  max-height: 600px;
  opacity: 1;
  padding: 12px;
  pointer-events: auto;
}

/* Locked/Expanded state shows ALL shortcuts */
.program-card.locked .cheatsheet {
  max-height: 3000px !important;
  opacity: 1 !important;
  padding: 20px !important;
  pointer-events: auto !important;
}

.program-card.locked {
  position: relative;
  grid-column: 1 / -1;
  max-width: 100%;
  transition: all 0.35s ease;
}

.program-card.locked::after {
  content: 'ðŸ“Œ Pinned - Click to unpin';
  position: absolute;
  top: 12px;
  right: 12px;
  background: linear-gradient(135deg, #10b981, #059669);
  color: white;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 700;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
  z-index: 10;
}

/* Category sections in locked state */
.shortcut-category {
  background: rgba(255, 255, 255, 0.7);
  border-radius: 14px;
  padding: 16px;
  border: 2px solid rgba(102, 126, 234, 0.15);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  transition: all 0.2s ease;
}

.shortcut-category:hover {
  border-color: rgba(102, 126, 234, 0.3);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.shortcut-category ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.shortcut-category li {
  padding: 10px 14px;
}

.category-title {
  font-size: 15px;
  font-weight: 800;
  color: #4c51bf;
  margin-bottom: 12px;
  padding: 10px 14px;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.1));
  border-radius: 10px;
  border-left: 5px solid #667eea;
  box-shadow: 0 2px 6px rgba(102, 126, 234, 0.1);
}

.program-card.locked .locked-list {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 16px;
}

.program-card.locked .hover-list {
  display: none !important;
}

.shortcut-count-display {
  text-align: center;
  padding: 8px;
  background: rgba(102, 126, 234, 0.1);
  border-radius: 8px;
  margin: 8px 0;
  font-size: 11px;
  font-weight: 700;
  color: #667eea;
}

/* Modal */
.ps-modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.85);
  backdrop-filter: blur(8px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: fadeIn 0.3s ease;
}

.ps-modal-backdrop.visible {
  display: flex;
}

.ps-modal {
  background: white;
  border-radius: 24px;
  padding: 32px;
  width: min(900px, 94%);
  max-height: 88vh;
  overflow-y: auto;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(40px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.ps-modal h3 {
  margin: 0 0 24px;
  font-size: 32px;
  font-weight: 800;
  color: var(--text-primary);
  padding-right: 120px;
}

.ps-modal .close-btn {
  position: absolute;
  top: 24px;
  right: 24px;
  background: linear-gradient(135deg, #ef4444, #dc2626);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 700;
  font-size: 14px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}

.ps-modal .close-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
}

.ps-modal .cat {
  margin-top: 28px;
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  padding: 24px;
  border-radius: 16px;
  border-left: 6px solid;
}

.ps-modal .cat:nth-child(1) { border-left-color: #3b82f6; }
.ps-modal .cat:nth-child(2) { border-left-color: #8b5cf6; }
.ps-modal .cat:nth-child(3) { border-left-color: #ec4899; }
.ps-modal .cat:nth-child(4) { border-left-color: #f59e0b; }

.ps-modal .cat h4 {
  margin: 0 0 16px;
  font-size: 20px;
  font-weight: 700;
  color: var(--text-primary);
}

.ps-modal .cat ul {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
}

.ps-modal .cat li {
  background: white;
  padding: 12px 16px;
  border-radius: 10px;
  border: 2px solid rgba(100, 116, 139, 0.1);
  transition: all 0.3s ease;
}

.ps-modal .cat li:hover {
  border-color: rgba(102, 126, 234, 0.3);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
  transform: translateX(4px);
}

.ps-modal .cat li strong {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  padding: 4px 12px;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 700;
  display: inline-block;
  margin-right: 12px;
  min-width: 140px;
  text-align: center;
}

/* Animations */
@keyframes fadeInDown {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Scrollbar Styling */
.ps-modal::-webkit-scrollbar {
  width: 10px;
}

.ps-modal::-webkit-scrollbar-track {
  background: #f1f5f9;
  border-radius: 10px;
}

.ps-modal::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, #667eea, #764ba2);
  border-radius: 10px;
}

.ps-modal::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, #5a6fd8, #6a42a0);
}

/* Tablet Responsive (2 columns) */
@media (max-width: 1024px) and (min-width: 769px) {
  .programs-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 18px;
    max-width: 800px;
  }
}

/* Mobile Responsive (1 column) */
@media (max-width: 768px) {
  .hero {
    padding: 30px 15px 25px;
  }

  .hero h1 {
    font-size: 28px;
    letter-spacing: -0.5px;
    color: #ffffff;
  }

  .hero p {
    font-size: 14px;
  }

  .search-container {
    margin: 16px auto 0;
    padding: 0 10px;
  }

  .search-box {
    padding: 6px 14px;
  }

  #searchInput {
    font-size: 14px;
    padding: 8px 0;
  }

  #searchInput::placeholder {
    font-size: 13px;
  }

  .search-results {
    max-height: 400px;
  }

  .search-result-group {
    padding: 14px;
  }

  .search-result-item {
    /* keep search items on one line on mobile where possible */
    flex-direction: row;
    align-items: center;
    gap: 8px;
  }

  .search-result-item strong {
    min-width: 80px;
    font-size: 10px;
    padding: 4px 8px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .stats-bar {
    gap: 16px;
    margin-top: 16px;
  }

  .stat-number {
    font-size: 24px;
    color: #000000;
  }

  .stat-label {
    font-size: 12px;
    color: #000000;
  }

  .programs-grid {
    grid-template-columns: 1fr;
    gap: 16px;
    padding: 10px;
    max-width: 100%;
  }

  .program-card {
    min-height: auto;
    padding: 18px 16px;
  }

  .program-icon-wrapper {
    width: 50px;
    height: 50px;
    margin: 0 auto 12px;
  }

  .program-icon-fallback {
    width: 50px;
    height: 50px;
    font-size: 24px;
  }

  .program-name {
    font-size: 20px;
  }

  .program-tagline {
    font-size: 12px;
  }

  .shortcut-count {
    font-size: 10px;
    padding: 3px 8px;
  }

  .hover-instruction {
    font-size: 10px;
    padding: 5px 8px;
  }

  .program-card.locked {
    grid-column: 1;
  }

  .program-card.locked .locked-list {
    grid-template-columns: 1fr !important;
    gap: 12px;
  }

  .program-card.locked::after {
    font-size: 9px;
    padding: 4px 8px;
    top: 8px;
    right: 8px;
  }

  .cheatsheet li {
    padding: 6px 10px;
    font-size: 11px;
  }

  .cheatsheet li strong {
    min-width: 100px;
    font-size: 10px;
    padding: 3px 8px;
  }

  .category-title {
    font-size: 12px;
    padding: 8px 10px;
  }

  .shortcut-category {
    padding: 12px;
  }

  .ps-modal {
    padding: 20px;
    border-radius: 16px;
  }

  .ps-modal h3 {
    font-size: 22px;
    padding-right: 90px;
  }

  .ps-modal .cat ul {
    grid-template-columns: 1fr;
  }

  .back-button {
    top: 10px;
    left: 10px;
    padding: 8px 16px;
    font-size: 13px;
  }

  .view-shortcuts {
    padding: 10px 20px;
    font-size: 13px;
  }
}

/* Small Mobile (extra small screens) */
@media (max-width: 480px) {
  .hero h1 {
    font-size: 24px;
    color: #ffffff;
  }

  .hero p {
    font-size: 13px;
  }

  .search-box {
    padding: 5px 12px;
  }

  .stat-number {
    font-size: 20px;
    color: #000000;
  }

  .programs-grid {
    gap: 12px;
    padding: 8px;
  }

  .program-card {
    padding: 16px 12px;
  }

  .program-name {
    font-size: 18px;
  }
}
</style>
</head>
<body>
  <!-- Background Particles -->
  <div class="bg-particles" id="particles"></div>
  
  <!-- Back button removed per user request -->
  
  <!-- Hero Section -->
  <div class="hero">
    <h1>âš¡ Microsoft Office Shortcuts Hub</h1>
    
    <!-- Search Bar -->
    <div class="search-container">
      <div class="search-box">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" id="searchInput" placeholder="Search shortcuts... (e.g., 'copy', 'bold', 'save')" />
        <button id="clearSearch" class="clear-btn" style="display: none;">âœ•</button>
      </div>
      <div id="searchResults" class="search-results" style="display: none;"></div>
    </div>
    
    <div class="stats-bar">
      <div class="stat-item">
        <span class="stat-number">580+</span>
        <span class="stat-label">Shortcuts</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">6</span>
        <span class="stat-label">Applications</span>
      </div>
     
    </div>
  </div>

  <div class="container">
    <div class="programs-grid" id="programsGrid" aria-live="polite"></div>
  </div>

  <!-- Modal -->
  <div class="ps-modal-backdrop" id="modal">
    <div class="ps-modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <button class="close-btn" id="closeModal" aria-label="Close">Close</button>
      <h3 id="modalTitle">Shortcuts</h3>
      <div id="modalBody"></div>
    </div>
  </div>

<script>
// ---------- Enhanced Data with Comprehensive Shortcuts -----------------------------------------------------------
const PROGRAMS = [
  {
    id: 'excel',
    name: 'Excel',
    tagline: 'Spreadsheet Mastery',
    iconText: 'X',
    iconUrl: 'https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/6d9d66e75fc9e5ce7b9d79a3f0da91c8def27cab/icons/2025%20Excel%20Icon.png',
    color: '#107c41',
    colorLight: '#1a9850',
    shortcuts: [
      // Basic
      { key: 'Ctrl + N', desc: 'New workbook' },
      { key: 'Ctrl + O', desc: 'Open workbook' },
      { key: 'Ctrl + S', desc: 'Save' },
      { key: 'Ctrl + W', desc: 'Close workbook' },
      { key: 'Ctrl + P', desc: 'Print' },
      { key: 'Ctrl + Z', desc: 'Undo' },
      { key: 'Ctrl + Y', desc: 'Redo' },
      { key: 'Ctrl + C', desc: 'Copy' },
      { key: 'Ctrl + X', desc: 'Cut' },
      { key: 'Ctrl + V', desc: 'Paste' },
      { key: 'Ctrl + Alt + V', desc: 'Paste Special' },
      { key: 'Ctrl + F', desc: 'Find' },
      { key: 'Ctrl + H', desc: 'Find & Replace' },
      
      // Navigation
      { key: 'Ctrl + Home', desc: 'Go to A1' },
      { key: 'Ctrl + End', desc: 'Go to last used cell' },
      { key: 'Ctrl + Arrow', desc: 'Jump to edge of data' },
      { key: 'Ctrl + PgUp', desc: 'Previous sheet' },
      { key: 'Ctrl + PgDn', desc: 'Next sheet' },
      { key: 'Alt + PgUp', desc: 'Move one screen left' },
      { key: 'Alt + PgDn', desc: 'Move one screen right' },
      { key: 'Ctrl + Backspace', desc: 'Show active cell' },
      { key: 'Ctrl + G', desc: 'Go To dialog' },
      { key: 'F5', desc: 'Go To dialog' },
      
      // Selection
      { key: 'Ctrl + Space', desc: 'Select entire column' },
      { key: 'Shift + Space', desc: 'Select entire row' },
      { key: 'Ctrl + A', desc: 'Select all' },
      { key: 'Ctrl + Shift + Arrow', desc: 'Extend selection' },
      { key: 'Shift + Arrow', desc: 'Extend selection by one cell' },
      { key: 'Ctrl + Shift + Home', desc: 'Select to beginning' },
      { key: 'Ctrl + Shift + End', desc: 'Select to end' },
      
      // Editing
      { key: 'F2', desc: 'Edit cell' },
      { key: 'Alt + Enter', desc: 'New line in cell' },
      { key: 'Ctrl + D', desc: 'Fill down' },
      { key: 'Ctrl + R', desc: 'Fill right' },
      { key: 'Ctrl + -', desc: 'Delete cells' },
      { key: 'Ctrl + Shift + +', desc: 'Insert cells' },
      { key: 'Ctrl + K', desc: 'Insert hyperlink' },
      { key: 'Ctrl + ;', desc: 'Insert current date' },
      { key: 'Ctrl + Shift + :', desc: 'Insert current time' },
      { key: 'Ctrl + \'', desc: 'Copy formula from above' },
      { key: 'Ctrl + "', desc: 'Copy value from above' },
      
      // Formatting
      { key: 'Ctrl + 1', desc: 'Format Cells dialog' },
      { key: 'Ctrl + B', desc: 'Bold' },
      { key: 'Ctrl + I', desc: 'Italic' },
      { key: 'Ctrl + U', desc: 'Underline' },
      { key: 'Ctrl + 5', desc: 'Strikethrough' },
      { key: 'Ctrl + Shift + &', desc: 'Apply outline border' },
      { key: 'Ctrl + Shift + _', desc: 'Remove borders' },
      { key: 'Ctrl + Shift + $', desc: 'Currency format' },
      { key: 'Ctrl + Shift + %', desc: 'Percentage format' },
      { key: 'Ctrl + Shift + #', desc: 'Date format' },
      { key: 'Ctrl + Shift + @', desc: 'Time format' },
      { key: 'Ctrl + Shift + !', desc: 'Number format' },
      
      // Formulas & Functions
      { key: 'Alt + =', desc: 'AutoSum' },
      { key: 'Shift + F3', desc: 'Insert function' },
      { key: 'Ctrl + Shift + A', desc: 'Insert function arguments' },
      { key: 'F4', desc: 'Toggle absolute reference' },
      { key: 'Ctrl + `', desc: 'Show/hide formulas' },
      { key: 'Ctrl + [', desc: 'Select precedent cells' },
      { key: 'Ctrl + ]', desc: 'Select dependent cells' },
      { key: 'F9', desc: 'Calculate all worksheets' },
      { key: 'Shift + F9', desc: 'Calculate active sheet' },
      
      // Data & Tables
      { key: 'Ctrl + T', desc: 'Create table' },
      { key: 'Ctrl + Shift + L', desc: 'Toggle filters' },
      { key: 'Alt + Down Arrow', desc: 'Open filter dropdown' },
      { key: 'Ctrl + Shift + O', desc: 'Select cells with comments' },
      { key: 'Alt + H + S + S', desc: 'Sort ascending' },
      { key: 'Alt + D + S', desc: 'Sort dialog' },
      
      // Rows & Columns
      { key: 'Ctrl + 9', desc: 'Hide rows' },
      { key: 'Ctrl + Shift + 9', desc: 'Unhide rows' },
      { key: 'Ctrl + 0', desc: 'Hide columns' },
      { key: 'Ctrl + Shift + 0', desc: 'Unhide columns' },
      { key: 'Alt + H + O + I', desc: 'Auto-fit column width' },
      { key: 'Alt + H + O + A', desc: 'Auto-fit row height' },
      
      // Workbook & Windows
      { key: 'Ctrl + Tab', desc: 'Switch between workbooks' },
      { key: 'Ctrl + F6', desc: 'Next workbook window' },
      { key: 'Ctrl + Shift + F6', desc: 'Previous workbook window' },
      { key: 'Alt + F4', desc: 'Close Excel' },
      { key: 'Ctrl + F9', desc: 'Minimize workbook' },
      { key: 'Ctrl + F10', desc: 'Maximize/restore workbook' },
      
      // Charts & Objects
      { key: 'Alt + F1', desc: 'Create chart' },
      { key: 'F11', desc: 'Create chart in new sheet' },
      { key: 'Ctrl + Shift + U', desc: 'Expand/collapse formula bar' },
      { key: 'Alt + F8', desc: 'Macro dialog' },
      { key: 'Alt + F11', desc: 'Visual Basic Editor' },
      { key: 'Ctrl + F3', desc: 'Name Manager' },
      { key: 'Shift + F11', desc: 'Insert new worksheet' },
      
      // Pivot Tables
      { key: 'Alt + Shift + Right', desc: 'Group pivot items' },
      { key: 'Alt + Shift + Left', desc: 'Ungroup pivot items' },
      { key: 'Ctrl + -', desc: 'Hide pivot field' },
      
      // Special Functions
      { key: 'Ctrl + Shift + Enter', desc: 'Array formula' },
      { key: 'F3', desc: 'Paste name into formula' },
      { key: 'Ctrl + A', desc: 'Insert arguments in formula' },
      { key: 'Shift + F2', desc: 'Edit cell comment' },
      { key: 'Ctrl + Shift + O', desc: 'Select commented cells' },
      
      // View & Display
      { key: 'Ctrl + F1', desc: 'Show/hide ribbon' },
      { key: 'Alt + W + F + F', desc: 'Freeze panes' },
      { key: 'Alt + W + F + R', desc: 'Freeze first row' },
      { key: 'Alt + W + F + C', desc: 'Freeze first column' },
      { key: 'Ctrl + Shift + Page Up', desc: 'Select current & left sheets' },
      { key: 'Ctrl + Shift + Page Down', desc: 'Select current & right sheets' }
    ]
  },
  {
    id: 'powerpoint',
    name: 'PowerPoint',
    tagline: 'Presentation Excellence',
    iconText: 'P',
    iconUrl: 'https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/6d9d66e75fc9e5ce7b9d79a3f0da91c8def27cab/icons/2025%20PowerPoint%20Icon.png',
    color: '#d24726',
    colorLight: '#e55835',
    shortcuts: [
      // Basic
      { key: 'Ctrl + N', desc: 'New presentation' },
      { key: 'Ctrl + O', desc: 'Open presentation' },
      { key: 'Ctrl + S', desc: 'Save' },
      { key: 'Ctrl + W', desc: 'Close presentation' },
      { key: 'Ctrl + P', desc: 'Print' },
      { key: 'Ctrl + Z', desc: 'Undo' },
      { key: 'Ctrl + Y', desc: 'Redo' },
      { key: 'Ctrl + C', desc: 'Copy' },
      { key: 'Ctrl + X', desc: 'Cut' },
      { key: 'Ctrl + V', desc: 'Paste' },
      
      // Slides
      { key: 'Ctrl + M', desc: 'New slide' },
      { key: 'Ctrl + D', desc: 'Duplicate slide' },
      { key: 'Ctrl + Shift + D', desc: 'Duplicate slide (alt)' },
      { key: 'Delete', desc: 'Delete slide' },
      { key: 'Alt + Shift + Up', desc: 'Move slide up' },
      { key: 'Alt + Shift + Down', desc: 'Move slide down' },
      { key: 'Ctrl + Enter', desc: 'New slide (same layout)' },
      { key: 'Shift + F11', desc: 'Insert new slide' },
      
      // Slideshow
      { key: 'F5', desc: 'Start from beginning' },
      { key: 'Shift + F5', desc: 'Start from current slide' },
      { key: 'Alt + F5', desc: 'Presenter view' },
      { key: 'N / Enter / Space', desc: 'Next slide (in show)' },
      { key: 'P / Backspace', desc: 'Previous slide (in show)' },
      { key: 'Esc', desc: 'End slideshow' },
      { key: 'B / .', desc: 'Black screen toggle' },
      { key: 'W / ,', desc: 'White screen toggle' },
      { key: 'E', desc: 'Erase screen annotations' },
      { key: 'Ctrl + P', desc: 'Pen tool (in show)' },
      { key: 'Ctrl + A', desc: 'Arrow pointer (in show)' },
      { key: 'Ctrl + H', desc: 'Hide pointer (in show)' },
      { key: 'S', desc: 'Stop/restart automatic show' },
      { key: 'Number + Enter', desc: 'Go to slide number' },
      
      // Formatting
      { key: 'Ctrl + B', desc: 'Bold' },
      { key: 'Ctrl + I', desc: 'Italic' },
      { key: 'Ctrl + U', desc: 'Underline' },
      { key: 'Ctrl + Shift + >', desc: 'Increase font size' },
      { key: 'Ctrl + Shift + <', desc: 'Decrease font size' },
      { key: 'Ctrl + E', desc: 'Center align' },
      { key: 'Ctrl + L', desc: 'Left align' },
      { key: 'Ctrl + R', desc: 'Right align' },
      { key: 'Ctrl + J', desc: 'Justify' },
      { key: 'Ctrl + T', desc: 'Font dialog' },
      
      // Objects
      { key: 'Ctrl + G', desc: 'Group objects' },
      { key: 'Ctrl + Shift + G', desc: 'Ungroup objects' },
      { key: 'Ctrl + Shift + F', desc: 'Format object' },
      { key: 'Ctrl + Shift + C', desc: 'Copy formatting' },
      { key: 'Ctrl + Shift + V', desc: 'Paste formatting' },
      { key: 'Alt + F9', desc: 'Show/hide guides' },
      { key: 'Shift + F9', desc: 'Show/hide grid' },
      { key: 'Arrow keys', desc: 'Move object' },
      { key: 'Ctrl + Arrow', desc: 'Move object 1px' },
      { key: 'Shift + Arrow', desc: 'Resize object' },
      { key: 'Ctrl + Shift + Arrow', desc: 'Resize 1px' },
      
      // Insert
      { key: 'Ctrl + K', desc: 'Insert hyperlink' },
      { key: 'Alt + N + P', desc: 'Insert picture' },
      { key: 'Alt + N + S + H', desc: 'Insert shape' },
      { key: 'Alt + N + X', desc: 'Insert text box' },
      { key: 'Alt + N + T', desc: 'Insert table' },
      { key: 'Alt + N + M', desc: 'Insert SmartArt' },
      { key: 'Alt + N + C', desc: 'Insert chart' },
      
      // Navigation
      { key: 'Ctrl + Home', desc: 'Go to first slide' },
      { key: 'Ctrl + End', desc: 'Go to last slide' },
      { key: 'PgUp', desc: 'Previous slide' },
      { key: 'PgDn', desc: 'Next slide' },
      { key: 'Tab', desc: 'Next object' },
      { key: 'Shift + Tab', desc: 'Previous object' },
      
      // Slide Sorter View
      { key: 'Ctrl + Shift + S', desc: 'Slide Sorter view' },
      { key: 'Ctrl + Shift + N', desc: 'Normal view' },
      { key: 'Alt + V + P', desc: 'Notes Page view' },
      
      // Animation & Transitions
      { key: 'Alt + A + A', desc: 'Add animation' },
      { key: 'Alt + K + T', desc: 'Add transition' },
      { key: 'Shift + F5', desc: 'Preview animation' },
      
      // Master Slides
      { key: 'Shift + Normal View', desc: 'Slide Master view' },
      { key: 'Ctrl + Shift + M', desc: 'Apply slide layout' },
      
      // Selection & Grouping
      { key: 'Ctrl + A', desc: 'Select all objects' },
      { key: 'Tab', desc: 'Cycle through objects' },
      { key: 'Shift + Tab', desc: 'Cycle backwards' },
      { key: 'Ctrl + Shift + G', desc: 'Ungroup' },
      { key: 'Ctrl + Shift + J', desc: 'Distribute horizontally' },
      
      // Text Formatting Advanced
      { key: 'Ctrl + Shift + F', desc: 'Font dialog' },
      { key: 'Ctrl + Shift + P', desc: 'Font size' },
      { key: 'Ctrl + =', desc: 'Subscript' },
      { key: 'Ctrl + Shift + =', desc: 'Superscript' },
      { key: 'Ctrl + Spacebar', desc: 'Remove formatting' },
      
      // Tables
      { key: 'Tab', desc: 'Next table cell' },
      { key: 'Shift + Tab', desc: 'Previous table cell' },
      { key: 'Ctrl + Tab', desc: 'Insert tab in cell' },
      
      // Other
      { key: 'F7', desc: 'Spell check' },
      { key: 'Shift + F7', desc: 'Thesaurus' },
      { key: 'Alt + F10', desc: 'Maximize window' },
      { key: 'F1', desc: 'Help' },
      { key: 'Ctrl + F1', desc: 'Show/hide ribbon' },
      { key: 'Alt + F8', desc: 'Macros' },
      { key: 'Ctrl + F2', desc: 'Print preview' },
      { key: 'F4', desc: 'Repeat last action' }
    ]
  },
  {
    id: 'word',
    name: 'Word',
    tagline: 'Document Perfection',
    iconText: 'W',
    iconUrl: 'https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/6d9d66e75fc9e5ce7b9d79a3f0da91c8def27cab/icons/2025%20Word%20Icon.png',
    color: '#185abd',
    colorLight: '#2b6fd1',
    shortcuts: [
      // Basic
      { key: 'Ctrl + N', desc: 'New document' },
      { key: 'Ctrl + O', desc: 'Open document' },
      { key: 'Ctrl + S', desc: 'Save' },
      { key: 'Ctrl + W', desc: 'Close document' },
      { key: 'Ctrl + P', desc: 'Print' },
      { key: 'Ctrl + Z', desc: 'Undo' },
      { key: 'Ctrl + Y', desc: 'Redo' },
      { key: 'Ctrl + C', desc: 'Copy' },
      { key: 'Ctrl + X', desc: 'Cut' },
      { key: 'Ctrl + V', desc: 'Paste' },
      { key: 'Ctrl + A', desc: 'Select all' },
      { key: 'Ctrl + F', desc: 'Find' },
      { key: 'Ctrl + H', desc: 'Replace' },
      
      // Navigation
      { key: 'Ctrl + Home', desc: 'Go to beginning' },
      { key: 'Ctrl + End', desc: 'Go to end' },
      { key: 'Ctrl + G', desc: 'Go To' },
      { key: 'Ctrl + Right Arrow', desc: 'Next word' },
      { key: 'Ctrl + Left Arrow', desc: 'Previous word' },
      { key: 'Ctrl + Up Arrow', desc: 'Previous paragraph' },
      { key: 'Ctrl + Down Arrow', desc: 'Next paragraph' },
      { key: 'Ctrl + PgUp', desc: 'Top of window' },
      { key: 'Ctrl + PgDn', desc: 'Bottom of window' },
      { key: 'Alt + Ctrl + Home', desc: 'Browse previous' },
      { key: 'Alt + Ctrl + End', desc: 'Browse next' },
      
      // Formatting - Basic
      { key: 'Ctrl + B', desc: 'Bold' },
      { key: 'Ctrl + I', desc: 'Italic' },
      { key: 'Ctrl + U', desc: 'Underline' },
      { key: 'Ctrl + Shift + W', desc: 'Word underline' },
      { key: 'Ctrl + Shift + D', desc: 'Double underline' },
      { key: 'Ctrl + D', desc: 'Font dialog' },
      { key: 'Ctrl + Shift + A', desc: 'All caps' },
      { key: 'Ctrl + Shift + K', desc: 'Small caps' },
      { key: 'Ctrl + =', desc: 'Subscript' },
      { key: 'Ctrl + Shift + =', desc: 'Superscript' },
      { key: 'Ctrl + Shift + >', desc: 'Increase font size' },
      { key: 'Ctrl + Shift + <', desc: 'Decrease font size' },
      { key: 'Ctrl + ]', desc: 'Increase font 1pt' },
      { key: 'Ctrl + [', desc: 'Decrease font 1pt' },
      
      // Formatting - Paragraph
      { key: 'Ctrl + E', desc: 'Center align' },
      { key: 'Ctrl + L', desc: 'Left align' },
      { key: 'Ctrl + R', desc: 'Right align' },
      { key: 'Ctrl + J', desc: 'Justify' },
      { key: 'Ctrl + M', desc: 'Indent paragraph' },
      { key: 'Ctrl + Shift + M', desc: 'Remove indent' },
      { key: 'Ctrl + T', desc: 'Hanging indent' },
      { key: 'Ctrl + Shift + T', desc: 'Remove hanging indent' },
      { key: 'Ctrl + 1', desc: 'Single spacing' },
      { key: 'Ctrl + 2', desc: 'Double spacing' },
      { key: 'Ctrl + 5', desc: '1.5 line spacing' },
      { key: 'Ctrl + 0', desc: 'Add/remove space before' },
      { key: 'Ctrl + Q', desc: 'Remove paragraph formatting' },
      
      // Styles
      { key: 'Ctrl + Shift + N', desc: 'Normal style' },
      { key: 'Ctrl + Alt + 1', desc: 'Heading 1' },
      { key: 'Ctrl + Alt + 2', desc: 'Heading 2' },
      { key: 'Ctrl + Alt + 3', desc: 'Heading 3' },
      { key: 'Ctrl + Shift + L', desc: 'List Bullet style' },
      { key: 'Ctrl + Shift + S', desc: 'Apply Styles pane' },
      { key: 'Ctrl + Shift + Alt + S', desc: 'Styles task pane' },
      
      // Insert
      { key: 'Ctrl + K', desc: 'Insert hyperlink' },
      { key: 'Ctrl + Enter', desc: 'Page break' },
      { key: 'Ctrl + Shift + Enter', desc: 'Column break' },
      { key: 'Shift + Enter', desc: 'Line break' },
      { key: 'Alt + Ctrl + F', desc: 'Footnote' },
      { key: 'Alt + Ctrl + D', desc: 'Endnote' },
      { key: 'Alt + Shift + D', desc: 'Insert DATE field' },
      { key: 'Alt + Shift + T', desc: 'Insert TIME field' },
      { key: 'Alt + Ctrl + C', desc: 'Copyright symbol Â©' },
      { key: 'Alt + Ctrl + R', desc: 'Registered symbol Â®' },
      { key: 'Alt + Ctrl + T', desc: 'Trademark symbol â„¢' },
      
      // Copy Formatting
      { key: 'Ctrl + Shift + C', desc: 'Copy formatting' },
      { key: 'Ctrl + Shift + V', desc: 'Paste formatting' },
      { key: 'Ctrl + Space', desc: 'Remove character formatting' },
      
      // View & Display
      { key: 'Ctrl + Shift + 8', desc: 'Show/hide formatting marks' },
      { key: 'Alt + Ctrl + P', desc: 'Print Layout view' },
      { key: 'Alt + Ctrl + O', desc: 'Outline view' },
      { key: 'Alt + Ctrl + N', desc: 'Draft view' },
      { key: 'Ctrl + F1', desc: 'Show/hide ribbon' },
      { key: 'Alt + F8', desc: 'Macros' },
      
      // Review
      { key: 'F7', desc: 'Spelling & grammar' },
      { key: 'Shift + F7', desc: 'Thesaurus' },
      { key: 'Alt + Ctrl + M', desc: 'Insert comment' },
      { key: 'Ctrl + Shift + E', desc: 'Track changes' },
      
      // Tables
      { key: 'Tab', desc: 'Next cell' },
      { key: 'Shift + Tab', desc: 'Previous cell' },
      { key: 'Alt + Home', desc: 'First cell in row' },
      { key: 'Alt + End', desc: 'Last cell in row' },
      { key: 'Alt + PgUp', desc: 'Top cell in column' },
      { key: 'Alt + PgDn', desc: 'Bottom cell in column' },
      
      // Find & Replace
      { key: 'Ctrl + F', desc: 'Find' },
      { key: 'F3', desc: 'Find next' },
      { key: 'Shift + F3', desc: 'Find previous' },
      { key: 'Ctrl + H', desc: 'Replace' },
      { key: 'Ctrl + G', desc: 'Go to page/line' },
      
      // Mail Merge
      { key: 'Alt + Shift + K', desc: 'Preview mail merge' },
      { key: 'Alt + Shift + N', desc: 'Merge document' },
      { key: 'Alt + Shift + M', desc: 'Print merged document' },
      
      // Bookmarks & References
      { key: 'Ctrl + Shift + F5', desc: 'Edit bookmark' },
      { key: 'Alt + Shift + X', desc: 'Mark index entry' },
      { key: 'Alt + Shift + O', desc: 'Mark table of contents entry' },
      
      // Special Characters
      { key: 'Ctrl + Shift + Spacebar', desc: 'Non-breaking space' },
      { key: 'Ctrl + -', desc: 'Optional hyphen' },
      { key: 'Ctrl + Shift + -', desc: 'Non-breaking hyphen' },
      { key: 'Ctrl + Alt + .', desc: 'Ellipsis' },
      
      // Fields & Formulas
      { key: 'Ctrl + F9', desc: 'Insert field' },
      { key: 'F9', desc: 'Update field' },
      { key: 'Ctrl + Shift + F9', desc: 'Unlink field' },
      { key: 'Alt + F9', desc: 'Toggle field codes' },
      
      // Document Navigation
      { key: 'Ctrl + Alt + Home', desc: 'Browse object' },
      { key: 'Alt + Ctrl + Z', desc: 'Switch between documents' },
      { key: 'Ctrl + F6', desc: 'Next document window' },
      { key: 'Ctrl + Shift + F6', desc: 'Previous document window' },
      
      // Multilevel Lists
      { key: 'Ctrl + Shift + N', desc: 'Apply Normal style' },
      { key: 'Alt + Shift + Right', desc: 'Demote to body text' },
      { key: 'Ctrl + 1/2/3', desc: 'Apply List style' },
      
      // Other
      { key: 'F1', desc: 'Help' },
      { key: 'F12', desc: 'Save As' },
      { key: 'Shift + F3', desc: 'Change case' },
      { key: 'Ctrl + Shift + F3', desc: 'Insert spike contents' },
      { key: 'Alt + F10', desc: 'Maximize window' },
      { key: 'F4', desc: 'Repeat last action' },
      { key: 'Shift + F1', desc: 'Reveal formatting' },
      { key: 'Alt + Shift + F1', desc: 'Go to previous field' },
      { key: 'Alt + Shift + F2', desc: 'Save document' }
    ]
  },
  {
    id: 'outlook',
    name: 'Outlook',
    tagline: 'Email & Communication',
    iconText: 'O',
    iconUrl: 'https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/6d9d66e75fc9e5ce7b9d79a3f0da91c8def27cab/icons/2025%20Outlook%20Icon.png',
    color: '#0078d4',
    colorLight: '#1a8cff',
    shortcuts: [
      // Basic
      { key: 'Ctrl + N', desc: 'New email' },
      { key: 'Ctrl + Shift + M', desc: 'New message (anywhere)' },
      { key: 'Ctrl + R', desc: 'Reply' },
      { key: 'Ctrl + Shift + R', desc: 'Reply All' },
      { key: 'Ctrl + F', desc: 'Forward' },
      { key: 'Ctrl + Enter', desc: 'Send' },
      { key: 'Alt + S', desc: 'Send (in message)' },
      { key: 'Ctrl + S', desc: 'Save draft' },
      { key: 'Ctrl + Q', desc: 'Mark as read' },
      { key: 'Ctrl + U', desc: 'Mark as unread' },
      { key: 'Delete', desc: 'Delete item' },
      
      // Navigation
      { key: 'Ctrl + 1', desc: 'Go to Mail' },
      { key: 'Ctrl + 2', desc: 'Go to Calendar' },
      { key: 'Ctrl + 3', desc: 'Go to Contacts' },
      { key: 'Ctrl + 4', desc: 'Go to Tasks' },
      { key: 'Ctrl + 5', desc: 'Go to Notes' },
      { key: 'Ctrl + 6', desc: 'Go to Folder List' },
      { key: 'Ctrl + 7', desc: 'Go to Shortcuts' },
      { key: 'Ctrl + Shift + I', desc: 'Go to Inbox' },
      { key: 'Ctrl + Shift + O', desc: 'Go to Outbox' },
      { key: 'Ctrl + Y', desc: 'Go to folder' },
      { key: 'Ctrl + Shift + V', desc: 'Move to folder' },
      { key: 'Ctrl + Shift + Y', desc: 'Copy to folder' },
      
      // Search
      { key: 'Ctrl + E', desc: 'Search' },
      { key: 'Ctrl + Shift + F', desc: 'Advanced Find' },
      { key: 'Ctrl + Shift + P', desc: 'Create Search Folder' },
      { key: 'F3', desc: 'Find next' },
      { key: 'Shift + F3', desc: 'Find previous' },
      
      // Calendar
      { key: 'Ctrl + Shift + A', desc: 'New appointment' },
      { key: 'Ctrl + Shift + Q', desc: 'New meeting request' },
      { key: 'Ctrl + G', desc: 'Go to date' },
      { key: 'Alt + 1-9', desc: 'View 1-9 days' },
      { key: 'Alt + 0', desc: 'View 10 days' },
      { key: 'Alt + -', desc: 'View week' },
      { key: 'Alt + =', desc: 'View month' },
      { key: 'Ctrl + Right Arrow', desc: 'Next day/week/month' },
      { key: 'Ctrl + Left Arrow', desc: 'Previous day/week/month' },
      
      // Contacts
      { key: 'Ctrl + Shift + C', desc: 'New contact' },
      { key: 'Ctrl + Shift + L', desc: 'New contact group' },
      { key: 'Ctrl + Shift + B', desc: 'Open address book' },
      { key: 'F11', desc: 'Find contact' },
      
      // Tasks
      { key: 'Ctrl + Shift + K', desc: 'New task' },
      { key: 'Ctrl + Shift + U', desc: 'New task request' },
      { key: 'Insert', desc: 'Flag for follow-up' },
      
      // Message Formatting
      { key: 'Ctrl + K', desc: 'Insert hyperlink' },
      { key: 'Ctrl + B', desc: 'Bold' },
      { key: 'Ctrl + I', desc: 'Italic' },
      { key: 'Ctrl + U', desc: 'Underline' },
      { key: 'Ctrl + Shift + L', desc: 'Bullets' },
      { key: 'Ctrl + Shift + >/<', desc: 'Increase/decrease font' },
      { key: 'Ctrl + L/E/R', desc: 'Left/center/right align' },
      
      // Categorize & Flag
      { key: 'Alt + H + G', desc: 'Categorize' },
      { key: 'Ctrl + Shift + G', desc: 'Flag for follow-up' },
      
      // Rules & Junk
      { key: 'Ctrl + Alt + J', desc: 'Mark as junk' },
      { key: 'Ctrl + Shift + J', desc: 'Create rule' },
      
      // View
      { key: 'Ctrl + F1', desc: 'Toggle ribbon' },
      { key: 'Ctrl + Shift + Tab', desc: 'Previous pane' },
      { key: 'Tab', desc: 'Next field' },
      { key: 'Shift + Tab', desc: 'Previous field' },
      
      // Message Options
      { key: 'Ctrl + Shift + G', desc: 'Flag for follow-up' },
      { key: 'Ctrl + Shift + H', desc: 'Show Bcc field' },
      { key: 'Alt + D', desc: 'Check names' },
      { key: 'Ctrl + Shift + S', desc: 'Post to folder' },
      
      // Folder Management
      { key: 'Ctrl + Shift + E', desc: 'Create folder' },
      { key: 'Ctrl + 6', desc: 'Switch to Folders pane' },
      { key: 'F3', desc: 'Find item' },
      
      // Reading & Flagging
      { key: 'Ctrl + Down', desc: 'Next message' },
      { key: 'Ctrl + Up', desc: 'Previous message' },
      { key: 'Spacebar', desc: 'Scroll down' },
      { key: 'Shift + Spacebar', desc: 'Scroll up' },
      { key: 'Insert', desc: 'Flag message' },
      
      // Quick Steps
      { key: 'Ctrl + Shift + 1-9', desc: 'Run Quick Step 1-9' },
      
      // Groups & Distribution Lists
      { key: 'Ctrl + Shift + D', desc: 'New distribution list' },
      { key: 'Ctrl + Shift + X', desc: 'Send fax' },
      
      // Notes & Journal
      { key: 'Ctrl + Shift + N', desc: 'New note' },
      { key: 'Ctrl + Shift + J', desc: 'New journal entry' },
      
      // Meetings & Scheduling
      { key: 'Ctrl + 2', desc: 'Go to Calendar' },
      { key: 'Ctrl + Shift + Q', desc: 'Create meeting request' },
      { key: 'Ctrl + F', desc: 'Forward meeting' },
      { key: 'Alt + -', desc: 'Previous week' },
      { key: 'Alt + =', desc: 'Next week' },
      
      // Views & Windows
      { key: 'Alt + V', desc: 'Change view' },
      { key: 'Ctrl + Alt + 1', desc: 'Switch to Mail' },
      { key: 'Ctrl + Alt + 2', desc: 'Switch to Calendar' },
      { key: 'Ctrl + .', desc: 'Next item' },
      { key: 'Ctrl + ,', desc: 'Previous item' },
      
      // Other
      { key: 'Ctrl + P', desc: 'Print' },
      { key: 'F7', desc: 'Spell check' },
      { key: 'F9', desc: 'Send/Receive all' },
      { key: 'Shift + F9', desc: 'Send/Receive current folder' },
      { key: 'Alt + F4', desc: 'Close window' },
      { key: 'F4', desc: 'Find or replace' },
      { key: 'Ctrl + Shift + Tab', desc: 'Previous field' }
    ]
  },
  {
    id: 'teams',
    name: 'Teams',
    tagline: 'Collaboration Hub',
    iconText: 'T',
    iconUrl: 'https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/6d9d66e75fc9e5ce7b9d79a3f0da91c8def27cab/icons/2025%20Teams%20Icon.png',
    color: '#5c2d91',
    colorLight: '#7a3db0',
    shortcuts: [
      // General Navigation
      { key: 'Ctrl + E', desc: 'Go to Search' },
      { key: 'Ctrl + G', desc: 'Go to Team/Channel' },
      { key: 'Ctrl + /', desc: 'Show commands' },
      { key: 'Ctrl + .', desc: 'Show keyboard shortcuts' },
      { key: 'Ctrl + F', desc: 'Open filter' },
      { key: 'Ctrl + Shift + F', desc: 'Open advanced search' },
      
      // Navigation - Sections
      { key: 'Ctrl + 1', desc: 'Go to Activity' },
      { key: 'Ctrl + 2', desc: 'Go to Chat' },
      { key: 'Ctrl + 3', desc: 'Go to Teams' },
      { key: 'Ctrl + 4', desc: 'Go to Calendar' },
      { key: 'Ctrl + 5', desc: 'Go to Calls' },
      { key: 'Ctrl + 6', desc: 'Go to Files' },
      { key: 'Ctrl + Shift + 3', desc: 'Go to previous team' },
      { key: 'Ctrl + Shift + 2', desc: 'Go to previous section' },
      
      // Messaging
      { key: 'Ctrl + N', desc: 'Start new chat' },
      { key: 'Ctrl + Shift + X', desc: 'Expand compose box' },
      { key: 'Ctrl + Enter', desc: 'Send message' },
      { key: 'Ctrl + Shift + I', desc: 'Mark as important' },
      { key: 'Alt + Shift + C', desc: 'Go to compose box' },
      { key: 'Ctrl + Shift + .', desc: 'Open emoji picker' },
      { key: 'Ctrl + O', desc: 'Attach file' },
      
      // Meetings & Calls
      { key: 'Ctrl + Shift + A', desc: 'Accept call' },
      { key: 'Ctrl + Shift + D', desc: 'Decline call' },
      { key: 'Ctrl + Shift + C', desc: 'Accept video call' },
      { key: 'Ctrl + Shift + M', desc: 'Toggle mute' },
      { key: 'Ctrl + Shift + O', desc: 'Toggle video' },
      { key: 'Ctrl + Shift + K', desc: 'Start audio call' },
      { key: 'Ctrl + Shift + U', desc: 'Start video call' },
      { key: 'Ctrl + Shift + E', desc: 'Start screen share' },
      { key: 'Ctrl + Shift + L', desc: 'Toggle hand raise' },
      { key: 'Ctrl + Shift + P', desc: 'Toggle background blur' },
      { key: 'Ctrl + Shift + Y', desc: 'Lower all hands' },
      { key: 'Ctrl + Alt + Shift + T', desc: 'Go to sharing toolbar' },
      
      // Meeting Actions
      { key: 'Ctrl + Shift + H', desc: 'Hang up' },
      { key: 'Ctrl + Shift + Space', desc: 'Accept screen share' },
      { key: 'Ctrl + Shift + B', desc: 'Toggle reactions' },
      { key: 'Ctrl + Alt + Space', desc: 'Go to sharing toolbar' },
      
      // Chat Actions
      { key: 'Ctrl + F', desc: 'Search in chat' },
      { key: 'Alt + Shift + R', desc: 'Reply to thread' },
      { key: 'R', desc: 'Reply (in thread)' },
      { key: 'C', desc: 'New conversation' },
      { key: 'Shift + Enter', desc: 'Go to next line' },
      
      // Files & Apps
      { key: 'Ctrl + Shift + F', desc: 'Open files' },
      { key: 'Ctrl + Shift + I', desc: 'Open apps' },
      { key: 'Ctrl + Shift + Space', desc: 'Open activity feed' },
      
      // Meeting Controls Advanced
      { key: 'Ctrl + Shift + F', desc: 'Filter messages' },
      { key: 'Ctrl + Shift + J', desc: 'Go to suggested replies' },
      { key: 'Ctrl + Shift + R', desc: 'Toggle raise hand' },
      
      // Channel Navigation
      { key: 'Alt + Up', desc: 'Previous channel' },
      { key: 'Alt + Down', desc: 'Next channel' },
      { key: 'Ctrl + Shift + 1', desc: 'Go to last channel' },
      
      // Message Formatting
      { key: 'Ctrl + B', desc: 'Bold text' },
      { key: 'Ctrl + I', desc: 'Italic text' },
      { key: 'Ctrl + U', desc: 'Underline text' },
      { key: 'Ctrl + Shift + K', desc: 'Insert link' },
      { key: 'Shift + Enter', desc: 'New line in message' },
      
      // Notifications
      { key: 'Ctrl + Shift + O', desc: 'Filter notifications' },
      { key: 'Ctrl + Shift + Y', desc: 'Open activity' },
      
      // Screen Sharing
      { key: 'Ctrl + Shift + E', desc: 'Start screen share' },
      { key: 'Ctrl + Shift + D', desc: 'Stop screen share' },
      { key: 'Ctrl + Shift + L', desc: 'Mute everyone (host)' },
      
      // Recording
      { key: 'Ctrl + Shift + R', desc: 'Start recording' },
      { key: 'Ctrl + Shift + F12', desc: 'Stop recording' },
      
      // Breakout Rooms (Host)
      { key: 'Ctrl + Shift + B', desc: 'Manage breakout rooms' },
      { key: 'Ctrl + Alt + Shift + B', desc: 'Close breakout rooms' },
      
      // Accessibility
      { key: 'Ctrl + Shift + T', desc: 'Go to timestamp' },
      { key: 'Alt + .', desc: 'Open options menu' },
      
      // Other
      { key: 'Ctrl + =', desc: 'Zoom in' },
      { key: 'Ctrl + -', desc: 'Zoom out' },
      { key: 'Ctrl + 0', desc: 'Reset zoom' },
      { key: 'F1', desc: 'Help' },
      { key: 'Esc', desc: 'Close/Back' },
      { key: 'Ctrl + Shift + S', desc: 'Screenshot' },
      { key: 'Ctrl + Shift + /', desc: 'Keyboard shortcuts list' }
    ]
  },
  {
    id: 'onenote',
    name: 'OneNote',
    tagline: 'Digital Notebook',
    iconText: 'N',
    iconUrl: 'https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/6d9d66e75fc9e5ce7b9d79a3f0da91c8def27cab/icons/2025%20SharePoint%20Icon.png',
    color: '#80397b',
    colorLight: '#9d4a96',
    shortcuts: [
      // Basic
      { key: 'Ctrl + N', desc: 'New page' },
      { key: 'Ctrl + Alt + N', desc: 'New page below' },
      { key: 'Ctrl + Shift + N', desc: 'New subpage' },
      { key: 'Ctrl + T', desc: 'New section' },
      { key: 'Ctrl + Shift + G', desc: 'New section group' },
      { key: 'Ctrl + M', desc: 'New notebook' },
      { key: 'Ctrl + S', desc: 'Sync notebook' },
      { key: 'Ctrl + Alt + S', desc: 'Sync all notebooks' },
      
      // Navigation
      { key: 'Ctrl + Home', desc: 'Go to first page' },
      { key: 'Ctrl + End', desc: 'Go to last page' },
      { key: 'Ctrl + PgUp', desc: 'Previous page' },
      { key: 'Ctrl + PgDn', desc: 'Next page' },
      { key: 'Ctrl + Alt + PgUp', desc: 'Previous section' },
      { key: 'Ctrl + Alt + PgDn', desc: 'Next section' },
      { key: 'Alt + Home', desc: 'Go to page title' },
      
      // Search
      { key: 'Ctrl + F', desc: 'Search current page' },
      { key: 'Ctrl + E', desc: 'Search all notebooks' },
      { key: 'F3', desc: 'Find next' },
      { key: 'Shift + F3', desc: 'Find previous' },
      { key: 'Ctrl + Shift + F', desc: 'Search everywhere' },
      
      // Tags
      { key: 'Ctrl + 1', desc: 'To Do tag' },
      { key: 'Ctrl + 2', desc: 'Important tag' },
      { key: 'Ctrl + 3', desc: 'Question tag' },
      { key: 'Ctrl + 4', desc: 'Remember tag' },
      { key: 'Ctrl + 5', desc: 'Definition tag' },
      { key: 'Ctrl + 0', desc: 'Remove tag' },
      { key: 'Ctrl + Shift + F', desc: 'Search by tag' },
      
      // Formatting
      { key: 'Ctrl + B', desc: 'Bold' },
      { key: 'Ctrl + I', desc: 'Italic' },
      { key: 'Ctrl + U', desc: 'Underline' },
      { key: 'Ctrl + -', desc: 'Strikethrough' },
      { key: 'Ctrl + =', desc: 'Subscript' },
      { key: 'Ctrl + Shift + =', desc: 'Superscript' },
      { key: 'Ctrl + Shift + >', desc: 'Increase font size' },
      { key: 'Ctrl + Shift + <', desc: 'Decrease font size' },
      { key: 'Ctrl + L', desc: 'Left align' },
      { key: 'Ctrl + R', desc: 'Right align' },
      { key: 'Ctrl + E', desc: 'Center align' },
      
      // Lists
      { key: 'Ctrl + .', desc: 'Bulleted list' },
      { key: 'Ctrl + /', desc: 'Numbered list' },
      { key: 'Ctrl + Shift + O', desc: 'Normal outline' },
      { key: 'Tab', desc: 'Increase indent' },
      { key: 'Shift + Tab', desc: 'Decrease indent' },
      
      // Insert
      { key: 'Ctrl + K', desc: 'Insert hyperlink' },
      { key: 'Alt + Shift + D', desc: 'Insert date' },
      { key: 'Alt + Shift + T', desc: 'Insert time' },
      { key: 'Alt + Shift + F', desc: 'Insert date & time' },
      { key: 'Ctrl + Alt + C', desc: 'Copy formatting' },
      { key: 'Ctrl + Alt + V', desc: 'Paste formatting' },
      { key: 'Ctrl + Shift + V', desc: 'Keep text only' },
      
      // Tables
      { key: 'Tab', desc: 'Create table column' },
      { key: 'Enter', desc: 'Create table row' },
      { key: 'Ctrl + Enter', desc: 'Create row below' },
      { key: 'Alt + Shift + Up', desc: 'Move row up' },
      { key: 'Alt + Shift + Down', desc: 'Move row down' },
      
      // View
      { key: 'Ctrl + Alt + D', desc: 'Dock to desktop' },
      { key: 'F11', desc: 'Full screen' },
      { key: 'Ctrl + Alt + P', desc: 'Change page setup' },
      { key: 'Ctrl + F1', desc: 'Toggle ribbon' },
      
      // Drawing & Ink
      { key: 'Ctrl + Shift + D', desc: 'Draw with pen' },
      { key: 'Ctrl + Shift + E', desc: 'Eraser tool' },
      { key: 'Ctrl + Shift + H', desc: 'Highlighter' },
      
      // Audio & Video
      { key: 'Alt + Shift + A', desc: 'Record audio' },
      { key: 'Alt + Shift + V', desc: 'Record video' },
      { key: 'Alt + Shift + P', desc: 'Play/Pause recording' },
      { key: 'Alt + Shift + S', desc: 'Stop recording' },
      
      // Notebook Management
      { key: 'Ctrl + O', desc: 'Open notebook' },
      { key: 'Ctrl + Alt + N', desc: 'Open new window' },
      { key: 'Ctrl + Tab', desc: 'Next notebook' },
      { key: 'Ctrl + Shift + Tab', desc: 'Previous notebook' },
      
      // Page & Section Advanced
      { key: 'Ctrl + Alt + M', desc: 'Move/Copy page' },
      { key: 'Ctrl + Alt + G', desc: 'Move section' },
      { key: 'Alt + Shift + Up', desc: 'Move page up' },
      { key: 'Alt + Shift + Down', desc: 'Move page down' },
      
      // Outline & Hierarchy
      { key: 'Ctrl + Alt + 1', desc: 'Heading 1' },
      { key: 'Ctrl + Alt + 2', desc: 'Heading 2' },
      { key: 'Ctrl + Alt + 3', desc: 'Heading 3' },
      { key: 'Shift + Alt + Up', desc: 'Move paragraph up' },
      { key: 'Shift + Alt + Down', desc: 'Move paragraph down' },
      
      // Screenshots & Clipping
      { key: 'Windows + Shift + S', desc: 'Screen clipping' },
      { key: 'Alt + N', desc: 'Insert screen clipping' },
      { key: 'Ctrl + Shift + C', desc: 'Copy formatting' },
      
      // Email & Sharing
      { key: 'Ctrl + Shift + E', desc: 'Email page' },
      { key: 'Ctrl + E', desc: 'Send to OneNote' },
      { key: 'Alt + Shift + C', desc: 'Copy link to page' },
      
      // Password Protection
      { key: 'Ctrl + Alt + L', desc: 'Lock protected sections' },
      
      // Templates
      { key: 'Alt + N + T', desc: 'Apply page template' },
      
      // Math Equations
      { key: 'Alt + =', desc: 'Insert equation' },
      { key: 'Ctrl + =', desc: 'Calculate math' },
      
      // Other
      { key: 'Ctrl + P', desc: 'Print page' },
      { key: 'F7', desc: 'Spell check' },
      { key: 'Shift + F7', desc: 'Thesaurus' },
      { key: 'Ctrl + Alt + M', desc: 'Insert comment' },
      { key: 'Alt + F8', desc: 'Run macro' },
      { key: 'F5', desc: 'Refresh page' },
      { key: 'Ctrl + Y', desc: 'Redo' },
      { key: 'Ctrl + Shift + A', desc: 'Author initials' }
    ]
  }
];

// ---------- DOM helpers ----------------------------------------------------
const el = (tag, opts={}) => Object.assign(document.createElement(tag), opts);

function createIcon(program) {
  if (program.iconUrl) {
    const img = el('img', { 
      className: 'program-icon-image',
      src: program.iconUrl,
      alt: `${program.name} icon`,
      title: program.name
    });
    return img;
  } else {
    // Fallback to text icon if URL not provided
    const wrap = el('div', { className: 'program-icon-fallback', title: program.iconText });
    wrap.style.border = `2px solid ${program.color}`;
    wrap.style.color = program.color;
    wrap.textContent = program.iconText;
    return wrap;
  }
}

function categorizeShortcuts(shortcuts) {
  const categories = {
    "Essential Basics": [],
    "Navigation & Movement": [],
    "Editing & Input": [],
    "Formatting & Styling": [],
    "Advanced Features": []
  };
  
  shortcuts.forEach((s) => {
    const key = s.key.toLowerCase();
    const desc = s.desc.toLowerCase();
    
    // Categorize based on keywords
    if (key.includes('arrow') || key.includes('page') || key.includes('home') || key.includes('end') || 
        desc.includes('go to') || desc.includes('next') || desc.includes('previous') || 
        desc.includes('move') || desc.includes('jump') || desc.includes('navigate')) {
      categories["Navigation & Movement"].push(s);
    } else if (desc.includes('format') || desc.includes('bold') || desc.includes('italic') || 
               desc.includes('underline') || desc.includes('align') || desc.includes('style') ||
               desc.includes('font') || desc.includes('spacing') || desc.includes('color') ||
               desc.includes('border') || desc.includes('indent')) {
      categories["Formatting & Styling"].push(s);
    } else if (desc.includes('insert') || desc.includes('edit') || desc.includes('delete') || 
               desc.includes('fill') || desc.includes('copy') || desc.includes('paste') ||
               desc.includes('cut') || desc.includes('find') || desc.includes('replace') ||
               desc.includes('undo') || desc.includes('redo') || desc.includes('select')) {
      categories["Editing & Input"].push(s);
    } else if (key.includes('shift') && key.includes('ctrl') && key.includes('alt') ||
               desc.includes('macro') || desc.includes('advanced') || desc.includes('formula') ||
               desc.includes('function') || desc.includes('table') || desc.includes('chart') ||
               desc.includes('filter') || desc.includes('sort') || desc.includes('pivot')) {
      categories["Advanced Features"].push(s);
    } else {
      categories["Essential Basics"].push(s);
    }
  });
  
  return categories;
}

function placeRadialBubbles(card, shortcuts) {
  // Radial/spiderweb preview removed because it caused layout thrash and duplicate text.
  // Keep this function as a no-op for compatibility to avoid further DOM churn.
  return;
}

function openModal(program) {
  const m = document.getElementById('modal');
  const title = document.getElementById('modalTitle');
  const body = document.getElementById('modalBody');
  title.textContent = `${program.name} â€” Complete Shortcuts Guide`;
  body.innerHTML = '';

  // Smart categorization based on keywords
  const cats = {
    "Essential Basics": [],
    "Navigation & Movement": [],
    "Editing & Input": [],
    "Formatting & Styling": [],
    "Advanced Features": []
  };
  
  program.shortcuts.forEach((s) => {
    const key = s.key.toLowerCase();
    const desc = s.desc.toLowerCase();
    
    // Categorize based on keywords
    if (key.includes('arrow') || key.includes('page') || key.includes('home') || key.includes('end') || 
        desc.includes('go to') || desc.includes('next') || desc.includes('previous') || desc.includes('move')) {
      cats["Navigation & Movement"].push(s);
    } else if (desc.includes('format') || desc.includes('bold') || desc.includes('italic') || 
               desc.includes('underline') || desc.includes('align') || desc.includes('style') ||
               desc.includes('font') || desc.includes('spacing')) {
      cats["Formatting & Styling"].push(s);
    } else if (desc.includes('insert') || desc.includes('edit') || desc.includes('delete') || 
               desc.includes('fill') || desc.includes('copy') || desc.includes('paste') ||
               desc.includes('cut') || desc.includes('find') || desc.includes('replace')) {
      cats["Editing & Input"].push(s);
    } else if (key.includes('shift') && key.includes('ctrl') && key.includes('alt') ||
               desc.includes('macro') || desc.includes('advanced') || desc.includes('formula') ||
               desc.includes('function') || desc.includes('table') || desc.includes('chart')) {
      cats["Advanced Features"].push(s);
    } else {
      cats["Essential Basics"].push(s);
    }
  });

  // Render categories
  Object.entries(cats).forEach(([cat, items]) => {
    if (!items.length) return;
    const c = el('div', { className: 'cat' });
    c.innerHTML = `<h4>${cat} <span style="opacity:0.6;font-size:14px;font-weight:400;">(${items.length})</span></h4>`;
    const ul = el('ul');
    items.forEach(s => {
      const li = el('li');
      li.innerHTML = `<strong>${s.key}</strong> ${s.desc}`;
      ul.appendChild(li);
    });
    c.appendChild(ul);
    body.appendChild(c);
  });

  // Hide search results when opening the modal so modal text is clearly visible on small screens
  const searchResultsEl = document.getElementById('searchResults');
  if (searchResultsEl) searchResultsEl.style.display = 'none';

  m.classList.add('visible');
  document.getElementById('closeModal').focus();
}

function render() {
  const grid = document.getElementById('programsGrid');
  PROGRAMS.forEach(p => {
    const card = el('button', { className: 'program-card', type: 'button' });
    card.setAttribute('aria-label', `${p.name} shortcuts`);
    card.style.setProperty('--program-color', p.color);
    card.style.setProperty('--program-color-light', p.colorLight);

    // icon
    const iconWrap = el('div', { className: 'program-icon-wrapper' });
    iconWrap.appendChild(createIcon(p));

    const name = el('div', { className: 'program-name', textContent: p.name });
    const tagline = el('div', { className: 'program-tagline', textContent: p.tagline });
    
    // Shortcut count badge
    const countBadge = el('div', { className: 'shortcut-count', textContent: `${p.shortcuts.length} Shortcuts` });
    
    const hint = el('div', { className: 'hover-instruction', textContent: 'Hover to see top 10 â€¢ Click card to pin all shortcuts' });

    const btn = el('div', { className: 'center' });
    const view = el('button', { className: 'view-shortcuts', textContent: 'View in Modal' });
    view.addEventListener('click', (e) => { e.stopPropagation(); openModal(p); });
    btn.appendChild(view);

    card.append(iconWrap, name, tagline, countBadge, hint, btn);

    // add cheatsheet below the card content
    const cheats = el('div', { className: 'cheatsheet' });
    cheats.setAttribute('aria-hidden', 'true');
    
    // Create two views - one for hover (top 10), one for locked (categorized)
    const hoverList = el('ul', { className: 'hover-list' });
    const lockedView = el('div', { className: 'locked-list', style: 'display: none;' });
    
    // Add top 10 shortcuts for hover
    p.shortcuts.slice(0, 10).forEach(s => {
      const li = el('li'); 
      li.innerHTML = `<strong>${s.key}</strong> ${s.desc}`; 
      hoverList.appendChild(li);
    });
    
    // Categorize all shortcuts for locked state
    const categories = categorizeShortcuts(p.shortcuts);
    
    Object.entries(categories).forEach(([categoryName, shortcuts]) => {
      if (shortcuts.length === 0) return;
      
      const categorySection = el('div', { className: 'shortcut-category' });
      const categoryTitle = el('div', { 
        className: 'category-title', 
        textContent: `${categoryName} (${shortcuts.length})` 
      });
      const categoryList = el('ul');
      
      shortcuts.forEach(s => {
        const li = el('li');
        li.innerHTML = `<strong>${s.key}</strong> ${s.desc}`;
        categoryList.appendChild(li);
      });
      
      categorySection.appendChild(categoryTitle);
      categorySection.appendChild(categoryList);
      lockedView.appendChild(categorySection);
    });
    
    cheats.appendChild(hoverList);
    cheats.appendChild(lockedView);
    card.appendChild(cheats);

    // Click to lock/unlock the expanded state
    let isLocked = false;
    card.addEventListener('click', (e) => {
      // Don't trigger if clicking the modal button
      if (e.target.closest('.view-shortcuts')) return;
      
      e.stopPropagation();
      isLocked = !isLocked;
      
      if (isLocked) {
        // First add locked class for smooth transition
        card.classList.add('locked');
        
        // Then change display after a brief moment
        requestAnimationFrame(() => {
          hoverList.style.display = 'none';
          lockedView.style.display = 'grid';
          cheats.setAttribute('aria-hidden', 'false');
          hint.textContent = 'Click again to unpin';
        });
        
        // Scroll the locked card into view smoothly
        setTimeout(() => {
          card.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' });
        }, 400);
      } else {
        // Remove locked class
        card.classList.remove('locked');
        
        // Change display
        requestAnimationFrame(() => {
          hoverList.style.display = 'block';
          lockedView.style.display = 'none';
          cheats.setAttribute('aria-hidden', 'true');
          hint.textContent = 'Hover to see top 10 â€¢ Click card to pin all shortcuts';
        });
      }
    });

    // Hover functionality (only when not locked)
    card.addEventListener('mouseenter', () => {
      if (!isLocked) {
        cheats.setAttribute('aria-hidden', 'false');
      }
    });
    card.addEventListener('mouseleave', () => {
      if (!isLocked) {
        cheats.setAttribute('aria-hidden', 'true');
      }
    });
    
    // Focus handling
    card.addEventListener('focus', () => { 
      if (!isLocked) {
        card.classList.add('focused'); 
        cheats.setAttribute('aria-hidden', 'false'); 
      }
    });
    card.addEventListener('blur', () => { 
      if (!isLocked) {
        card.classList.remove('focused'); 
        cheats.setAttribute('aria-hidden', 'true'); 
      }
    });

    // keyboard navigation
    card.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { 
        e.preventDefault(); 
        // Trigger the click to lock/unlock
        card.click();
      }
    });

    grid.appendChild(card);
  });
}

// Create animated background particles
function createParticles() {
  const container = document.getElementById('particles');
  if (!container) return;
  
  for (let i = 0; i < 20; i++) {
    const particle = el('div', { className: 'particle' });
    const size = Math.random() * 4 + 2;
    particle.style.width = `${size}px`;
    particle.style.height = `${size}px`;
    particle.style.left = `${Math.random() * 100}%`;
    particle.style.top = `${Math.random() * 100}%`;
    particle.style.animationDelay = `${Math.random() * 20}s`;
    particle.style.animationDuration = `${Math.random() * 10 + 15}s`;
    container.appendChild(particle);
  }
}

// Search Functionality
function initSearch() {
  const searchInput = document.getElementById('searchInput');
  const searchResults = document.getElementById('searchResults');
  const clearBtn = document.getElementById('clearSearch');
  
  let searchTimeout;
  
  searchInput.addEventListener('input', (e) => {
    const query = e.target.value.trim();
    
    // Show/hide clear button
    clearBtn.style.display = query ? 'flex' : 'none';
    
    // Debounce search
    clearTimeout(searchTimeout);
    
    if (query.length < 2) {
      searchResults.style.display = 'none';
      return;
    }
    
    searchTimeout = setTimeout(() => {
      performSearch(query);
    }, 300);
  });
  
  clearBtn.addEventListener('click', () => {
    searchInput.value = '';
    clearBtn.style.display = 'none';
    searchResults.style.display = 'none';
    searchInput.focus();
  });
  
  // Close search results when clicking outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.search-container')) {
      searchResults.style.display = 'none';
    }
  });
  
  // Focus input on '/' key
  document.addEventListener('keydown', (e) => {
    if (e.key === '/' && !e.target.matches('input, textarea')) {
      e.preventDefault();
      searchInput.focus();
    }
  });
}

function performSearch(query) {
  const searchResults = document.getElementById('searchResults');
  const lowerQuery = query.toLowerCase();
  
  // Search through all programs and shortcuts
  const results = {};
  
  PROGRAMS.forEach(program => {
    const matches = program.shortcuts.filter(shortcut => {
      const keyMatch = shortcut.key.toLowerCase().includes(lowerQuery);
      const descMatch = shortcut.desc.toLowerCase().includes(lowerQuery);
      const programMatch = program.name.toLowerCase().includes(lowerQuery);
      return keyMatch || descMatch || programMatch;
    });
    
    if (matches.length > 0) {
      results[program.name] = {
        program: program,
        shortcuts: matches
      };
    }
  });
  
  // Display results
  displaySearchResults(results, query);
}

function displaySearchResults(results, query) {
  const searchResults = document.getElementById('searchResults');
  const resultCount = Object.values(results).reduce((sum, r) => sum + r.shortcuts.length, 0);
  
  if (resultCount === 0) {
    searchResults.innerHTML = `
      <div class="no-results">
        <div class="no-results-icon">ðŸ”</div>
        <div style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">No shortcuts found</div>
        <div style="font-size: 14px;">Try searching for "copy", "bold", "save", or other actions</div>
      </div>
    `;
    searchResults.style.display = 'block';
    return;
  }
  
  let html = '';
  
  Object.entries(results).forEach(([programName, data]) => {
    const program = data.program;
    // Use the same repo-hosted icon image as the main cards when available, otherwise fall back to the text icon
    const iconHtml = program.iconUrl
      ? `<img src="${program.iconUrl}" alt="${program.name} icon" title="${program.name}" class="search-result-program-img">`
      : `${program.iconText}`;

    // if an image exists, don't set the gradient background so the image shows naturally
    const bgStyle = program.iconUrl ? 'background: none; padding: 0;' : `background: linear-gradient(135deg, ${program.color}, ${program.colorLight});`;

    html += `
      <div class="search-result-group">
        <div class="search-result-program">
          <div class="search-result-program-icon" style="${bgStyle}">
            ${iconHtml}
          </div>
          ${programName} <span style="opacity: 0.6; font-size: 14px; font-weight: 400;">(${data.shortcuts.length})</span>
        </div>
    `;
    
    data.shortcuts.slice(0, 10).forEach(shortcut => {
      const highlightedKey = highlightText(shortcut.key, query);
      const highlightedDesc = highlightText(shortcut.desc, query);
      
      html += `
        <div class="search-result-item" style="border-left-color: ${program.color};">
          <strong>${highlightedKey}</strong>
          <span>${highlightedDesc}</span>
        </div>
      `;
    });

    
    if (data.shortcuts.length > 10) {
      html += `<div style="text-align: center; padding: 8px; color: #64748b; font-size: 12px;">+ ${data.shortcuts.length - 10} more shortcuts</div>`;
    }
    
    html += `</div>`;
  });
  
  searchResults.innerHTML = html;
  searchResults.style.display = 'block';
}

function highlightText(text, query) {
  const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
  return text.replace(regex, '<mark style="background: #fef08a; padding: 2px 4px; border-radius: 3px; font-weight: 700;">$1</mark>');
}

function escapeRegex(str) {
  return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

// Modal wiring & Initialization
(() => {
  // Create background particles
  createParticles();
  
  // Render program cards
  render();
  
  // Initialize search
  initSearch();
  
  // Modal functionality
  const modal = document.getElementById('modal');
  const close = document.getElementById('closeModal');
  function hide() { modal.classList.remove('visible'); }
  close.addEventListener('click', hide);
  modal.addEventListener('click', (e) => { if (e.target === modal) hide(); });
  window.addEventListener('keydown', (e) => { 
    if (e.key === 'Escape') {
      if (modal.classList.contains('visible')) {
        hide();
      } else {
        // Close search results
        document.getElementById('searchResults').style.display = 'none';
      }
    }
  });
  
  // Smooth scroll for better UX
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });
})();
</script>
</body>
</html>
