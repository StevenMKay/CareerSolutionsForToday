document.addEventListener('DOMContentLoaded', function() {
  renderRecentTemplates();
});

// CSS Interactive Card Functions
function copyCode(elementId) {
  let textToCopy = '';
  const element = document.getElementById(elementId);
  
  if (elementId.includes('html-')) {
    textToCopy = element.value;
    showCopyMessage('HTML copied to clipboard!');
  } else if (elementId.includes('css-')) {
    textToCopy = element.value;
    showCopyMessage('CSS copied to clipboard!');
  } else if (elementId.includes('both-')) {
    const htmlId = elementId.replace('both-', 'html-');
    const cssId = elementId.replace('both-', 'css-');
    const htmlElement = document.getElementById(htmlId);
    const cssElement = document.getElementById(cssId);
    
    if (htmlElement && cssElement) {
      textToCopy = `HTML:\
${htmlElement.value}\
\
CSS:\
${cssElement.value}`;
      showCopyMessage('Both HTML and CSS copied to clipboard!');
    }
  }
  
  if (textToCopy) {
    navigator.clipboard.writeText(textToCopy).then(() => {
      console.log('Code copied successfully');
    }).catch(err => {
      console.error('Failed to copy code: ', err);
      // Fallback for older browsers
      const textArea = document.createElement('textarea');
      textArea.value = textToCopy;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
    });
  }
}

function showCopyMessage(message) {
  // Remove existing messages
  const existingMessage = document.querySelector('.copy-message');
  if (existingMessage) {
    existingMessage.remove();
  }
  
  // Create and show new message
  const messageDiv = document.createElement('div');
  messageDiv.className = 'copy-message';
  messageDiv.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: #4CAF50;
    color: white;
    padding: 12px 20px;
    border-radius: 6px;
    z-index: 9999;
    font-family: 'Segoe UI', sans-serif;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  `;
  messageDiv.textContent = message;
  document.body.appendChild(messageDiv);
  
  // Remove message after 3 seconds
  setTimeout(() => {
    if (messageDiv) {
      messageDiv.remove();
    }
  }, 3000);
}

function updatePreview() {
  // This function would update the live preview when code is edited
  const cssCards = document.querySelectorAll('.css-interactive-card');
  
  cssCards.forEach(card => {
    const htmlEditor = card.querySelector('.html-editor');
    const cssEditor = card.querySelector('.css-editor');
    const preview = card.querySelector('.css-live-preview');
    const styleTag = card.querySelector('style');
    
    if (htmlEditor && cssEditor && preview && styleTag) {
      // Update the preview HTML
      preview.innerHTML = htmlEditor.value;
      
      // Update the CSS
      styleTag.textContent = cssEditor.value;
    }
  });
}