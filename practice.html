<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-11361526924"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'AW-11361526924');
  </script>
  
  <meta charset="UTF-8" />
  <title>Coding Practice - Career Solutions for Today</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="site.css">
 

 
  <!-- Add favicon - dark mode (default) -->
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/24f41fc0ba84fa65c8b2fad5155b6b32c824486e/icons/CareerIcon.png" media="(prefers-color-scheme: dark)">
  
  <!-- Add favicon - light mode -->
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/b26be6501f1cd10eb39e1257de10c6d856ca6996/icons/Career%20Icon%20Blue.png" media="(prefers-color-scheme: light)">
  

  


  <!-- Tools Dropdown Styles -->
  <style>
    /* TOOLS DROPDOWN - DESKTOP AND MOBILE STYLES */
    nav.navbar .nav-links li.dropdown {
      position: relative;
    }

    nav.navbar .nav-links li.dropdown span.dropdown-toggle {
      display: flex !important;
      align-items: center !important;
      cursor: pointer !important;
      color: white !important;
      text-decoration: none !important;
      font-size: inherit !important;
      font-weight: inherit !important;
    }

    nav.navbar .nav-links li.dropdown span.dropdown-toggle:hover {
      color: #0b4f6c !important;
    }

    nav.navbar .nav-links li.dropdown ul.dropdown-menu {
      position: absolute !important;
      top: 100% !important;
      left: 0 !important;
      background: #0b4f6c !important;
      min-width: 220px !important;
      border-radius: 8px !important;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2) !important;
      opacity: 0 !important;
      visibility: hidden !important;
      transform: translateY(-10px) !important;
      transition: all 0.3s ease !important;
      list-style: none !important;
      padding: 10px 0 !important;
      margin: 8px 0 0 0 !important;
      z-index: 9999 !important;
      pointer-events: none !important;
    }

    nav.navbar .nav-links li.dropdown:hover ul.dropdown-menu {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0) !important;
      pointer-events: auto !important;
    }

    nav.navbar .nav-links li.dropdown ul.dropdown-menu li {
      margin: 0 !important;
    }

    nav.navbar .nav-links li.dropdown ul.dropdown-menu li a {
      display: block !important;
      padding: 12px 20px !important;
      color: white !important;
      text-decoration: none !important;
      font-size: 15px !important;
      transition: background-color 0.2s ease !important;
      border-radius: 0 !important;
    }

    nav.navbar .nav-links li.dropdown ul.dropdown-menu li a:hover {
      background: rgba(255,255,255,0.1) !important;
    }

    .result-sample {
      margin-top: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      background: rgba(148, 163, 184, 0.15);
      border: 1px solid rgba(148, 163, 184, 0.3);
      color: #e2e8f0;
      font-size: 0.95rem;
    }

    .result-sample h5 {
      margin: 0 0 8px 0;
      font-size: 0.95rem;
      color: #f8fafc;
    }

    .result-sample .sample-row {
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.25);
    }

    .result-sample .sample-row:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    /* Mobile dropdown styles */
    @media screen and (max-width: 768px) {
      nav.navbar .nav-links li.dropdown ul.dropdown-menu {
        position: static !important;
        opacity: 1 !important;
        visibility: visible !important;
        transform: none !important;
        box-shadow: none !important;
        background: rgba(11, 79, 108, 0.9) !important;
        margin: 0 !important;
        border-radius: 0;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        padding: 0;
        pointer-events: auto !important;
      }
      
      nav.navbar .nav-links li.dropdown.mobile-open ul.dropdown-menu {
        max-height: 120px;
        padding: 5px 0;
      }
      
      nav.navbar .nav-links li.dropdown span.dropdown-toggle {
        cursor: pointer !important;
        padding: 12px 0 !important;
        color: inherit !important;
        font-size: inherit !important;
        font-weight: inherit !important;
        display: block !important;
      }
      
      nav.navbar .nav-links li.dropdown ul.dropdown-menu li a {
        padding: 10px 30px !important;
        font-size: 16px !important;
      }
    }
  </style>
</head>

<body>
<div data-supabase-config data-supabase-url="" data-supabase-anon-key="" data-supabase-redirect="/practice.html" hidden></div>
<nav class="navbar">
  <div class="nav-logo">Career Solutions for Today</div>

  <!-- Navigation links -->
  <ul class="nav-links" id="navLinks">
    <li><a href="index.html">Home</a></li>
    <li><a href="Learn.html" class="learn-underline">Learning Resources</a></li>
    <!--
    <li class="dropdown" id="toolsDropdown">
      <span class="dropdown-toggle" id="toolsToggle">Tools</span>
      <ul class="dropdown-menu" id="toolsDropdownMenu">
        <li><a href="businesscase.html" target="_blank">Business Case Calculator</a></li>
        <li><a href="amortization.html" target="_blank">Amortization Calculator</a></li>
        <li><a href="Signature Builder.html" target="_blank">Email Signature Builder</a></li>
        <li><a href="Excel.html" target="_blank">Excel Simulations</a></li>
        <li><a href="shortcuts.html" target="_blank">Shortcuts</a></li>
      </ul>
    </li>
    -->
    <!-- <li><a href="practice.html">Practice</a></li> -->
    <li><a href="codeplayground.html">Code Playground</a></li>
    <li><a href="products.html">Products</a></li>
    <li><a href="contact-form.html">Contact Me</a></li>
    <li><a href="AboutMe.html" class="about-underline">About Me</a></li>
  </ul>

  <!-- Hamburger menu for mobile -->
  <div class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('active')">
    <div></div>
    <div></div>
    <div></div>
  </div>
</nav>

<div class="container">
<aside class="sidebar" id="practiceSidebar">
  <!-- Simple practice sidebar without universal sidebar interference -->
  <div id="desktopSidebar">
    <h2>Programming Languages</h2>
    <div class="practice-language-btn" data-language="SQL" onclick="selectLanguage('SQL')">
      <img src="https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/ae90f4fb10d0211b5042bfcd3b072a41dc9ce917/icons/sqlicon.png" alt="SQL" style="width: 24px; height: 24px;">
      <span>SQL</span>
    </div>
    <div class="practice-language-btn" data-language="Python" onclick="selectLanguage('Python')">
      <img src="https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/70e80ea82e94fc8132ee73b7065f59daae3686f7/icons/python.png" alt="Python" style="width: 24px; height: 24px;">
      <span>Python</span>
    </div>
    <div class="practice-language-btn" data-language="JavaScript" onclick="selectLanguage('JavaScript')">
      <img src="https://github.com/StevenMKay/CareerSolutionsForToday/raw/bec276b558dc0f3049b3696abe7ef062e4cc4e0d/icons/javaicon.png" alt="JavaScript" style="width: 24px; height: 24px;">
      <span>JavaScript</span>
    </div>
    <div class="practice-language-btn" data-language="TypeScript" onclick="selectLanguage('TypeScript')">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/typescript/typescript-original.svg" alt="TypeScript" style="width: 24px; height: 24px;">
      <span>TypeScript</span>
    </div>
    <div class="practice-language-btn" data-language="Java" onclick="selectLanguage('Java')">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/java/java-original.svg" alt="Java" style="width: 24px; height: 24px;">
      <span>Java</span>
    </div>
    <div class="practice-language-btn" data-language="Go" onclick="selectLanguage('Go')">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/go/go-original.svg" alt="Go" style="width: 24px; height: 24px;">
      <span>Go</span>
    </div>
    <div class="practice-language-btn" data-language="C" onclick="selectLanguage('C')">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/c/c-original.svg" alt="C" style="width: 24px; height: 24px;">
      <span>C</span>
    </div>
    <div class="practice-language-btn" data-language="C++" onclick="selectLanguage('C++')">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/cplusplus/cplusplus-original.svg" alt="C++" style="width: 24px; height: 24px;">
      <span>C++</span>
    </div>
  </div>
  
  <!-- Topic Filter - Only shows when language is selected -->
  <div class="topic-filter" id="topicFilter" style="display: none;">
    <h3 style="color: white; margin: 20px 0 10px 0; font-size: 16px;">Topics</h3>
    <div class="topic-buttons" id="topicButtons">
      <!-- Topics will be populated dynamically -->
    </div>
  </div>

  <!-- Difficulty Filter -->
  <div class="difficulty-filter">
    <h3 style="color: white; margin: 20px 0 10px 0; font-size: 16px;">Difficulty</h3>
    <div class="difficulty-buttons">
      <div class="difficulty-btn active" data-difficulty="all" onclick="selectDifficulty('all')">
        <span>All</span>
      </div>
      <div class="difficulty-btn" data-difficulty="Easy" onclick="selectDifficulty('Easy')">
        <span>Easy</span>
      </div>
      <div class="difficulty-btn" data-difficulty="Medium" onclick="selectDifficulty('Medium')">
        <span>Medium</span>
      </div>
      <div class="difficulty-btn" data-difficulty="Hard" onclick="selectDifficulty('Hard')">
        <span>Hard</span>
      </div>
    </div>
  </div>
</aside>

  <div class="main-content">
    <div class="sticky-filter">
      <input type="text" id="practiceSearch" class="search-filter" placeholder="Search coding problems..." />
    </div>
    
    <div id="practiceResults">
      <div id="practicePlaceholder">
        Select a programming language from the sidebar to start practicing coding challenges.
      </div>
    </div>
  </div>
</div>

<script src="js/contentItems.js"></script>
<script src="js/demoObserver.js"></script>
<script src="js/backgrounds.js"></script>
<script src="js/practiceProblems.js"></script>

<script>
// Mobile dropdown functionality
document.addEventListener('DOMContentLoaded', function() {
  const toolsDropdown = document.getElementById('toolsDropdown');
  const toolsToggle = document.getElementById('toolsToggle');

  if (!toolsDropdown || !toolsToggle) {
    return;
  }
  
  // Handle mobile dropdown clicks
  toolsToggle.addEventListener('click', function(e) {
    if (window.innerWidth <= 768) {
      e.preventDefault();
      toolsDropdown.classList.toggle('mobile-open');
    }
  });
  
  // Handle window resize
  window.addEventListener('resize', function() {
    if (window.innerWidth > 768) {
      toolsDropdown.classList.remove('mobile-open');
    }
  });
});
</script>

<!-- Practice-specific JavaScript -->
<script>
// Practice page specific functionality
document.addEventListener('DOMContentLoaded', function() {
  // Initialize scroll detection for search bar
  initPracticeScrollDetection();
  
  // Hamburger menu toggle
  const hamburgerBtn = document.getElementById('hamburgerBtn');
  const navLinks = document.getElementById('navLinks');
  if (hamburgerBtn && navLinks) {
    hamburgerBtn.addEventListener('click', () => {
      navLinks.classList.toggle('open');
    });
    navLinks.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        navLinks.classList.remove('open');
      });
    });
  }
  
  // Load all problems by default
  renderAllProblems();
  
  // Add search functionality
  const searchInput = document.getElementById('practiceSearch');
  if (searchInput) {
    searchInput.addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase().trim();
      filterProblemsBySearch(searchTerm);
    });
  }
});

// Scroll detection for practice page search bar
function initPracticeScrollDetection() {
  const stickyFilter = document.querySelector('.sticky-filter');
  if (!stickyFilter) return;
  
  let lastScrollTop = 0;
  let scrollDirection = 'up';
  
  window.addEventListener('scroll', () => {
    const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    if (currentScrollTop > lastScrollTop && currentScrollTop > 100) {
      // Scrolling down - hide search bar
      if (scrollDirection !== 'down') {
        scrollDirection = 'down';
        stickyFilter.classList.add('scroll-hidden');
      }
    } else if (currentScrollTop < lastScrollTop) {
      // Scrolling up - show search bar
      if (scrollDirection !== 'up') {
        scrollDirection = 'up';
        stickyFilter.classList.remove('scroll-hidden');
      }
    }
    
    lastScrollTop = currentScrollTop <= 0 ? 0 : currentScrollTop;
  });
}

// Search filter function
function filterProblemsBySearch(searchTerm) {
  const resultsContainer = document.getElementById('practiceResults');
  const problems = window.practiceProblems || [];
  const selectedLanguage = getCurrentLanguage();
  const selectedDifficulty = getCurrentDifficulty();
  
  // Filter by language first
  let filteredProblems = problems;
  if (selectedLanguage !== 'all') {
    filteredProblems = filteredProblems.filter(p => p.language === selectedLanguage);
  }
  
  // Filter by difficulty
  if (selectedDifficulty !== 'all') {
    filteredProblems = filteredProblems.filter(p => p.difficulty === selectedDifficulty);
  }
  
  // Filter by search term (search in title, description, language)
  if (searchTerm) {
    filteredProblems = filteredProblems.filter(problem => {
      return problem.title.toLowerCase().includes(searchTerm) ||
             problem.description.toLowerCase().includes(searchTerm) ||
             problem.language.toLowerCase().includes(searchTerm) ||
             problem.difficulty.toLowerCase().includes(searchTerm);
    });
  }
  
  // Randomize the filtered results
  filteredProblems = shuffleArray(filteredProblems);
  
  if (filteredProblems.length === 0) {
    resultsContainer.innerHTML = `
      <div style="color: white; text-align: center; margin-top: 50px;">
        <h3>No problems found matching "${searchTerm}"</h3>
        <p>Try adjusting your search terms or filters.</p>
      </div>
    `;
    return;
  }
  
  let html = `<h2 style="color: white; text-align: center; margin-bottom: 30px;">Search Results for "${searchTerm}"</h2>`;
  
  // Group by language if showing all languages
  if (selectedLanguage === 'all') {
    const languageGroups = {};
    filteredProblems.forEach(problem => {
      if (!languageGroups[problem.language]) {
        languageGroups[problem.language] = [];
      }
      languageGroups[problem.language].push(problem);
    });
    
    Object.keys(languageGroups).sort().forEach(language => {
      html += `<h3 style="color: #0077be; margin: 30px 0 15px 0;">${language} Problems</h3>`;
      languageGroups[language].forEach(problem => {
        html += renderProblemCard(problem);
      });
    });
  } else {
    // Show single language results
    filteredProblems.forEach(problem => {
      html += renderProblemCard(problem);
    });
  }
  
  resultsContainer.innerHTML = html;
}

function renderAllProblems(difficulty = 'all') {
  const resultsContainer = document.getElementById('practiceResults');
  const topicFilter = document.getElementById('topicFilter');
  const problems = window.practiceProblems || [];
  
  // Hide topic filter when showing all languages
  topicFilter.style.display = 'none';
  
  // Clear language selection
  document.querySelectorAll('.practice-language-btn').forEach(btn => btn.classList.remove('active'));
  
  // Filter by difficulty only
  let filteredProblems = problems;
  if (difficulty !== 'all') {
    filteredProblems = problems.filter(p => p.difficulty === difficulty);
  }
  
  // RANDOMIZE ALL PROBLEMS ORDER
  filteredProblems = shuffleArray(filteredProblems);
  
  if (filteredProblems.length === 0) {
    resultsContainer.innerHTML = `
      <div style="color: white; text-align: center; margin-top: 50px;">
        <h3>No ${difficulty === 'all' ? '' : difficulty} problems found</h3>
        <p>Try selecting a different difficulty level.</p>
      </div>
    `;
    return;
  }
  
  // Group by language (but keep randomized order within each language)
  const languageGroups = {};
  filteredProblems.forEach(problem => {
    if (!languageGroups[problem.language]) {
      languageGroups[problem.language] = [];
    }
    languageGroups[problem.language].push(problem);
  });
  
  let html = `<h2 style="color: white; text-align: center; margin-bottom: 30px;">All Coding Challenges</h2>`;
  
  // Render each language group (languages in sorted order, but problems within each language randomized)
  Object.keys(languageGroups).sort().forEach(language => {
    html += `<h3 style="color: #0077be; margin: 30px 0 15px 0;">${language} Problems</h3>`;
    
    languageGroups[language].forEach(problem => {
      html += renderProblemCard(problem);
    });
  });
  
  resultsContainer.innerHTML = html;
}

// Function to submit and validate code
function submitCode(problemId) {
  const codeTextarea = document.getElementById(`code-${problemId}`);
  const resultDiv = document.getElementById(`result-${problemId}`);
  const userCode = codeTextarea.value.trim();
  
  if (!userCode) {
    resultDiv.innerHTML = '<div class="result-error">Please enter some code first!</div>';
    return;
  }
  
  // Find the problem
  const problem = window.practiceProblems.find(p => p.id === problemId);
  if (!problem) {
    resultDiv.innerHTML = '<div class="result-error">Problem not found!</div>';
    return;
  }
  
  // Validate the code
  const isCorrect = validateCode(userCode, problem);
  const sampleHeading = isCorrect ? 'Sample return for this prompt' : 'Expected return preview';
  const sampleMarkup = buildSampleResult(problem, sampleHeading);

  if (isCorrect) {
    resultDiv.innerHTML = `<div class="result-correct">✅ Correct! Great job!</div>${sampleMarkup || ''}`;
  } else {
    var incorrectCopy = `❌ Not quite right. ${problem.hint || 'Try again!'}`;
    if (sampleMarkup) {
      incorrectCopy += ' Here\'s what the correct solution returns:';
    }
    resultDiv.innerHTML = `<div class="result-incorrect">${incorrectCopy}</div>${sampleMarkup || ''}`;
  }
}

function showSolution(problemId) {
  const solutionDiv = document.getElementById(`solution-${problemId}`);
  const problem = window.practiceProblems.find(p => p.id === problemId);
  
  if (solutionDiv.style.display === 'none' || !solutionDiv.style.display) {
    solutionDiv.style.display = 'block';
    solutionDiv.innerHTML = `
      <h4>Solution:</h4>
      <pre class="solution-code">${problem.solution}</pre>
      <p class="solution-explanation">${problem.explanation || ''}</p>
    `;
  } else {
    solutionDiv.style.display = 'none';
  }
}

function validateCode(userCode, problem) {
  // Simple validation for different languages
  const cleanUserCode = userCode.trim().toLowerCase().replace(/\s+/g, ' ');
  const cleanExpected = problem.expectedOutput.toLowerCase().replace(/\s+/g, ' ');
  
  // For SQL, check if the query structure is correct
  if (problem.language === 'SQL') {
    return cleanUserCode.includes(cleanExpected) || 
           problem.validSolutions.some(sol => cleanUserCode.includes(sol.toLowerCase()));
  }
  
  const languagesUsingSnippetMatch = ['Python', 'JavaScript', 'TypeScript', 'Java', 'Go', 'C', 'C++'];
  if (languagesUsingSnippetMatch.includes(problem.language)) {
    return (problem.validSolutions || []).some(sol => 
      cleanUserCode.includes(sol.toLowerCase().replace(/\s+/g, ' '))
    );
  }

  return (problem.validSolutions || []).some(sol =>
    cleanUserCode.includes(sol.toLowerCase().replace(/\s+/g, ' '))
  );
}

function escapeHtml(str) {
  return (str === undefined || str === null ? '' : String(str))
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

function buildSampleResult(problem, heading) {
  if (!problem) return '';
  var examples = Array.isArray(problem.examples) ? problem.examples : [];
  if (examples.length) {
    var rows = examples.map(function(example, idx){
      var input = escapeHtml(example.input || '');
      var output = escapeHtml(example.output || '');
      return `<div class="sample-row"><strong>Example ${idx + 1} input:</strong> <code>${input}</code><br><strong>Example ${idx + 1} output:</strong> <code>${output}</code></div>`;
    }).join('');
    return `<div class="result-sample"><h5>${heading}</h5>${rows}</div>`;
  }
  if (problem.expectedOutput) {
    return `<div class="result-sample"><h5>${heading}</h5><code>${escapeHtml(problem.expectedOutput)}</code></div>`;
  }
  return '';
}

// Language selection function for sidebar buttons
function selectLanguage(language) {
  console.log('Selected language:', language);
  
  // Update active state
  document.querySelectorAll('.practice-language-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelector(`[data-language="${language}"]`).classList.add('active');
  
  // Show and populate topic filter for selected language
  showTopicFilter(language);
  
  // Render problems for selected language
  const difficulty = getCurrentDifficulty();
  renderPracticeProblems(language, difficulty);
}

// Topic data for each language
const languageTopics = {
  'SQL': [
    'Basic Queries',
    'Joins & Relations', 
    'Aggregation & Grouping',
    'Data Manipulation',
    'Subqueries',
    'Window Functions',
    'Advanced Topics'
  ],
  'Python': [
    'Basic Syntax',
    'Data Structures',
    'Algorithms',
    'String Manipulation', 
    'Functions & Logic',
    'Object-Oriented',
    'Advanced Concepts'
  ],
  'JavaScript': [
    'Basic Functions',
    'Arrays & Objects',
    'Async Programming',
    'Functional Programming',
    'DOM & Events',
    'ES6+ Features',
    'Design Patterns'
  ],
  'TypeScript': [
    'Types & Interfaces',
    'Generics',
    'Utility Types',
    'React & Frontend',
    'Node & Backend',
    'Tooling & Build',
    'Advanced Patterns'
  ],
  'Java': [
    'Collections & Streams',
    'Concurrency',
    'Spring & APIs',
    'OOP & Design',
    'Algorithms',
    'Testing',
    'Advanced JVM'
  ],
  'Go': [
    'Basics & Syntax',
    'Concurrency & Goroutines',
    'Web & APIs',
    'Data Structures',
    'Error Handling',
    'Interfaces & Structs',
    'Advanced Patterns'
  ],
  'C': [
    'Pointers & Memory',
    'C Data Structures',
    'C Algorithms',
    'File I/O',
    'Bitwise Operations',
    'Systems Programming',
    'Debugging & Testing'
  ],
  'C++': [
    'C++ STL & Containers',
    'C++ OOP & Classes',
    'C++ Templates & Generics',
    'Concurrency & Threads',
    'Performance Tuning',
    'Modern C++',
    'C++ Algorithms'
  ]
};

// Show topic filter and populate with language-specific topics
function showTopicFilter(language) {
  const topicFilter = document.getElementById('topicFilter');
  const topicButtons = document.getElementById('topicButtons');
  
  // Show the topic filter
  topicFilter.style.display = 'block';
  
  // Clear existing topics
  topicButtons.innerHTML = '';
  
  // Add "All Topics" option
  const allTopicsBtn = document.createElement('div');
  allTopicsBtn.className = 'topic-btn active';
  allTopicsBtn.setAttribute('data-topic', 'all');
  allTopicsBtn.onclick = () => selectTopic('all', language);
  allTopicsBtn.innerHTML = '<span>All Topics</span>';
  topicButtons.appendChild(allTopicsBtn);
  
  // Add language-specific topics
  const topics = languageTopics[language] || [];
  topics.forEach(topic => {
    const topicBtn = document.createElement('div');
    topicBtn.className = 'topic-btn';
    topicBtn.setAttribute('data-topic', topic);
    topicBtn.onclick = () => selectTopic(topic, language);
    topicBtn.innerHTML = `<span>${topic}</span>`;
    topicButtons.appendChild(topicBtn);
  });
}

// Topic selection function
function selectTopic(topic, language) {
  console.log('Selected topic:', topic, 'for language:', language);
  
  // Update active state for topic buttons
  document.querySelectorAll('.topic-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelector(`[data-topic="${topic}"]`).classList.add('active');
  
  // Get current difficulty
  const difficulty = getCurrentDifficulty();
  
  // Filter and render problems
  if (topic === 'all') {
    renderPracticeProblems(language, difficulty);
  } else {
    renderPracticeProblemsWithTopic(language, topic, difficulty);
  }
}

// Enhanced render function with topic filtering
function renderPracticeProblemsWithTopic(language, topic, difficulty = 'all') {
  const resultsContainer = document.getElementById('practiceResults');
  window.currentPracticeProgram = language;
  
  // Filter problems by language
  let filteredProblems = window.practiceProblems.filter(p => p.language === language);
  
  // Filter by topic (map topics to problem characteristics)
  filteredProblems = filteredProblems.filter(problem => {
    return matchesTopic(problem, topic);
  });
  
  // Filter by difficulty
  if (difficulty !== 'all') {
    filteredProblems = filteredProblems.filter(p => p.difficulty === difficulty);
  }
  
  // Randomize the filtered results
  filteredProblems = shuffleArray(filteredProblems);
  
  if (filteredProblems.length === 0) {
    resultsContainer.innerHTML = `
      <div style="color: white; text-align: center; margin-top: 50px;">
        <h3>No ${difficulty === 'all' ? '' : difficulty} problems found for ${topic} in ${language}</h3>
        <p>Try selecting a different topic or difficulty level.</p>
      </div>
    `;
    return;
  }
  
  let html = `<h2 style="color: white; text-align: center; margin-bottom: 30px;">${language} - ${topic}</h2>`;
  
  filteredProblems.forEach(problem => {
    html += renderProblemCard(problem);
  });
  
  resultsContainer.innerHTML = html;
}

// Function to match problems to topics based on their content
function matchesTopic(problem, topic) {
  const title = problem.title.toLowerCase();
  const description = problem.description.toLowerCase();
  
  const topicMap = {
    // SQL Topics
    'Basic Queries': ['select', 'find all', 'employees', 'filter', 'where', 'basic'],
    'Joins & Relations': ['join', 'inner join', 'left join', 'relationship', 'tables'],
    'Aggregation & Grouping': ['count', 'sum', 'average', 'group by', 'having', 'max', 'min'],
    'Data Manipulation': ['insert', 'update', 'delete', 'modify', 'change'],
    'Subqueries': ['subquery', 'nested', 'select.*select', 'higher', 'more than'],
    'Window Functions': ['row_number', 'rank', 'over', 'partition', 'window'],
    'Advanced Topics': ['recursive', 'cte', 'pivot', 'running total', 'hierarchy'],
    
    // Python Topics  
    'Basic Syntax': ['reverse', 'palindrome', 'factorial', 'basic', 'simple'],
    'Data Structures': ['list', 'array', 'dictionary', 'merge', 'structure'],
    'Algorithms': ['search', 'sort', 'two sum', 'algorithm', 'binary', 'quick'],
    'String Manipulation': ['string', 'anagram', 'character', 'word', 'text'],
    'Functions & Logic': ['function', 'fizzbuzz', 'logic', 'condition'],
    'Object-Oriented': ['class', 'object', 'design', 'oop'],
    'Advanced Concepts': ['recursion', 'dynamic', 'cache', 'lru', 'complex'],
    
    // JavaScript Topics
    'Basic Functions': ['function', 'basic', 'array sum', 'reverse', 'filter'],
    'Arrays & Objects': ['array', 'object', 'property', 'flatten', 'chunk'],
    'Async Programming': ['promise', 'async', 'await', 'timeout', 'debounce'],
    'Functional Programming': ['map', 'reduce', 'filter', 'curry', 'functional'],
    'DOM & Events': ['dom', 'event', 'observer', 'intersection'],
    'ES6+ Features': ['arrow', 'spread', 'destructure', 'template'],
    'Design Patterns': ['observer', 'emitter', 'pattern', 'bind', 'prototype'],

    // TypeScript Topics
    'Types & Interfaces': ['interface', 'type ', 'implements', 'extends', 'readonly'],
    'Generics': ['<t>', 'generic', 'extends unknown', 'infer', 'keyof'],
    'Utility Types': ['partial', 'record', 'pick', 'omit', 'readonly'],
    'React & Frontend': ['jsx', 'props', 'react', 'component', 'hook'],
    'Node & Backend': ['express', 'node', 'nest', 'api', 'server'],
    'Tooling & Build': ['tsconfig', 'compilerOptions', 'esbuild', 'vite', 'swc'],
    'Advanced Patterns': ['conditional type', 'satisfies', 'discriminated', 'never', 'asserts'],

    // Java Topics
    'Collections & Streams': ['stream', 'collectors', 'list', 'map.entry', 'filter'],
    'Concurrency': ['thread', 'executor', 'synchronized', 'future', 'volatile'],
    'Spring & APIs': ['restcontroller', 'spring', 'autowired', 'service', 'bean'],
    'OOP & Design': ['builder', 'singleton', 'interface', 'abstract', 'pattern'],
    'Algorithms': ['binary tree', 'graph', 'bfs', 'dfs', 'heap'],
    'Testing': ['junit', '@test', 'assertequals', 'mockito', 'assertthat'],
    'Advanced JVM': ['optional', 'record', 'sealed', 'lambda', 'stream api'],

    // Go Topics
    'Basics & Syntax': ['func ', 'package main', 'range', 'slice', 'map['],
    'Concurrency & Goroutines': ['goroutine', 'go func', 'channel', 'select', 'sync.waitgroup'],
    'Web & APIs': ['http', 'handler', 'json', 'router', 'mux'],
    'Data Structures': ['struct', 'type node struct', 'linked', 'heap', 'stack'],
    'Error Handling': ['error', 'fmt.Errorf', 'wrap', 'defer', 'panic'],
    'Interfaces & Structs': ['interface', 'method receiver', 'embedding', 'implements', 'type assert'],
    'Advanced Patterns': ['context', 'worker pool', 'pipeline', 'fan-out', 'fan-in'],

    // C Topics
    'Pointers & Memory': ['pointer', 'malloc', 'free', 'address', '*ptr', '&value'],
    'C Data Structures': ['struct node', 'linked list', 'queue', 'stack', 'array', 'struct'],
    'C Algorithms': ['quicksort', 'merge sort', 'binary search', 'recursion', 'dynamic array'],
    'File I/O': ['fopen', 'fclose', 'fprintf', 'fscanf', 'FILE *'],
    'Bitwise Operations': ['bitwise', '<<', '>>', '&', '|', '^', 'mask'],
    'Systems Programming': ['socket', 'signal', 'process', 'fork', 'syscall'],
    'Debugging & Testing': ['assert', 'printf', 'gdb', 'unit test'],

    // C++ Topics
    'C++ STL & Containers': ['std::vector', 'std::map', 'iterator', 'emplace', 'unordered'],
    'C++ OOP & Classes': ['class ', 'public:', 'private:', 'virtual', 'override'],
    'C++ Templates & Generics': ['template<', 'typename', 'concept', 'enable_if'],
    'Concurrency & Threads': ['std::thread', 'mutex', 'lock_guard', 'future'],
    'Performance Tuning': ['move', 'std::move', 'emplace_back', 'reserve', 'profiling'],
    'Modern C++': ['auto', 'constexpr', 'ranges', 'structured bindings'],
    'C++ Algorithms': ['std::sort', 'priority_queue', 'binary search', 'lower_bound']
  };
  
  const keywords = topicMap[topic] || [];
  return keywords.some(keyword => title.includes(keyword) || description.includes(keyword));
}

// Difficulty selection function for new button-style filters
function selectDifficulty(difficulty) {
  console.log('Selected difficulty:', difficulty);
  
  // Update active state for difficulty buttons
  document.querySelectorAll('.difficulty-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelector(`[data-difficulty="${difficulty}"]`).classList.add('active');
  
  // Check if a language is currently selected
  const activeLanguageBtn = document.querySelector('.practice-language-btn.active');
  if (activeLanguageBtn) {
    const currentLanguage = activeLanguageBtn.getAttribute('data-language');
    
    // Check if a topic is selected
    const activeTopicBtn = document.querySelector('.topic-btn.active');
    if (activeTopicBtn) {
      const currentTopic = activeTopicBtn.getAttribute('data-topic');
      if (currentTopic === 'all') {
        renderPracticeProblems(currentLanguage, difficulty);
      } else {
        renderPracticeProblemsWithTopic(currentLanguage, currentTopic, difficulty);
      }
    } else {
      renderPracticeProblems(currentLanguage, difficulty);
    }
  } else {
    // No specific language selected, render all languages with difficulty filter
    renderAllProblems(difficulty);
  }
}

function getCurrentDifficulty() {
  const activeDifficultyBtn = document.querySelector('.difficulty-btn.active');
  return activeDifficultyBtn ? activeDifficultyBtn.getAttribute('data-difficulty') : 'all';
}

function getCurrentLanguage() {
  const activeLanguageBtn = document.querySelector('.practice-language-btn.active');
  return activeLanguageBtn ? activeLanguageBtn.getAttribute('data-language') : 'all';
}

// Helper function to shuffle array (Fisher-Yates shuffle)
function shuffleArray(array) {
  const shuffled = [...array]; // Create a copy to avoid mutating original
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

// Helper function to render individual problem cards
function renderProblemCard(problem) {
  const uniqueId = problem.id;
  return `
    <div class="practice-problem-card">
      <div class="problem-header">
        <h3>${problem.title}</h3>
        <span class="difficulty-badge difficulty-${problem.difficulty.toLowerCase()}">${problem.difficulty}</span>
      </div>
      
      <div class="problem-description">
        <h4>Problem:</h4>
        <p>${problem.description}</p>
        
        ${problem.examples ? `
          <h4>Example:</h4>
          <div class="example-box">
            ${problem.examples.map(ex => `
              <div class="example">
                <strong>Input:</strong> <code>${ex.input}</code><br>
                <strong>Output:</strong> <code>${ex.output}</code>
              </div>
            `).join('')}
          </div>
        ` : ''}
      </div>
      
      <div class="coding-section">
        <h4>Your Solution:</h4>
        <textarea class="code-editor" id="code-${uniqueId}" placeholder="Write your ${problem.language} code here..." spellcheck="false">${problem.starterCode || ''}</textarea>
        
        <div class="action-buttons">
          <button class="submit-btn" onclick="submitCode('${uniqueId}')">Submit Code</button>
          <button class="hint-btn" onclick="showSolution('${uniqueId}')">Show Solution</button>
        </div>
        
        <div id="result-${uniqueId}" class="result-display"></div>
        <div id="solution-${uniqueId}" class="solution-display" style="display: none;"></div>
      </div>
    </div>
  `;
}

// Make renderPracticeProblems globally accessible
window.renderPracticeProblems = function(language, difficulty = 'all') {
  const resultsContainer = document.getElementById('practiceResults');
  window.currentPracticeProgram = language;
  
  // Filter problems by language and difficulty
  let filteredProblems = window.practiceProblems.filter(p => p.language === language);
  
  if (difficulty !== 'all') {
    filteredProblems = filteredProblems.filter(p => p.difficulty === difficulty);
  }
  
  // RANDOMIZE THE PROBLEMS ORDER
  filteredProblems = shuffleArray(filteredProblems);
  
  if (filteredProblems.length === 0) {
    resultsContainer.innerHTML = `
      <div style="color: white; text-align: center; margin-top: 50px;">
        <h3>No ${difficulty === 'all' ? '' : difficulty} problems found for ${language}</h3>
        <p>Try selecting a different difficulty level or check back later for more problems.</p>
      </div>
    `;
    return;
  }
  
  let html = `<h2 style="color: white; text-align: center; margin-bottom: 30px;">${language} Coding Challenges</h2>`;
  
  filteredProblems.forEach(problem => {
    html += renderProblemCard(problem);
  });
  
  resultsContainer.innerHTML = html;
}
</script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js" defer></script>
<script src="js/auth.js" defer></script>
<script src="js/navAuth.js" defer></script>

</body>
</html>
