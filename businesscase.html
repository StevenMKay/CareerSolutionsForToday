<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Business Case Development Tool - Career Solutions for Today</title>
  <meta name="description" content="Calculate ROI and build compelling business cases with our comprehensive development tool. Analyze costs, benefits, and payback periods for your initiatives.">
  <link rel="stylesheet" href="site.css">
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/24f41fc0ba84fa65c8b2fad5155b6b32c824486e/icons/CareerIcon.png">
  
  <style>
    /* Business Case Tool Specific Styles */
    .business-case-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 100px 20px 60px;
      min-height: 100vh;
    }

    .tool-header {
      text-align: center;
      margin-bottom: 40px;
      color: white;
    }

    .tool-header h1 {
      font-size: 42px;
      margin-bottom: 15px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .tool-header p {
      font-size: 18px;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    .calculator-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-top: 40px;
    }

    .input-panel, .results-panel {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.1);
    }

    .panel-title {
      color: white;
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 30px;
      text-align: center;
      padding-bottom: 15px;
      border-bottom: 2px solid rgba(255,255,255,0.2);
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .section {
      margin-bottom: 35px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .section-title {
      color: #00ffa6;
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .input-group {
      margin-bottom: 25px;
    }

    .input-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .input-label {
      color: white;
      font-weight: 600;
      font-size: 16px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .unknown-checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
      color: rgba(255,255,255,0.7);
      font-size: 14px;
      cursor: pointer;
    }

    .unknown-checkbox input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: #00ffa6;
    }

    .input-container {
      display: flex;
      align-items: center;
      gap: 15px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.2);
      transition: opacity 0.3s ease;
    }

    .input-container.disabled {
      opacity: 0.4;
      pointer-events: none;
    }

    .input-field {
      flex: 1;
      background: rgba(255,255,255,0.9);
      border: none;
      padding: 12px;
      border-radius: 6px;
      font-size: 16px;
      color: #333;
      min-width: 120px;
    }

    .input-slider {
      flex: 2;
      -webkit-appearance: none;
      height: 8px;
      border-radius: 5px;
      background: rgba(255,255,255,0.3);
      outline: none;
    }

    .input-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #00ffa6;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .input-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #00ffa6;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    .time-unit-selector, .salary-period-selector, .revenue-period-selector {
      display: flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .unit-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      font-weight: 500;
    }

    .unit-btn.active {
      background: #00ffa6;
      color: #0b4f6c;
      font-weight: bold;
    }

    .unit-btn:hover:not(.active) {
      background: rgba(255,255,255,0.3);
    }

    .results-card {
      background: rgba(255,255,255,0.1);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(255,255,255,0.15);
    }

    .results-title {
      color: #00ffa6;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .results-value {
      color: white;
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 5px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .results-subtitle {
      color: rgba(255,255,255,0.7);
      font-size: 14px;
    }

    .comparison-container {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .before-after {
      flex: 1;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
    }

    .before-after.before {
      border-left: 4px solid #ff6b6b;
    }

    .before-after.after {
      border-left: 4px solid #00ffa6;
    }

    .projection-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }

    .projection-card {
      background: rgba(255,255,255,0.08);
      border-radius: 12px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.1);
      text-align: center;
    }

    .projection-title {
      color: #00ffa6;
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 8px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .projection-value {
      color: white;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 3px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .projection-subtitle {
      color: rgba(255,255,255,0.6);
      font-size: 12px;
    }

    .business-type-indicator {
      background: rgba(0,255,166,0.2);
      border: 1px solid #00ffa6;
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 20px;
      text-align: center;
    }

    .business-type-text {
      color: #00ffa6;
      font-weight: bold;
      font-size: 16px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn-primary, .btn-secondary {
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: linear-gradient(45deg, #00ffa6, #00cc85);
      color: #0b4f6c;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,255,166,0.3);
    }

    .btn-secondary {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,0.3);
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .business-case-container {
        padding: 80px 15px 40px;
      }

      .calculator-layout {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .tool-header h1 {
        font-size: 32px;
      }

      .input-container {
        flex-direction: column;
        gap: 10px;
      }

      .input-field {
        min-width: 100%;
      }

      .comparison-container {
        flex-direction: column;
      }

      .projection-cards {
        grid-template-columns: 1fr;
      }

      .action-buttons {
        flex-direction: column;
      }

      .time-unit-selector, .salary-period-selector, .revenue-period-selector {
        justify-content: center;
      }

      .input-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
    }

    .help-text {
      color: rgba(255,255,255,0.6);
      font-size: 13px;
      margin-top: 5px;
      font-style: italic;
    }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="nav-logo">Career Solutions for Today</div>

  <!-- Search input -->
  <div class="nav-controls">
    <div class="search-container expanded">
      <input
        type="text"
        class="search-input"
        id="searchBar"
        title="Search"
        placeholder="Search all content..."
      >
      <button id="clearSearch" title="Clear" class="clear-btn">&times;</button>
    </div>
  </div>

  <!-- Navigation links -->
  <ul class="nav-links">
    <li><a href="index.html">Home</a></li>
    <li><a href="Videos.html">Videos</a></li>
    <li><a href="Templates.html">Templates</a></li>
    <li><a href="Learn.html">Learn</a></li>
    <li><a href="practice.html">Practice</a></li>
    <li><a href="AboutMe.html">About Me</a></li>
    <li><a href="businessCase.html" style="color: #00ffa6; font-weight: bold;">Business Case Tool</a></li>
  </ul>

  <!-- Hamburger menu for mobile -->
  <div class="hamburger" onclick="document.querySelector('.nav-links').classList.toggle('active')">
    <div></div>
    <div></div>
    <div></div>
  </div>
</nav>

<div class="business-case-container">
  <div class="tool-header">
    <h1>Business Case Development Tool</h1>
    <p>Calculate ROI, analyze costs and benefits, and build compelling business cases for your initiatives with our comprehensive calculator.</p>
  </div>

  <div class="calculator-layout">
    <!-- Input Panel -->
    <div class="input-panel">
      <h2 class="panel-title">Input Parameters</h2>
      
      <!-- Employee Section -->
      <div class="section">
        <h3 class="section-title">Employees</h3>
        
        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Number of Employees Affected</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="employeeCountUnknown" onchange="toggleUnknown('employeeCount')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="employeeCountContainer">
            <input type="number" class="input-field" id="employeeCount" value="10" min="1" max="10000">
            <input type="range" class="input-slider" id="employeeCountSlider" min="1" max="500" value="10">
          </div>
          <div class="help-text">How many people will be impacted by this change?</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Average Employee Salary</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="salaryUnknown" onchange="toggleUnknown('salary')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="salaryContainer">
            <input type="text" class="input-field" id="salary" value="25" min="10" max="500" step="0.50">
            <input type="range" class="input-slider" id="salarySlider" min="10" max="200" value="25" step="0.50">
          </div>
          <div class="salary-period-selector">
            <button class="unit-btn active" data-period="hourly" data-field="salary">Per Hour</button>
            <button class="unit-btn" data-period="monthly" data-field="salary">Per Month</button>
            <button class="unit-btn" data-period="annually" data-field="salary">Per Year</button>
          </div>
          <div class="help-text">Total compensation including benefits</div>
        </div>
      </div>

      <!-- Time Section -->
      <div class="section">
        <h3 class="section-title">Time Analysis</h3>
        
        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Current Time per Task</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="currentTimeUnknown" onchange="toggleUnknown('currentTime')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="currentTimeContainer">
            <input type="number" class="input-field" id="currentTime" value="30" min="1" max="480" step="0.5">
            <input type="range" class="input-slider" id="currentTimeSlider" min="1" max="480" value="30" step="0.5">
          </div>
          <div class="time-unit-selector">
            <button class="unit-btn active" data-unit="minutes" data-field="currentTime">Minutes</button>
            <button class="unit-btn" data-unit="hours" data-field="currentTime">Hours</button>
            <button class="unit-btn" data-unit="days" data-field="currentTime">Days</button>
          </div>
          <div class="help-text">How long does the current process take?</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Improved Time per Task</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="improvedTimeUnknown" onchange="toggleUnknown('improvedTime')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="improvedTimeContainer">
            <input type="number" class="input-field" id="improvedTime" value="15" min="1" max="480" step="0.5">
            <input type="range" class="input-slider" id="improvedTimeSlider" min="1" max="480" value="15" step="0.5">
          </div>
          <div class="time-unit-selector">
            <button class="unit-btn active" data-unit="minutes" data-field="improvedTime">Minutes</button>
            <button class="unit-btn" data-unit="hours" data-field="improvedTime">Hours</button>
            <button class="unit-btn" data-unit="days" data-field="improvedTime">Days</button>
          </div>
          <div class="help-text">How long will the new process take?</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Tasks per Employee per Day</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="tasksPerDayUnknown" onchange="toggleUnknown('tasksPerDay')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="tasksPerDayContainer">
            <input type="number" class="input-field" id="tasksPerDay" value="20" min="1" max="100">
            <input type="range" class="input-slider" id="tasksPerDaySlider" min="1" max="100" value="20">
          </div>
          <div class="help-text">How often is this task performed?</div>
        </div>
      </div>

      <!-- Revenue Generation Section -->
      <div class="section">
        <h3 class="section-title">Revenue Generation</h3>
        
        <div class="input-group">
          <div class="input-header">
            <label class="input-label">New Revenue per Unit</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="newRevenueUnknown" onchange="toggleUnknown('newRevenue')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="newRevenueContainer">
            <input type="text" class="input-field" id="newRevenue" value="0" min="0" max="100000" step="1">
            <input type="range" class="input-slider" id="newRevenueSlider" min="0" max="10000" value="0" step="1">
          </div>
          <div class="help-text">Revenue generated per transaction, sale, or unit</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">New Units per Employee per Day</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="newUnitsPerDayUnknown" onchange="toggleUnknown('newUnitsPerDay')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="newUnitsPerDayContainer">
            <input type="number" class="input-field" id="newUnitsPerDay" value="0" min="0" max="1000" step="1">
            <input type="range" class="input-slider" id="newUnitsPerDaySlider" min="0" max="100" value="0" step="1">
          </div>
          <div class="help-text">How many new revenue units will each employee generate daily?</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Revenue Growth Rate (% annually)</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="revenueGrowthUnknown" onchange="toggleUnknown('revenueGrowth')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="revenueGrowthContainer">
            <input type="number" class="input-field" id="revenueGrowth" value="0" min="0" max="100" step="0.5">
            <input type="range" class="input-slider" id="revenueGrowthSlider" min="0" max="50" value="0" step="0.5">
          </div>
          <div class="help-text">Expected annual growth rate for new revenue</div>
        </div>
      </div>

      <!-- Finance Section -->
      <div class="section">
        <h3 class="section-title">Financial Investment</h3>
        
        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Implementation Cost</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="implementationCostUnknown" onchange="toggleUnknown('implementationCost')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="implementationCostContainer">
            <input type="text" class="input-field" id="implementationCost" value="50,000" min="0" max="1000000" step="1000">
            <input type="range" class="input-slider" id="implementationCostSlider" min="0" max="500000" value="50000" step="1000">
          </div>
          <div class="help-text">Software, hardware, consulting, and setup costs</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Training Cost</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="trainingCostUnknown" onchange="toggleUnknown('trainingCost')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="trainingCostContainer">
            <input type="text" class="input-field" id="trainingCost" value="10,000" min="0" max="100000" step="500">
            <input type="range" class="input-slider" id="trainingCostSlider" min="0" max="100000" value="10000" step="500">
          </div>
          <div class="help-text">Employee training and change management</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Ongoing Annual Costs</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="ongoingCostUnknown" onchange="toggleUnknown('ongoingCost')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="ongoingCostContainer">
            <input type="text" class="input-field" id="ongoingCost" value="5,000" min="0" max="500000" step="500">
            <input type="range" class="input-slider" id="ongoingCostSlider" min="0" max="100000" value="5000" step="500">
          </div>
          <div class="help-text">Annual maintenance, support, licensing, and operational costs</div>
        </div>
      </div>

      <!-- Quality Section -->
      <div class="section">
        <h3 class="section-title">Quality Improvements</h3>
        
        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Current Error Rate (%)</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="currentErrorRateUnknown" onchange="toggleUnknown('currentErrorRate')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="currentErrorRateContainer">
            <input type="number" class="input-field" id="currentErrorRate" value="5" min="0" max="50" step="0.1">
            <input type="range" class="input-slider" id="currentErrorRateSlider" min="0" max="50" value="5" step="0.1">
          </div>
          <div class="help-text">Percentage of tasks that result in errors</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Improved Error Rate (%)</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="improvedErrorRateUnknown" onchange="toggleUnknown('improvedErrorRate')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="improvedErrorRateContainer">
            <input type="number" class="input-field" id="improvedErrorRate" value="1" min="0" max="50" step="0.1">
            <input type="range" class="input-slider" id="improvedErrorRateSlider" min="0" max="50" value="1" step="0.1">
          </div>
          <div class="help-text">Expected error rate after improvement</div>
        </div>

        <div class="input-group">
          <div class="input-header">
            <label class="input-label">Cost per Error</label>
            <label class="unknown-checkbox">
              <input type="checkbox" id="costPerErrorUnknown" onchange="toggleUnknown('costPerError')">
              Unknown/Not Applicable
            </label>
          </div>
          <div class="input-container" id="costPerErrorContainer">
            <input type="text" class="input-field" id="costPerError" value="100" min="1" max="10000" step="10">
            <input type="range" class="input-slider" id="costPerErrorSlider" min="1" max="10000" value="100" step="10">
          </div>
          <div class="help-text">Time and resources to fix each error</div>
        </div>
      </div>
    </div>

    <!-- Results Panel -->
    <div class="results-panel">
      <h2 class="panel-title">Results Analysis</h2>
      
      <!-- Business Type Indicator -->
      <div class="business-type-indicator" id="businessTypeIndicator">
        <div class="business-type-text" id="businessTypeText">Cost Savings Initiative</div>
      </div>
      
      <div class="comparison-container">
        <div class="before-after before">
          <h3 style="color: #ff6b6b; margin-top: 0;" id="beforeLabel">Before</h3>
          <div class="results-value" id="beforeCost">$0</div>
          <div class="results-subtitle" id="beforeSubtitle">Annual Cost</div>
        </div>
        <div class="before-after after">
          <h3 style="color: #00ffa6; margin-top: 0;" id="afterLabel">After</h3>
          <div class="results-value" id="afterCost">$0</div>
          <div class="results-subtitle" id="afterSubtitle">Annual Benefit</div>
        </div>
      </div>

      <div class="results-card">
        <div class="results-title" id="totalBenefitTitle">Annual Net Benefit</div>
        <div class="results-value" id="totalSavings">$0</div>
        <div class="results-subtitle" id="totalBenefitSubtitle">Net benefit after all costs</div>
      </div>

      <div class="results-card">
        <div class="results-title">Return on Investment (ROI)</div>
        <div class="results-value" id="roiPercentage">0%</div>
        <div class="results-subtitle">ROI after first year</div>
      </div>

      <div class="results-card">
        <div class="results-title">Payback Period</div>
        <div class="results-value" id="paybackPeriod">0 months</div>
        <div class="results-subtitle">Time to recover investment</div>
      </div>

      <div class="results-card" id="timeSavingsCard">
        <div class="results-title">Time Savings</div>
        <div class="results-value" id="timeSavings">0 hours/year</div>
        <div class="results-subtitle">Annual time saved across all employees</div>
      </div>

      <div class="results-card" id="revenueCard" style="display: none;">
        <div class="results-title">New Revenue Generated</div>
        <div class="results-value" id="newRevenueGenerated">$0/year</div>
        <div class="results-subtitle">Annual revenue from new initiative</div>
      </div>

      <div class="results-card" id="qualityCard">
        <div class="results-title">Quality Improvement</div>
        <div class="results-value" id="errorSavings">$0/year</div>
        <div class="results-subtitle">Annual savings from reduced errors</div>
      </div>

      <!-- Future Projections -->
      <div class="projection-cards">
        <div class="projection-card">
          <div class="projection-title">3-Year Projection</div>
          <div class="projection-value" id="threeYearSavings">$0</div>
          <div class="projection-subtitle">Cumulative net benefit</div>
        </div>
        <div class="projection-card">
          <div class="projection-title">5-Year Projection</div>
          <div class="projection-value" id="fiveYearSavings">$0</div>
          <div class="projection-subtitle">Cumulative net benefit</div>
        </div>
      </div>
    </div>
  </div>

  <div class="action-buttons">
    <button class="btn-primary" onclick="downloadPDF()">Download Report</button>
    <button class="btn-secondary" onclick="downloadCSV()">Download Data</button>
    <button class="btn-secondary" onclick="resetCalculator()">Reset Calculator</button>
  </div>
</div>

<!-- Include backgrounds.js -->
<script src="js/backgrounds.js"></script>

<script>
// Global variables for calculations
let timeUnits = {
  currentTime: 'minutes',
  improvedTime: 'minutes'
};

let salaryPeriod = 'hourly';
let unknownFields = new Set();

// Initialize calculator
document.addEventListener('DOMContentLoaded', function() {
  initializeCalculator();
  calculateResults();
});

function initializeCalculator() {
  // Define currency fields that should be formatted
  const currencyFields = ['salary', 'implementationCost', 'trainingCost', 'ongoingCost', 'costPerError', 'newRevenue'];
  
  // Sync sliders with input fields
  const inputs = [
    'employeeCount', 'salary', 'currentTime', 'improvedTime', 
    'tasksPerDay', 'implementationCost', 'trainingCost', 'ongoingCost',
    'currentErrorRate', 'improvedErrorRate', 'costPerError',
    'newRevenue', 'newUnitsPerDay', 'revenueGrowth'
  ];

  inputs.forEach(id => {
    const input = document.getElementById(id);
    const slider = document.getElementById(id + 'Slider');
    
    if (input && slider) {
      // Add currency formatting for money fields
      if (currencyFields.includes(id)) {
        // Format initial value
        formatCurrencyInput(input);
        
        // Add event listeners for currency formatting
        input.addEventListener('focus', function() {
          // Remove formatting on focus for easier editing
          this.value = parseCurrencyInput(this.value).toString();
        });
        
        input.addEventListener('blur', function() {
          // Add formatting back on blur
          formatCurrencyInput(this);
          slider.value = parseCurrencyInput(this.value);
          calculateResults();
        });
        
        input.addEventListener('input', function() {
          const numericValue = parseCurrencyInput(this.value);
          slider.value = numericValue;
          calculateResults();
        });
      } else {
        // Regular input handling for non-currency fields
        input.addEventListener('input', function() {
          slider.value = this.value;
          calculateResults();
        });
      }
      
      // Sync slider to input
      slider.addEventListener('input', function() {
        const newValue = this.value;
        if (currencyFields.includes(id)) {
          input.value = formatCurrencyValue(newValue);
        } else {
          input.value = newValue;
        }
        calculateResults();
      });
    }
  });

  // Time unit buttons
  document.querySelectorAll('[data-unit]').forEach(btn => {
    btn.addEventListener('click', function() {
      const field = this.dataset.field;
      const unit = this.dataset.unit;
      
      // Remove active class from siblings
      this.parentElement.querySelectorAll('.unit-btn').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      
      // Update time unit
      timeUnits[field] = unit;
      
      // Update slider ranges based on unit
      updateSliderRanges(field, unit);
      calculateResults();
    });
  });

  // Salary period buttons
  document.querySelectorAll('[data-period]').forEach(btn => {
    btn.addEventListener('click', function() {
      const period = this.dataset.period;
      
      // Remove active class from siblings
      this.parentElement.querySelectorAll('.unit-btn').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      
      // Update salary period
      salaryPeriod = period;
      
      // Update slider ranges based on period
      updateSalaryRanges(period);
      calculateResults();
    });
  });
}

function toggleUnknown(fieldName) {
  const checkbox = document.getElementById(fieldName + 'Unknown');
  const container = document.getElementById(fieldName + 'Container');
  
  if (checkbox.checked) {
    unknownFields.add(fieldName);
    container.classList.add('disabled');
  } else {
    unknownFields.delete(fieldName);
    container.classList.remove('disabled');
  }
  
  calculateResults();
}

function updateSliderRanges(field, unit) {
  const slider = document.getElementById(field + 'Slider');
  const input = document.getElementById(field);
  
  let max, step;
  switch(unit) {
    case 'minutes':
      max = 480; // 8 hours in minutes
      step = 0.5;
      break;
    case 'hours':
      max = 24;
      step = 0.25;
      break;
    case 'days':
      max = 30;
      step = 0.1;
      break;
  }
  
  slider.max = max;
  slider.step = step;
  input.max = max;
  input.step = step;
  
  // Adjust current value if it exceeds new max
  if (parseFloat(slider.value) > max) {
    slider.value = max;
    input.value = max;
  }
}

function updateSalaryRanges(period) {
  const slider = document.getElementById('salarySlider');
  const input = document.getElementById('salary');
  
  let max, min, step;
  switch(period) {
    case 'hourly':
      min = 10;
      max = 200;
      step = 0.5;
      break;
    case 'monthly':
      min = 2000;
      max = 25000;
      step = 100;
      break;
    case 'annually':
      min = 25000;
      max = 300000;
      step = 1000;
      break;
  }
  
  slider.min = min;
  slider.max = max;
  slider.step = step;
  input.min = min;
  input.max = max;
  input.step = step;
  
  // Set reasonable default values
  let defaultValue;
  switch(period) {
    case 'hourly':
      defaultValue = 25;
      break;
    case 'monthly':
      defaultValue = 4000;
      break;
    case 'annually':
      defaultValue = 50000;
      break;
  }
  
  if (parseFloat(slider.value) < min || parseFloat(slider.value) > max) {
    slider.value = defaultValue;
    input.value = defaultValue;
  }
}

function calculateResults() {
  // Get input values, treating unknown fields as 0 and parsing currency fields
  const employeeCount = unknownFields.has('employeeCount') ? 0 : (parseFloat(document.getElementById('employeeCount').value) || 0);
  const salary = unknownFields.has('salary') ? 0 : (parseCurrencyInput(document.getElementById('salary').value) || 0);
  const currentTime = unknownFields.has('currentTime') ? 0 : convertToMinutes(parseFloat(document.getElementById('currentTime').value) || 0, timeUnits.currentTime);
  const improvedTime = unknownFields.has('improvedTime') ? 0 : convertToMinutes(parseFloat(document.getElementById('improvedTime').value) || 0, timeUnits.improvedTime);
  const tasksPerDay = unknownFields.has('tasksPerDay') ? 0 : (parseFloat(document.getElementById('tasksPerDay').value) || 0);
  const implementationCost = unknownFields.has('implementationCost') ? 0 : (parseCurrencyInput(document.getElementById('implementationCost').value) || 0);
  const trainingCost = unknownFields.has('trainingCost') ? 0 : (parseCurrencyInput(document.getElementById('trainingCost').value) || 0);
  const ongoingCost = unknownFields.has('ongoingCost') ? 0 : (parseCurrencyInput(document.getElementById('ongoingCost').value) || 0);
  const currentErrorRate = unknownFields.has('currentErrorRate') ? 0 : (parseFloat(document.getElementById('currentErrorRate').value) || 0);
  const improvedErrorRate = unknownFields.has('improvedErrorRate') ? 0 : (parseFloat(document.getElementById('improvedErrorRate').value) || 0);
  const costPerError = unknownFields.has('costPerError') ? 0 : (parseCurrencyInput(document.getElementById('costPerError').value) || 0);
  const newRevenue = unknownFields.has('newRevenue') ? 0 : (parseCurrencyInput(document.getElementById('newRevenue').value) || 0);
  const newUnitsPerDay = unknownFields.has('newUnitsPerDay') ? 0 : (parseFloat(document.getElementById('newUnitsPerDay').value) || 0);
  const revenueGrowth = unknownFields.has('revenueGrowth') ? 0 : (parseFloat(document.getElementById('revenueGrowth').value) || 0);

  // Convert salary to hourly rate
  let hourlySalary;
  switch(salaryPeriod) {
    case 'monthly':
      hourlySalary = salary / (40 * 4.33); // 40 hours/week * 4.33 weeks/month
      break;
    case 'annually':
      hourlySalary = salary / (40 * 52); // 40 hours/week * 52 weeks/year
      break;
    default: // hourly
      hourlySalary = salary;
  }

  // Calculate time savings
  const timeSavedPerTask = Math.max(0, currentTime - improvedTime); // in minutes
  const timeSavedPerDay = (timeSavedPerTask * tasksPerDay) / 60; // in hours
  const timeSavedPerYear = timeSavedPerDay * employeeCount * 250; // 250 working days

  // Calculate cost savings from time
  const laborSavingsPerYear = timeSavedPerYear * hourlySalary;

  // Calculate error cost savings
  const errorsPerYear = tasksPerDay * employeeCount * 250;
  const currentErrorCost = errorsPerYear * (currentErrorRate / 100) * costPerError;
  const improvedErrorCost = errorsPerYear * (improvedErrorRate / 100) * costPerError;
  const errorSavingsPerYear = Math.max(0, currentErrorCost - improvedErrorCost);

  // Calculate new revenue generation
  const newRevenuePerYear = newRevenue * newUnitsPerDay * employeeCount * 250;

  // Determine business case type
  const hasTimeSavings = timeSavedPerTask > 0;
  const hasErrorSavings = errorSavingsPerYear > 0;
  const hasRevenue = newRevenuePerYear > 0;
  
  let businessType;
  if (hasRevenue && (hasTimeSavings || hasErrorSavings)) {
    businessType = 'mixed';
  } else if (hasRevenue) {
    businessType = 'revenue';
  } else {
    businessType = 'savings';
  }

  // Update UI based on business type
  updateBusinessTypeUI(businessType);

  // Total calculations
  const totalSavingsPerYear = laborSavingsPerYear + errorSavingsPerYear;
  const totalBenefitsPerYear = totalSavingsPerYear + newRevenuePerYear;
  const totalImplementationCost = implementationCost + trainingCost;
  const netBenefitYear1 = totalBenefitsPerYear - totalImplementationCost - ongoingCost;
  
  // ROI and Payback (accounting for ongoing costs)
  const roi = totalImplementationCost > 0 ? ((totalBenefitsPerYear - ongoingCost - totalImplementationCost) / totalImplementationCost) * 100 : 0;
  const monthlyBenefit = (totalBenefitsPerYear - ongoingCost) / 12;
  const paybackMonths = monthlyBenefit > 0 ? (totalImplementationCost / monthlyBenefit) : 0;

  // Before/After annual costs/benefits
  let beforeAnnualCost, afterAnnualValue;
  
  if (businessType === 'revenue') {
    beforeAnnualCost = 0; // No revenue before
    afterAnnualValue = newRevenuePerYear - ongoingCost; // Revenue minus ongoing costs
  } else {
    beforeAnnualCost = (currentTime / 60) * tasksPerDay * employeeCount * 250 * hourlySalary + currentErrorCost;
    afterAnnualValue = totalBenefitsPerYear - ongoingCost; // Benefits minus ongoing costs
  }

  // Multi-year projections with revenue growth and ongoing costs
  let threeYearBenefit = 0;
  let fiveYearBenefit = 0;
  
  for (let year = 1; year <= 5; year++) {
    const yearlyRevenue = newRevenuePerYear * Math.pow(1 + (revenueGrowth / 100), year - 1);
    const yearlyBenefit = totalSavingsPerYear + yearlyRevenue - ongoingCost;
    
    if (year <= 3) {
      threeYearBenefit += yearlyBenefit;
    }
    fiveYearBenefit += yearlyBenefit;
  }
  
  const threeYearNet = threeYearBenefit - totalImplementationCost;
  const fiveYearNet = fiveYearBenefit - totalImplementationCost;

  // Update display
  document.getElementById('beforeCost').textContent = formatCurrency(beforeAnnualCost);
  document.getElementById('afterCost').textContent = formatCurrency(afterAnnualValue);
  document.getElementById('totalSavings').textContent = formatCurrency(netBenefitYear1);
  document.getElementById('roiPercentage').textContent = roi.toFixed(1) + '%';
  document.getElementById('paybackPeriod').textContent = paybackMonths > 0 ? paybackMonths.toFixed(1) + ' months' : 'N/A';
  document.getElementById('timeSavings').textContent = formatNumber(timeSavedPerYear) + ' hours/year';
  document.getElementById('errorSavings').textContent = formatCurrency(errorSavingsPerYear);
  document.getElementById('newRevenueGenerated').textContent = formatCurrency(newRevenuePerYear);
  document.getElementById('threeYearSavings').textContent = formatCurrency(threeYearNet);
  document.getElementById('fiveYearSavings').textContent = formatCurrency(fiveYearNet);
}

function updateBusinessTypeUI(businessType) {
  const typeIndicator = document.getElementById('businessTypeText');
  const timeSavingsCard = document.getElementById('timeSavingsCard');
  const revenueCard = document.getElementById('revenueCard');
  const qualityCard = document.getElementById('qualityCard');
  const beforeLabel = document.getElementById('beforeLabel');
  const afterLabel = document.getElementById('afterLabel');
  const beforeSubtitle = document.getElementById('beforeSubtitle');
  const afterSubtitle = document.getElementById('afterSubtitle');
  const totalBenefitTitle = document.getElementById('totalBenefitTitle');
  const totalBenefitSubtitle = document.getElementById('totalBenefitSubtitle');

  switch(businessType) {
    case 'revenue':
      typeIndicator.textContent = 'Revenue Generation Initiative';
      revenueCard.style.display = 'block';
      beforeLabel.textContent = 'Current';
      afterLabel.textContent = 'With Initiative';
      beforeSubtitle.textContent = 'Annual Revenue';
      afterSubtitle.textContent = 'Annual Revenue';
      totalBenefitTitle.textContent = 'Annual Net Revenue';
      totalBenefitSubtitle.textContent = 'Net revenue after all costs';
      break;
    case 'mixed':
      typeIndicator.textContent = 'Mixed: Cost Savings + Revenue Generation';
      revenueCard.style.display = 'block';
      beforeLabel.textContent = 'Before';
      afterLabel.textContent = 'After';
      beforeSubtitle.textContent = 'Annual Cost';
      afterSubtitle.textContent = 'Annual Benefit';
      totalBenefitTitle.textContent = 'Annual Net Benefit';
      totalBenefitSubtitle.textContent = 'Net benefit from all sources';
      break;
    default: // savings
      typeIndicator.textContent = 'Cost Savings Initiative';
      revenueCard.style.display = 'none';
      beforeLabel.textContent = 'Before';
      afterLabel.textContent = 'After';
      beforeSubtitle.textContent = 'Annual Cost';
      afterSubtitle.textContent = 'Annual Savings';
      totalBenefitTitle.textContent = 'Annual Net Savings';
      totalBenefitSubtitle.textContent = 'Net savings after all costs';
      break;
  }
}

function convertToMinutes(value, unit) {
  switch(unit) {
    case 'hours': return value * 60;
    case 'days': return value * 60 * 8; // 8-hour workday
    default: return value; // minutes
  }
}

function formatCurrency(amount) {
  return new Intl.NumberFormat('en-US', { 
    style: 'currency', 
    currency: 'USD',
    minimumFractionDigits: 0,
    maximumFractionDigits: 0
  }).format(amount);
}

function formatNumber(num) {
  return new Intl.NumberFormat('en-US', {
    minimumFractionDigits: 0,
    maximumFractionDigits: 1
  }).format(num);
}

// Currency input formatting functions
function parseCurrencyInput(value) {
  if (typeof value === 'string') {
    // Remove currency symbols, commas, and spaces
    return parseFloat(value.replace(/[$,\s]/g, '')) || 0;
  }
  return parseFloat(value) || 0;
}

function formatCurrencyValue(value) {
  const numValue = parseCurrencyInput(value);
  if (numValue === 0) return '0';
  return numValue.toLocaleString('en-US');
}

function formatCurrencyInput(inputElement) {
  const value = parseCurrencyInput(inputElement.value);
  if (value === 0) {
    inputElement.value = '0';
  } else {
    inputElement.value = formatCurrencyValue(value);
  }
}

function downloadPDF() {
  const reportData = generateReportData();
  const content = `
BUSINESS CASE ANALYSIS REPORT
Generated on: ${new Date().toLocaleDateString()}

${reportData}

This report was generated by the Career Solutions for Today Business Case Development Tool.
  `.trim();
  
  downloadFile(content, 'business-case-report.txt', 'text/plain');
  alert('Report downloaded as text file. You can copy the content to create a PDF or formatted document.');
}

function downloadCSV() {
  const csvContent = generateCSVData();
  downloadFile(csvContent, 'business-case-data.csv', 'text/csv');
}

function generateReportData() {
  const businessType = document.getElementById('businessTypeText').textContent;
  
  const inputs = {
    employeeCount: unknownFields.has('employeeCount') ? 'Unknown/Not Applicable' : document.getElementById('employeeCount').value,
    salary: unknownFields.has('salary') ? 'Unknown/Not Applicable' : document.getElementById('salary').value + ' (' + salaryPeriod + ')',
    currentTime: unknownFields.has('currentTime') ? 'Unknown/Not Applicable' : document.getElementById('currentTime').value + ' ' + timeUnits.currentTime,
    improvedTime: unknownFields.has('improvedTime') ? 'Unknown/Not Applicable' : document.getElementById('improvedTime').value + ' ' + timeUnits.improvedTime,
    tasksPerDay: unknownFields.has('tasksPerDay') ? 'Unknown/Not Applicable' : document.getElementById('tasksPerDay').value,
    implementationCost: unknownFields.has('implementationCost') ? 'Unknown/Not Applicable' : '$' + document.getElementById('implementationCost').value,
    trainingCost: unknownFields.has('trainingCost') ? 'Unknown/Not Applicable' : '$' + document.getElementById('trainingCost').value,
    ongoingCost: unknownFields.has('ongoingCost') ? 'Unknown/Not Applicable' : '$' + document.getElementById('ongoingCost').value,
    currentErrorRate: unknownFields.has('currentErrorRate') ? 'Unknown/Not Applicable' : document.getElementById('currentErrorRate').value + '%',
    improvedErrorRate: unknownFields.has('improvedErrorRate') ? 'Unknown/Not Applicable' : document.getElementById('improvedErrorRate').value + '%',
    costPerError: unknownFields.has('costPerError') ? 'Unknown/Not Applicable' : '$' + document.getElementById('costPerError').value,
    newRevenue: unknownFields.has('newRevenue') ? 'Unknown/Not Applicable' : '$' + document.getElementById('newRevenue').value,
    newUnitsPerDay: unknownFields.has('newUnitsPerDay') ? 'Unknown/Not Applicable' : document.getElementById('newUnitsPerDay').value,
    revenueGrowth: unknownFields.has('revenueGrowth') ? 'Unknown/Not Applicable' : document.getElementById('revenueGrowth').value + '%'
  };

  const results = {
    businessType: businessType,
    beforeCost: document.getElementById('beforeCost').textContent,
    afterCost: document.getElementById('afterCost').textContent,
    totalSavings: document.getElementById('totalSavings').textContent,
    roiPercentage: document.getElementById('roiPercentage').textContent,
    paybackPeriod: document.getElementById('paybackPeriod').textContent,
    timeSavings: document.getElementById('timeSavings').textContent,
    errorSavings: document.getElementById('errorSavings').textContent,
    newRevenue: document.getElementById('newRevenueGenerated').textContent,
    threeYearSavings: document.getElementById('threeYearSavings').textContent,
    fiveYearSavings: document.getElementById('fiveYearSavings').textContent
  };

  return `
BUSINESS CASE TYPE: ${results.businessType}

EXECUTIVE SUMMARY
================
Annual Net Benefit: ${results.totalSavings}
ROI: ${results.roiPercentage}
Payback Period: ${results.paybackPeriod}
3-Year Cumulative Benefit: ${results.threeYearSavings}
5-Year Cumulative Benefit: ${results.fiveYearSavings}

INPUT PARAMETERS
================
Business Case Type: ${results.businessType}
Employees Affected: ${inputs.employeeCount}
Average Salary: ${inputs.salary}
Current Time per Task: ${inputs.currentTime}
Improved Time per Task: ${inputs.improvedTime}
Tasks per Day: ${inputs.tasksPerDay}
Implementation Cost: ${inputs.implementationCost}
Training Cost: ${inputs.trainingCost}
Ongoing Annual Cost: ${inputs.ongoingCost}
Current Error Rate: ${inputs.currentErrorRate}
Improved Error Rate: ${inputs.improvedErrorRate}
Cost per Error: ${inputs.costPerError}
New Revenue per Unit: ${inputs.newRevenue}
New Units per Day: ${inputs.newUnitsPerDay}
Revenue Growth Rate: ${inputs.revenueGrowth}

RESULTS ANALYSIS
================
Before State: ${results.beforeCost}
After State: ${results.afterCost}
Annual Time Savings: ${results.timeSavings}
Annual Error Savings: ${results.errorSavings}
Annual New Revenue: ${results.newRevenue}
Total Annual Benefit: ${results.totalSavings}
Return on Investment: ${results.roiPercentage}
Payback Period: ${results.paybackPeriod}

LONG-TERM PROJECTIONS
====================
3-Year Cumulative Net Benefit: ${results.threeYearSavings}
5-Year Cumulative Net Benefit: ${results.fiveYearSavings}
  `;
}

function generateCSVData() {
  const data = [
    ['Parameter', 'Value'],
    ['Business Case Type', document.getElementById('businessTypeText').textContent],
    ['Employee Count', unknownFields.has('employeeCount') ? 'Unknown/Not Applicable' : document.getElementById('employeeCount').value],
    ['Salary', unknownFields.has('salary') ? 'Unknown/Not Applicable' : document.getElementById('salary').value + ' (' + salaryPeriod + ')'],
    ['Current Time per Task', unknownFields.has('currentTime') ? 'Unknown/Not Applicable' : document.getElementById('currentTime').value + ' ' + timeUnits.currentTime],
    ['Improved Time per Task', unknownFields.has('improvedTime') ? 'Unknown/Not Applicable' : document.getElementById('improvedTime').value + ' ' + timeUnits.improvedTime],
    ['Tasks per Day', unknownFields.has('tasksPerDay') ? 'Unknown/Not Applicable' : document.getElementById('tasksPerDay').value],
    ['Implementation Cost', unknownFields.has('implementationCost') ? 'Unknown/Not Applicable' : document.getElementById('implementationCost').value],
    ['Training Cost', unknownFields.has('trainingCost') ? 'Unknown/Not Applicable' : document.getElementById('trainingCost').value],
    ['Ongoing Annual Cost', unknownFields.has('ongoingCost') ? 'Unknown/Not Applicable' : document.getElementById('ongoingCost').value],
    ['Current Error Rate', unknownFields.has('currentErrorRate') ? 'Unknown/Not Applicable' : document.getElementById('currentErrorRate').value + '%'],
    ['Improved Error Rate', unknownFields.has('improvedErrorRate') ? 'Unknown/Not Applicable' : document.getElementById('improvedErrorRate').value + '%'],
    ['Cost per Error', unknownFields.has('costPerError') ? 'Unknown/Not Applicable' : document.getElementById('costPerError').value],
    ['New Revenue per Unit', unknownFields.has('newRevenue') ? 'Unknown/Not Applicable' : document.getElementById('newRevenue').value],
    ['New Units per Day', unknownFields.has('newUnitsPerDay') ? 'Unknown/Not Applicable' : document.getElementById('newUnitsPerDay').value],
    ['Revenue Growth Rate', unknownFields.has('revenueGrowth') ? 'Unknown/Not Applicable' : document.getElementById('revenueGrowth').value + '%'],
    [''],
    ['Results', 'Value'],
    ['Before State', document.getElementById('beforeCost').textContent],
    ['After State', document.getElementById('afterCost').textContent],
    ['Total Annual Benefit', document.getElementById('totalSavings').textContent],
    ['ROI Percentage', document.getElementById('roiPercentage').textContent],
    ['Payback Period', document.getElementById('paybackPeriod').textContent],
    ['Annual Time Savings', document.getElementById('timeSavings').textContent],
    ['Annual Error Savings', document.getElementById('errorSavings').textContent],
    ['Annual New Revenue', document.getElementById('newRevenueGenerated').textContent],
    ['3-Year Cumulative Benefit', document.getElementById('threeYearSavings').textContent],
    ['5-Year Cumulative Benefit', document.getElementById('fiveYearSavings').textContent]
  ];

  return data.map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
}

function downloadFile(content, filename, contentType) {
  const blob = new Blob([content], { type: contentType });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = filename;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  URL.revokeObjectURL(url);
}

function resetCalculator() {
  if (confirm('Are you sure you want to reset all values to defaults?')) {
    // Reset all inputs to default values
    document.getElementById('employeeCount').value = 10;
    document.getElementById('salary').value = '25';
    document.getElementById('currentTime').value = 30;
    document.getElementById('improvedTime').value = 15;
    document.getElementById('tasksPerDay').value = 20;
    document.getElementById('implementationCost').value = '50,000';
    document.getElementById('trainingCost').value = '10,000';
    document.getElementById('ongoingCost').value = '5,000';
    document.getElementById('currentErrorRate').value = 5;
    document.getElementById('improvedErrorRate').value = 1;
    document.getElementById('costPerError').value = '100';
    document.getElementById('newRevenue').value = '0';
    document.getElementById('newUnitsPerDay').value = 0;
    document.getElementById('revenueGrowth').value = 0;

    // Reset sliders
    document.querySelectorAll('.input-slider').forEach(slider => {
      const input = document.getElementById(slider.id.replace('Slider', ''));
      if (input) {
        slider.value = parseCurrencyInput(input.value);
      }
    });

    // Reset time units and salary period
    timeUnits = { currentTime: 'minutes', improvedTime: 'minutes' };
    salaryPeriod = 'hourly';
    
    // Reset unknown checkboxes
    unknownFields.clear();
    document.querySelectorAll('[id$="Unknown"]').forEach(checkbox => {
      checkbox.checked = false;
    });
    
    // Remove disabled state from containers
    document.querySelectorAll('.input-container').forEach(container => {
      container.classList.remove('disabled');
    });
    
    // Reset button states
    document.querySelectorAll('.unit-btn').forEach(btn => {
      btn.classList.remove('active');
      if ((btn.dataset.unit === 'minutes') || (btn.dataset.period === 'hourly')) {
        btn.classList.add('active');
      }
    });

    // Recalculate
    calculateResults();
  }
}

</script>

</body>
</html>
