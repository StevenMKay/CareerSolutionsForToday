<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Employee Response Platform | Content Composer</title>
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/StevenMKay/CareerSolutionsForToday/24f41fc0ba84fa65c8b2fad5155b6b32c824486e/icons/CareerIcon.png">
  <style>
    :root{
      --brand-primary:#0d6efd;--brand-primary-dark:#0a4bb5;--brand-accent:#2dd4bf;
      --brand-gray:#6b7280;--brand-panel:#f8f9fa;--brand-white:#fff;
      --brand-text:#1f2937;--brand-success:#0f9d58;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,var(--brand-primary),var(--brand-primary-dark));min-height:100vh;color:var(--brand-text)}
    .header{background:#fff;padding:1rem 2rem;border-bottom:3px solid var(--brand-primary);box-shadow:0 2px 10px rgba(0,0,0,.08)}
    .header-content{max-width:1400px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}
    .logo-section{display:flex;align-items:center;gap:1rem}
    .logo-mark{width:48px;height:48px;border-radius:12px;background:var(--brand-primary);color:#fff;font-weight:800;font-size:1rem;display:flex;align-items:center;justify-content:center;letter-spacing:-.5px}
    .brand-text h1{color:var(--brand-primary);font-size:1.8rem;letter-spacing:-.5px}
    .brand-subtitle{color:var(--brand-gray);font-size:.8rem;display:block}
    .brand-company{color:var(--brand-gray);font-size:.7rem;font-style:italic}
    .user-info{display:flex;gap:.5rem;align-items:center;color:var(--brand-gray)}
    .link-placeholder{color:var(--brand-gray);font-weight:600;font-size:.95rem}

    .main-container{max-width:1400px;margin:2rem auto;padding:0 2rem;display:grid;grid-template-columns:300px 1fr;gap:2rem}
    .sidebar,.content-area{background:#fff;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.08)}
    .sidebar{padding:1.5rem;height:fit-content}
    .sidebar h2{color:var(--brand-primary);margin-bottom:1rem}
    .content-types{list-style:none}
    .content-type-btn{width:100%;padding:.75rem 1rem;background:transparent;border:2px solid transparent;border-radius:8px;color:var(--brand-gray);cursor:pointer;font-weight:600;display:flex;gap:.5rem;align-items:center;margin:.25rem 0;transition:.2s}
    .content-type-btn:hover{background:var(--brand-panel);color:var(--brand-primary)}
    .content-type-btn.active{background:var(--brand-primary);color:#fff}
    .content-type-btn[data-type="email"]::before{content:"\2709\FE0F";}
    .content-type-btn[data-type="social"]::before{content:"\1F4F1";}
    .content-type-btn[data-type="letter"]::before{content:"\1F4C4";}
    .content-type-btn[data-type="announcement"]::before{content:"\1F4E2";}
    .content-type-btn[data-type="newsletter"]::before{content:"\1F4F0";}

    .content-area{padding:2rem}
    .content-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.25rem;padding-bottom:1rem;border-bottom:2px solid var(--brand-panel)}
    .content-title{color:var(--brand-primary);font-size:1.6rem;font-weight:800}
    .ai-status{background:var(--brand-panel);border-radius:20px;padding:.4rem .9rem;color:var(--brand-gray);font-size:.9rem}
    .ai-status.active{background:rgba(5,150,105,.1);color:var(--brand-success)}

    .form-section{margin:1rem 0 1.25rem;background:var(--brand-panel);border-left:4px solid var(--brand-primary);padding:1rem;border-radius:10px}
    .form-section h3{color:var(--brand-primary);margin-bottom:.75rem}
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    .form-group{display:flex;flex-direction:column}
    .form-group.full-width{grid-column:1/-1}
    label{font-weight:700;margin-bottom:.4rem}
    input,select,textarea{padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;background:#fff}
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--brand-primary);box-shadow:0 0 0 3px rgba(0,102,178,.1)}
    textarea{min-height:110px;resize:vertical}

    .radio-group{display:flex;flex-direction:column;gap:.5rem;margin-top:.5rem}
    .radio-option{display:flex;gap:.5rem;align-items:center;padding:.35rem .4rem;border-radius:6px;cursor:pointer}
    .radio-option:hover{background:var(--brand-panel)}

    .data-sources{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}

    .action-buttons{display:flex;gap:.75rem;justify-content:flex-end;margin-top:1rem;padding-top:1rem;border-top:2px solid var(--brand-panel)}
    .btn{padding:.7rem 1.1rem;border:none;border-radius:8px;font-weight:800;cursor:pointer}
    .btn-primary{background:var(--brand-primary);color:#fff}
    .btn-primary:hover{background:var(--brand-primary-dark)}
    .btn-secondary{background:transparent;border:2px solid var(--brand-primary);color:var(--brand-primary)}
    .btn-secondary:hover{background:var(--brand-primary);color:#fff}

    .loading{display:none;text-align:center;padding:1rem}
    .loading.show{display:block}
    .spinner{border:3px solid var(--brand-panel);border-top:3px solid var(--brand-primary);border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto .5rem}
    @keyframes spin{to{transform:rotate(360deg)}}

    .generated-content{display:none;margin-top:1rem;background:var(--brand-panel);border:2px dashed var(--brand-primary);border-radius:10px;padding:1rem}
    .generated-content.show{display:block}
    .content-output{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:1rem;white-space:pre-wrap;font-family:"Courier New",monospace;line-height:1.7}

    .app-footer{background:#fff;border-top:3px solid var(--brand-primary);padding:1rem 2rem;box-shadow:0 -2px 10px rgba(0,0,0,.06)}
    .footer-content{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;color:var(--brand-gray);font-size:.9rem}
    .app-details-link{position:relative;color:var(--brand-primary);font-weight:800;cursor:pointer;padding:.4rem .7rem;border-radius:6px}
    .app-details-link:hover{background:var(--brand-panel)}
    .app-details-tooltip{position:absolute;bottom:100%;right:-50px;background:#fff;border:2px solid var(--brand-primary);border-radius:8px;min-width:300px;box-shadow:0 8px 25px rgba(0,0,0,.15);opacity:0;visibility:hidden;transition:.2s;margin-bottom:.5rem}
    .app-details-link:hover .app-details-tooltip{opacity:1;visibility:visible}
    
    .toast-notification{position:fixed;top:20px;right:20px;background:var(--brand-success);color:white;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 8px 25px rgba(0,0,0,.15);z-index:1000;transform:translateX(100%);opacity:0;transition:all .3s ease;display:flex;align-items:center;gap:.75rem;font-weight:600;}
    .toast-notification.show{transform:translateX(0);opacity:1;}
    .toast-notification .toast-icon{font-size:1.2rem;}
    .toast-notification .toast-close{background:none;border:none;color:white;font-size:1.2rem;cursor:pointer;margin-left:.5rem;opacity:.8;}
    .toast-notification .toast-close:hover{opacity:1;}
    .tooltip-header{background:var(--brand-primary);color:#fff;padding:.6rem .9rem;border-radius:6px 6px 0 0}
    .tooltip-content{padding:1rem}
    .detail-row{display:flex;justify-content:space-between;gap:1rem;padding:.35rem 0;border-bottom:1px solid var(--brand-panel)}
    .detail-row:last-child{border-bottom:none}
    .detail-label{font-weight:800;color:var(--brand-text)}
    .detail-value{font-family:"Courier New",monospace;color:var(--brand-gray)}

    @media (max-width:1024px){
      .main-container{grid-template-columns:1fr}
      .sidebar{order:2}
      .content-area{order:1}
      .form-row{grid-template-columns:1fr}
    }
    @media (max-width:768px){
      .main-container{padding:0 1rem}
      .header{padding:1rem}
      .header-content{flex-direction:column;gap:1rem;text-align:center}
      .action-buttons{flex-direction:column}
      .footer-content{flex-direction:column;gap:.75rem}
      .app-details-tooltip{position:fixed;left:20px;right:20px;bottom:20px}
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <div class="logo-section">
        <div class="logo-mark" aria-hidden="true">ERP</div>
        <span style="color:var(--brand-gray);font-size:1.2rem;">|</span>
        <div class="brand-text">
          <h1>Employee Response Platform</h1>
          <span class="brand-subtitle">Omnichannel Content Composer</span>
          <span class="brand-company">Customer Experience Programs | Employee Response Platform</span>
        </div>
      </div>
      <div class="user-info">
        <span class="link-placeholder" aria-disabled="true">Platform Guide (placeholder)</span><span>|</span><span id="currentDate"></span>
      </div>
    </div>
  </header>

  <div class="main-container">
    <aside class="sidebar">
      <h2>Content Types</h2>
      <ul class="content-types">
        <li><button class="content-type-btn active" data-type="email">Customer Email</button></li>
        <li><button class="content-type-btn" data-type="social">Social Media Post</button></li>
        <li><button class="content-type-btn" data-type="letter">Customer Letter</button></li>
        <li><button class="content-type-btn" data-type="announcement">Internal Announcement</button></li>
        <li><button class="content-type-btn" data-type="newsletter">Newsletter Article</button></li>
      </ul>
    </aside>

    <main class="content-area">
      <div class="content-header">
        <h2 class="content-title" id="contentTitle">Customer Email Generator</h2>
        <div class="ai-status" id="aiStatus">AI Assistant Ready</div>
      </div>

      <form id="contentForm">
        <!-- Email sections -->
        <div class="form-section" id="emailContextSection">
          <h3>Step 1: Original Email (Optional)</h3>
          <div class="form-group full-width">
            <label for="originalEmail">Paste the email you received to provide context</label>
            <textarea id="originalEmail" name="originalEmail" placeholder="Paste the original email here to help the AI understand the context and provide a more relevant response..."></textarea>
          </div>
        </div>

        <div class="form-section" id="naturalResponseSection">
          <h3>Step 2: What you want to say</h3>
          <div class="form-group full-width">
            <label for="naturalResponse">Type your response in natural language</label>
            <textarea id="naturalResponse" name="naturalResponse" placeholder="Example: I am so sorry to hear that‚Äîhow can I help? Or: Thank you for bringing this to our attention; I‚Äôll look into it right away."></textarea>
          </div>
          <div style="background:rgba(0,102,178,.08);padding:1rem;border-radius:6px;margin-top:.5rem;">
            <p style="font-size:.9rem;color:var(--brand-gray);margin:0;">üí° <strong>Tip:</strong> The AI will transform your casual response into polished, on-brand language while maintaining your intent.</p>
          </div>
        </div>

        <div class="form-section" id="emailStyleSection">
          <h3>Step 3: Choose your communication style</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="tone">Communication Tone</label>
              <select id="tone" name="tone">
                <option value="professional">Professional</option>
                <option value="friendly">Friendly</option>
                <option value="formal">Formal</option>
                <option value="empathetic">Empathetic</option>
                <option value="apologetic">Apologetic</option>
                <option value="urgent">Urgent</option>
                <option value="celebratory">Celebratory</option>
              </select>
            </div>
            <div class="form-group">
              <label for="audience">Target Audience</label>
              <select id="audience" name="audience">
                <option value="retail-customers">Retail Customers</option>
                <option value="business-clients">Business Clients</option>
                <option value="private-wealth">Private Wealth Clients</option>
                <option value="internal-staff">Internal Staff</option>
                <option value="general-public">General Public</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Social sections -->
        <div class="form-section" id="socialContextSection" style="display:none;">
          <h3>Step 1: Customer&#39;s Social Media Post (Optional)</h3>
          <div class="form-group full-width">
            <label for="originalSocialPost">Paste the customer&#39;s social media post or comment</label>
            <textarea id="originalSocialPost" name="originalSocialPost" placeholder="Paste the post, tweet, or comment to provide context..."></textarea>
          </div>
        </div>

        <div class="form-section" id="socialResponseSection" style="display:none;">
          <h3>Step 2: What you want to say</h3>
          <div class="form-group full-width">
            <label for="socialResponse">Type your response in natural language</label>
            <textarea id="socialResponse" name="socialResponse" placeholder="Example: Thanks for reaching out‚Äîhappy to help!"></textarea>
          </div>
          <div style="background:rgba(0,102,178,.08);padding:1rem;border-radius:6px;margin-top:.5rem;">
            <p style="font-size:.9rem;color:var(--brand-gray);margin:0;">üí° The AI will transform your response into optimized, on‚Äëbrand copy for the selected platform.</p>
          </div>
        </div>

        <div class="form-section" id="socialStyleSection" style="display:none;">
          <h3>Step 3: Choose your communication style</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="socialTone">Communication Tone</label>
              <select id="socialTone" name="socialTone">
                <option value="friendly">Friendly &amp; Engaging</option>
                <option value="professional">Professional</option>
                <option value="helpful">Helpful &amp; Supportive</option>
                <option value="empathetic">Empathetic</option>
                <option value="apologetic">Apologetic</option>
                <option value="celebratory">Celebratory</option>
                <option value="informative">Informative</option>
              </select>
            </div>
            <div class="form-group">
              <label for="socialPlatform">Platform</label>
              <select id="socialPlatform" name="socialPlatform">
                <option value="twitter">Twitter/X</option>
                <option value="facebook">Facebook</option>
                <option value="instagram">Instagram</option>
                <option value="linkedin">LinkedIn</option>
                <option value="generic">General Social</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Letter sections -->
        <div class="form-section" id="letterReferenceSection" style="display:none;">
          <h3>Step 1: Enter Reference Number</h3>
          <div class="form-group full-width">
            <label for="referenceNumber">Reference Number (Demo)</label>
            <input type="text" id="referenceNumber" placeholder="Enter any reference number" style="min-height:50px;font-size:18px;text-align:center;font-weight:bold" />
            <button type="button" class="btn btn-secondary" id="fetchDataBtn" style="margin-top:10px;">Fetch Customer Data</button>
          </div>
        </div>

        <div class="form-section" id="letterDataSection" style="display:none;">
          <h3>Step 2: Customer Information</h3>
          <div class="form-row">
            <div class="form-group"><label for="customerName">Customer Name</label><input id="customerName" readonly /></div>
            <div class="form-group"><label for="businessName">Business Name</label><input id="businessName" readonly /></div>
          </div>
          <div class="form-row">
            <div class="form-group"><label for="addressLine1">Address Line 1</label><input id="addressLine1" readonly /></div>
            <div class="form-group"><label for="addressLine2">Address Line 2</label><input id="addressLine2" readonly /></div>
          </div>
          <div class="form-row">
            <div class="form-group"><label for="customerCity">City</label><input id="customerCity" readonly /></div>
            <div class="form-group"><label for="customerState">State</label><input id="customerState" readonly /></div>
          </div>
          <div class="form-row">
            <div class="form-group"><label for="customerZip">ZIP Code</label><input id="customerZip" readonly /></div>
            <div class="form-group"><label for="productType">Product</label><input id="productType" readonly /></div>
          </div>
        </div>

        <div class="form-section" id="letterActionsSection" style="display:none;">
          <h3>Step 3: Generate Letter</h3>
          <p style="margin-bottom:.75rem;color:var(--brand-gray);">Letter Type: <strong>SOSD (Secretary of State Declined)</strong> ‚Äì Business credit card application declined due to business not in good standing.</p>
          <div class="action-buttons">
            <button type="button" class="btn btn-primary" id="previewLetterBtn">Preview Letter</button>
            <button type="button" class="btn btn-primary" id="generateWordBtn">Generate Word Document</button>
            <button type="button" class="btn btn-secondary" id="uploadSharePointBtn">Upload to SharePoint</button>
            <button type="button" class="btn btn-secondary" id="createFolderBtn">Create SharePoint Folder</button>
          </div>
        </div>

        <!-- Letter Preview -->
        <div class="form-section" id="letterPreviewSection" style="display:none;">
          <h3>Letter Preview</h3>
          <div id="letterContent" style="background:#fff;border:1px solid #ddd;padding:2rem;font-family:Arial,sans-serif;line-height:1.6;white-space:pre-wrap;max-height:500px;overflow-y:auto;"></div>
        </div>

        <!-- Additional resources -->
        <div class="form-section" id="additionalResourcesSection">
          <h3>Step 4: Include Additional Resources</h3>
          <div class="form-group">
            <label>Include additional resources?</label>
            <div class="radio-group">
              <label class="radio-option"><input type="radio" name="includeResources" value="no" checked /> <span>No, standard response</span></label>
              <label class="radio-option"><input type="radio" name="includeResources" value="yes" /> <span>Yes, include resources</span></label>
            </div>
          </div>
          <div class="form-group full-width" id="resourceSearchSection" style="display:none;">
            <div style="text-align:center;margin-bottom:1rem;">
              <label for="resourceSearch" style="display:block;margin-bottom:.5rem;font-weight:700;">Search Resources</label>
              <input id="resourceSearch" placeholder="Type to filter resources (e.g., mobile app, fraud, autopay)" style="max-width:400px;margin:0 auto;text-align:center;" />
            </div>
            <label style="display:block;margin-bottom:.5rem;font-weight:700;">Available Resources</label>
            <div id="resourceCheckboxes" style="display:grid;grid-template-columns:1fr;gap:.5rem;max-height:300px;overflow-y:auto;border:2px solid #e5e7eb;border-radius:8px;padding:1rem;background:#fff;">
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="mobile-app" name="selectedResources" style="margin:0;"> Mobile Banking App ‚Äî Download and features
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="credit-monitoring" name="selectedResources" style="margin:0;"> Credit Journey ‚Äî Free credit monitoring
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="zelle" name="selectedResources" style="margin:0;"> Zelle ‚Äî Send money with Zelle
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="autopay" name="selectedResources" style="margin:0;"> AutoPay ‚Äî Set up automatic payments
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="fraud-protection" name="selectedResources" style="margin:0;"> Fraud Protection ‚Äî Security features
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="online-banking" name="selectedResources" style="margin:0;"> Online Banking ‚Äî Digital features
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="customer-service" name="selectedResources" style="margin:0;"> Customer Service ‚Äî Contact information
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="branch-locator" name="selectedResources" style="margin:0;"> Branch &amp; ATM Locator
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="rewards-program" name="selectedResources" style="margin:0;"> Ultimate Rewards Program
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="overdraft-protection" name="selectedResources" style="margin:0;"> Overdraft Protection Options
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="deposit-products" name="selectedResources" style="margin:0;"> Deposit Products ‚Äî Checking &amp; Savings
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="investment-services" name="selectedResources" style="margin:0;"> Investment &amp; Retirement Services
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="mortgage-lending" name="selectedResources" style="margin:0;"> Home Lending &amp; Mortgages
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="business-banking" name="selectedResources" style="margin:0;"> Business Banking Solutions
              </label>
              <label style="display:flex;align-items:center;gap:.5rem;padding:.4rem;border-radius:4px;cursor:pointer;font-weight:normal;" class="resource-checkbox">
                <input type="checkbox" value="financial-education" name="selectedResources" style="margin:0;"> Financial Education Resources
              </label>
            </div>
            <div id="selectedResourcesSummary" style="margin-top:1rem;padding:1rem;background:rgba(0,102,178,.08);border-radius:6px;min-height:60px;">
              <label style="display:block;margin-bottom:.5rem;font-weight:700;color:var(--brand-primary);">Selected Resources</label>
              <div id="selectedResourcesList" style="color:var(--brand-gray);font-style:italic;">No resources selected</div>
            </div>
          </div>
        </div>

        <!-- Announcement -->
        <div class="form-section" id="announcementContextSection" style="display:none;">
          <h3>Step 1: What you are announcing</h3>
          <div class="form-group full-width">
            <label for="announcementTopic">Topic/Subject</label>
            <input id="announcementTopic" placeholder="e.g., New Employee Benefits, System Upgrade..." />
          </div>
          <div class="form-group full-width">
            <label for="announcementDetails">Key Details</label>
            <textarea id="announcementDetails" placeholder="Provide the details, dates, and information to communicate..."></textarea>
          </div>
        </div>

        <div class="form-section" id="announcementStyleSection" style="display:none;">
          <h3>Step 2: Communication Style</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="announcementTone">Tone</label>
              <select id="announcementTone">
                <option value="professional">Professional</option>
                <option value="friendly">Friendly &amp; Approachable</option>
                <option value="formal">Formal</option>
                <option value="urgent">Urgent</option>
                <option value="celebratory">Celebratory</option>
                <option value="informative">Informative</option>
                <option value="reassuring">Reassuring</option>
              </select>
            </div>
            <div class="form-group">
              <label for="announcementAudience">Target Audience</label>
              <select id="announcementAudience">
                <option value="all-employees">All Employees</option>
                <option value="department-specific">Department Specific</option>
                <option value="management-team">Management Team</option>
                <option value="regional-staff">Regional Staff</option>
                <option value="branch-employees">Branch Employees</option>
                <option value="support-staff">Support Staff</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section" id="announcementAttachmentsSection" style="display:none;">
          <h3>Step 3: Attachments &amp; Resources</h3>
          <div class="form-group full-width">
            <label>Attachments (Optional)</label>
            <div id="dropZone" style="border:2px dashed var(--brand-primary);border-radius:8px;padding:2rem;text-align:center;background:rgba(0,102,178,.05);cursor:pointer;transition:all .2s;margin-top:.5rem;">
              <div style="color:var(--brand-primary);font-size:1.1rem;margin-bottom:.5rem;">üìÅ Drag &amp; Drop Files Here</div>
              <div style="color:var(--brand-gray);font-size:.9rem;margin-bottom:1rem;">or click to browse for files</div>
              <button type="button" id="browseFilesBtn" style="background:var(--brand-primary);color:white;border:none;padding:.6rem 1.2rem;border-radius:6px;cursor:pointer;font-weight:600;">Browse Files</button>
              <input type="file" id="announcementAttachments" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.png" style="display:none;" />
              <div style="color:var(--brand-gray);font-size:.85rem;margin-top:1rem;">Supported: PDF, Word, Excel, PowerPoint, Text, Images</div>
            </div>
            <div id="fileList" style="margin-top:1rem;display:none;">
              <label style="font-weight:700;color:var(--brand-primary);margin-bottom:.5rem;display:block;">üìã Selected Files</label>
              <div id="selectedFiles" style="background:#fff;border:1px solid #e5e7eb;border-radius:6px;padding:.75rem;"></div>
            </div>
          </div>
          <div class="form-group full-width">
            <label style="font-weight:700;margin-bottom:.75rem;display:block;">üîó Related Links (Optional)</label>
            <div id="linkInputs">
              <div class="link-input-group" style="margin-bottom:.5rem;">
                <input type="url" id="announcementLink1" placeholder="Enter URL (e.g., https://intranet.company.com/policy)" style="width:100%;padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;" />
              </div>
            </div>
            <small style="color:var(--brand-gray);display:block;margin-top:.5rem;">üí° Up to 5 links can be added. Additional input boxes will appear as needed.</small>
          </div>
        </div>

        <!-- Newsletter -->
        <div class="form-section" id="newsletterContentSection" style="display:none;">
          <h3>Step 1: Article Content</h3>
          <div class="form-row">
            <div class="form-group"><label for="newsletterTitle">Article Title</label><input id="newsletterTitle" placeholder="e.g., Market Update: Q4 Strategies" /></div>
            <div class="form-group">
              <label for="newsletterCategory">Category</label>
              <select id="newsletterCategory">
                <option value="market-insights">Market Insights</option>
                <option value="product-updates">Product Updates</option>
                <option value="financial-tips">Financial Tips</option>
                <option value="customer-stories">Customer Stories</option>
                <option value="company-news">Company News</option>
                <option value="educational">Educational Content</option>
                <option value="seasonal-advice">Seasonal Advice</option>
              </select>
            </div>
          </div>
          <div class="form-group full-width">
            <label for="newsletterContent">Main Content</label>
            <textarea id="newsletterContent" placeholder="Provide key points, data, or story..."></textarea>
          </div>
        </div>

        <div class="form-section" id="newsletterStyleSection" style="display:none;">
          <h3>Step 2: Article Style</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="newsletterTone">Writing Tone</label>
              <select id="newsletterTone">
                <option value="informative">Informative &amp; Educational</option>
                <option value="engaging">Engaging &amp; Conversational</option>
                <option value="professional">Professional &amp; Authoritative</option>
                <option value="friendly">Friendly &amp; Accessible</option>
                <option value="expert">Expert Analysis</option>
                <option value="storytelling">Storytelling</option>
              </select>
            </div>
            <div class="form-group">
              <label for="newsletterLength">Article Length</label>
              <select id="newsletterLength">
                <option value="brief">Brief (200‚Äì300 words)</option>
                <option value="standard">Standard (400‚Äì600 words)</option>
                <option value="detailed">Detailed (700‚Äì1000 words)</option>
                <option value="comprehensive">Comprehensive (1000+ words)</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section" id="newsletterAttachmentsSection" style="display:none;">
          <h3>Step 3: Supporting Materials</h3>
          <div class="form-group full-width">
            <label>Images &amp; Documents (Optional)</label>
            <div id="newsletterDropZone" style="border:2px dashed var(--brand-primary);border-radius:8px;padding:2rem;text-align:center;background:rgba(0,102,178,.05);cursor:pointer;transition:all .2s;margin-top:.5rem;">
              <div style="color:var(--brand-primary);font-size:1.1rem;margin-bottom:.5rem;">üìÅ Drag &amp; Drop Files Here</div>
              <div style="color:var(--brand-gray);font-size:.9rem;margin-bottom:1rem;">or click to browse for files</div>
              <button type="button" id="newsletterBrowseFilesBtn" style="background:var(--brand-primary);color:white;border:none;padding:.6rem 1.2rem;border-radius:6px;cursor:pointer;font-weight:600;">Browse Files</button>
              <input type="file" id="newsletterAttachments" multiple accept=".pdf,.doc,.docx,.jpg,.png,.gif,.svg,.ppt,.pptx" style="display:none;" />
              <div style="color:var(--brand-gray);font-size:.85rem;margin-top:1rem;">Supported: PDF, Word, Excel, PowerPoint, Text, Images</div>
            </div>
            <div id="newsletterFileList" style="margin-top:1rem;display:none;">
              <label style="font-weight:700;color:var(--brand-primary);margin-bottom:.5rem;display:block;">üìã Selected Files</label>
              <div id="newsletterSelectedFiles" style="background:#fff;border:1px solid #e5e7eb;border-radius:6px;padding:.75rem;"></div>
            </div>
          </div>
          <div class="form-group full-width">
            <label style="font-weight:700;margin-bottom:.75rem;display:block;">üîó Related Links (Optional)</label>
            <div id="newsletterLinkInputs">
              <div class="link-input-group" style="margin-bottom:.5rem;">
                <input type="url" id="newsletterLink1" placeholder="Enter URL (e.g., https://intranet.company.com/resource)" style="width:100%;padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;" />
              </div>
            </div>
            <small style="color:var(--brand-gray);display:block;margin-top:.5rem;">üí° Up to 5 links can be added. Additional input boxes will appear as needed.</small>
          </div>
          <div class="form-group full-width">
            <label for="newsletterCallToAction">Call to Action (Optional)</label>
            <textarea id="newsletterCallToAction" placeholder="e.g., Contact your relationship manager..."></textarea>
          </div>
        </div>

        <!-- Global Action Buttons -->
        <div class="action-buttons" id="globalActionButtons">
          <button type="button" class="btn btn-secondary" id="previewBtn">Preview Prompt</button>
          <button type="button" class="btn btn-secondary" id="saveTemplateBtn">Save as Template</button>
          <button type="submit" class="btn btn-primary" id="generateBtn">Generate Content</button>
        </div>
      </form>

      <div class="loading" id="loadingAnimation">
        <div class="spinner"></div>
        <p>AI is generating your content...</p>
        <p style="font-size:.9rem;color:var(--brand-gray)">This may take 3‚Äì5 seconds</p>
      </div>

      <div class="generated-content" id="generatedContent">
        <h4>Generated Content</h4>
        <div class="content-output" id="contentOutput" contenteditable="true" style="cursor:text;"></div>
        <div class="action-buttons" style="margin-top:.5rem;">
          <button type="button" class="btn btn-secondary" id="regenerateBtn">Regenerate</button>
          <button type="button" class="btn btn-secondary" id="openEmailBtn">Open in Email App</button>
          <button type="button" class="btn btn-secondary" id="startNewBtn">Start New Content Item</button>
          <button type="button" class="btn btn-primary" id="copyBtn">Copy to Clipboard</button>
        </div>
      </div>
    </main>
  </div>

  <footer class="app-footer">
    <div class="footer-content">
      <div class="footer-right">
        <span>&copy; 2025 Career Solutions Collective | Employee Response Platform</span>
      </div>
    </div>
  </footer>

  <script>
    // ---------- App State ----------
    let currentContentType = "email";
    let lastGenerated = "";
    let generationCount = {}; // Track generation count per content type

    // ---------- Boot ----------
    document.addEventListener("DOMContentLoaded", () => {
      initializeApp();
      bindEventListeners();
      updateCurrentDate();
    });

    function initializeApp(){
      const stored = sessionStorage.getItem("selectedContentType") || "email";
      currentContentType = stored;
      updateContentType(stored, {skipReload:true});
      console.log("Employee Response Platform initialized");
    }

    function updateCurrentDate(){
      const now = new Date();
      const dateFmt = {year:"numeric", month:"long", day:"numeric"};
      const timeFmt = {year:"numeric", month:"2-digit", day:"2-digit", hour:"2-digit", minute:"2-digit", hour12:false};
      const dateEl = document.getElementById("currentDate");
      if(dateEl) dateEl.textContent = now.toLocaleDateString("en-US", dateFmt);
      const lastEl = document.getElementById("lastUpdated");
      if(lastEl) lastEl.textContent = now.toLocaleDateString("en-US", timeFmt);
    }

    // ---------- Events ----------
    function bindEventListeners(){
      // Left nav buttons
      document.querySelectorAll(".content-type-btn").forEach(btn => {
        btn.addEventListener("click", (e)=>{
          const t = e.currentTarget.getAttribute("data-type");
          if(!t) return;
          updateContentType(t);
        });
      });

      // Resource include toggle
      document.querySelectorAll('input[name="includeResources"]').forEach(r => {
        r.addEventListener("change", (e)=>{
          const section = document.getElementById("resourceSearchSection");
          section.style.display = (e.target.value === "yes") ? "block" : "none";
        });
      });

      // Resource filter and checkbox management
      const searchEl = document.getElementById("resourceSearch");
      const checkboxContainer = document.getElementById("resourceCheckboxes");
      if(searchEl && checkboxContainer){
        searchEl.addEventListener("input", (e)=>{
          const term = e.target.value.toLowerCase();
          const checkboxes = checkboxContainer.querySelectorAll(".resource-checkbox");
          checkboxes.forEach(checkbox => {
            const text = checkbox.textContent.toLowerCase();
            checkbox.style.display = text.includes(term) ? "flex" : "none";
          });
        });
      }

      // Resource selection summary
      document.addEventListener("change", (e)=>{
        if(e.target.name === "selectedResources"){
          updateResourceSummary();
        }
      });

      // Form submit
      const form = document.getElementById("contentForm");
      form.addEventListener("submit", (e)=>{
        e.preventDefault();
        generateContent();
      });

      // Global action buttons
      document.getElementById("previewBtn").addEventListener("click", previewPrompt);
      document.getElementById("saveTemplateBtn").addEventListener("click", saveTemplate);
      document.getElementById("copyBtn").addEventListener("click", copyToClipboard);
      document.getElementById("regenerateBtn").addEventListener("click", regenerateContent);
      document.getElementById("openEmailBtn").addEventListener("click", openInEmailApp);
      document.getElementById("startNewBtn").addEventListener("click", startNewContentItem);

      // Letter actions
      document.getElementById("fetchDataBtn").addEventListener("click", fetchCustomerData);
      document.getElementById("previewLetterBtn").addEventListener("click", previewLetter);
      document.getElementById("generateWordBtn").addEventListener("click", generateWordDocument);
      document.getElementById("uploadSharePointBtn").addEventListener("click", uploadToSharePoint);
      document.getElementById("createFolderBtn").addEventListener("click", createSharePointFolder);

      // Announcement attachments and links
      initializeAnnouncementFeatures();
      
      // Newsletter attachments and links
      initializeNewsletterFeatures();
    }

    // ---------- Content Type Switch ----------
    function updateContentType(type, opts = {}){
      if(!opts.skipReload && currentContentType !== type){
        sessionStorage.setItem("selectedContentType", type);
        
        // Clear forms and reset page state when switching content types
        clearAllForms();
        resetPageState();
      }
      currentContentType = type;

      // Update left-nav active
      document.querySelectorAll(".content-type-btn").forEach(b => b.classList.remove("active"));
      const activeBtn = document.querySelector(`.content-type-btn[data-type="${type}"]`);
      if(activeBtn) activeBtn.classList.add("active");

      // Sections
      const ids = [
        "emailContextSection","naturalResponseSection","emailStyleSection",
        "additionalResourcesSection","socialContextSection","socialResponseSection",
        "socialStyleSection","letterReferenceSection","letterDataSection","letterActionsSection",
        "announcementContextSection","announcementStyleSection","announcementAttachmentsSection",
        "newsletterContentSection","newsletterStyleSection","newsletterAttachmentsSection"
      ];
      ids.forEach(id => {
        const el = document.getElementById(id);
        if(el) el.style.display = "none";
      });

      const titleMap = {
        email:"Customer Email Generator",
        social:"Social Media Response Generator",
        letter:"Customer Letter Generator",
        announcement:"Internal Announcement Generator",
        newsletter:"Newsletter Article Generator"
      };
      const titleEl = document.getElementById("contentTitle");
      if(titleEl) titleEl.textContent = titleMap[type] || "Generator";

      // Show/hide global action buttons based on content type
      const globalButtons = document.getElementById("globalActionButtons");
      if(globalButtons) {
        globalButtons.style.display = (type === "letter") ? "none" : "flex";
      }

      // Show per type
      if(type === "email"){
        show("emailContextSection","naturalResponseSection","emailStyleSection","additionalResourcesSection");
      } else if(type === "social"){
        show("socialContextSection","socialResponseSection","socialStyleSection","additionalResourcesSection");
      } else if(type === "letter"){
        show("letterReferenceSection");
      } else if(type === "announcement"){
        show("announcementContextSection","announcementStyleSection","announcementAttachmentsSection");
      } else if(type === "newsletter"){
        show("newsletterContentSection","newsletterStyleSection","newsletterAttachmentsSection");
      }
    }

    function clearAllForms(){
      // Reset the main content form
      const form = document.getElementById("contentForm");
      if(form) form.reset();
      
      // Clear resource selection summary
      const summaryEl = document.getElementById("selectedResourcesList");
      if(summaryEl) summaryEl.innerHTML = '<em style="color:var(--brand-gray);">No resources selected</em>';
      
      // Hide resource search section
      const resourceSection = document.getElementById("resourceSearchSection");
      if(resourceSection) resourceSection.style.display = "none";
      
      // Clear file uploads for announcements
      const announcementFileList = document.getElementById("fileList");
      if(announcementFileList) announcementFileList.style.display = "none";
      
      // Clear file uploads for newsletters
      const newsletterFileList = document.getElementById("newsletterFileList");
      if(newsletterFileList) newsletterFileList.style.display = "none";
      
      // Reset dynamic link inputs for announcements
      const announcementLinkInputs = document.getElementById("linkInputs");
      if(announcementLinkInputs) {
        announcementLinkInputs.innerHTML = '<div class="link-input-group" style="margin-bottom:.5rem;"><input type="url" id="announcementLink1" placeholder="Enter URL (e.g., https://intranet.company.com/policy)" style="width:100%;padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;" /></div>';
      }
      
      // Reset dynamic link inputs for newsletters
      const newsletterLinkInputs = document.getElementById("newsletterLinkInputs");
      if(newsletterLinkInputs) {
        newsletterLinkInputs.innerHTML = '<div class="link-input-group" style="margin-bottom:.5rem;"><input type="url" id="newsletterLink1" placeholder="Enter URL (e.g., https://intranet.company.com/resource)" style="width:100%;padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;" /></div>';
      }
      
      // Re-initialize dynamic link functionality
      initializeDynamicLinks();
      initializeNewsletterDynamicLinks();
    }

    function resetPageState(){
      // Hide generated content
      const generatedContent = document.getElementById("generatedContent");
      if(generatedContent) generatedContent.classList.remove("show");
      
      // Hide letter preview section
      const letterPreview = document.getElementById("letterPreviewSection");
      if(letterPreview) letterPreview.style.display = "none";
      
      // Hide letter data and actions sections
      const letterDataSection = document.getElementById("letterDataSection");
      const letterActionsSection = document.getElementById("letterActionsSection");
      if(letterDataSection) letterDataSection.style.display = "none";
      if(letterActionsSection) letterActionsSection.style.display = "none";
      
      // Reset AI status
      updateAIStatus("completed");
      
      // Hide loading animation
      showLoading(false);
      
      // Scroll to top
      window.scrollTo({top: 0, behavior: 'smooth'});
    }

    function show(...ids){
      ids.forEach(id => {
        const el = document.getElementById(id);
        if(el) el.style.display = "block";
      });
    }

    function updateResourceSummary(){
      const selectedCheckboxes = document.querySelectorAll('input[name="selectedResources"]:checked');
      const summaryEl = document.getElementById("selectedResourcesList");
      
      if(selectedCheckboxes.length === 0){
        summaryEl.innerHTML = '<em style="color:var(--brand-gray);">No resources selected</em>';
        return;
      }
      
      const selectedItems = Array.from(selectedCheckboxes).map(checkbox => {
        const label = checkbox.parentElement.textContent.trim();
        return `<span style="display:inline-block;background:var(--brand-primary);color:white;padding:.2rem .5rem;border-radius:4px;margin:.2rem .2rem .2rem 0;font-size:.85rem;">${label}</span>`;
      });
      
      summaryEl.innerHTML = selectedItems.join('');
    }

    // ---------- Generation ----------
    function showLoading(v){
      const l = document.getElementById("loadingAnimation");
      if(l) l.classList.toggle("show", !!v);
    }
    function hideGeneratedContent(){
      document.getElementById("generatedContent").classList.remove("show");
    }
    function displayGeneratedContent(text){
      lastGenerated = text;
      const contentOutput = document.getElementById("contentOutput");
      contentOutput.textContent = text;
      document.getElementById("generatedContent").classList.add("show");
      
      // Show success toast notification
      showToast("Content generated successfully!", "success");
      
      // Update lastGenerated when user edits the content
      contentOutput.addEventListener("input", function() {
        lastGenerated = this.textContent;
      });
    }
    function updateAIStatus(state){
      const el = document.getElementById("aiStatus");
      if(!el) return;
      if(state === "generating"){ el.textContent = "AI is generating..."; el.classList.add("active"); }
      else if(state === "completed"){ el.textContent = "AI Assistant Ready"; el.classList.remove("active"); }
      else { el.textContent = "AI Assistant Ready"; el.classList.remove("active"); }
    }

    function getFormData(){
      const byId = id => document.getElementById(id);
      const data = {
        contentType: currentContentType,
        audience: byId("audience")?.value || "",
        tone: byId("tone")?.value || "",
        originalEmail: byId("originalEmail")?.value || "",
        naturalResponse: byId("naturalResponse")?.value || "",
        originalSocialPost: byId("originalSocialPost")?.value || "",
        socialResponse: byId("socialResponse")?.value || ""
      };

      if(currentContentType === "announcement"){
        data.announcementTopic = byId("announcementTopic")?.value || "";
        data.announcementDetails = byId("announcementDetails")?.value || "";
        data.announcementTone = byId("announcementTone")?.value || "";
        data.announcementAudience = byId("announcementAudience")?.value || "";
        data.announcementLinks = byId("announcementLinks")?.value || "";
      }

      if(currentContentType === "newsletter"){
        data.newsletterTitle = byId("newsletterTitle")?.value || "";
        data.newsletterCategory = byId("newsletterCategory")?.value || "";
        data.newsletterContent = byId("newsletterContent")?.value || "";
        data.newsletterTone = byId("newsletterTone")?.value || "";
        data.newsletterLength = byId("newsletterLength")?.value || "";
        data.newsletterCallToAction = byId("newsletterCallToAction")?.value || "";
      }
      return data;
    }

    function generateContent(){
      showLoading(true);
      hideGeneratedContent();
      updateAIStatus("generating");
      const formData = getFormData();

      setTimeout(()=>{
        const content = simulateAIGeneration(formData);
        displayGeneratedContent(content);
        showLoading(false);
        updateAIStatus("completed");
      }, 1200);
    }

    function simulateAIGeneration(formData){
      const {contentType} = formData;
      if(contentType === "email" && formData.naturalResponse) return generateEmailFromNaturalResponse(formData);
      if(contentType === "social" && formData.socialResponse) return generateSocialFromNatural(formData);
      if(contentType === "announcement" && formData.announcementTopic) return generateAnnouncementContent(formData);
      if(contentType === "newsletter" && formData.newsletterTitle) return generateNewsletterContent(formData);

      // Initialize generation count if not exists
      if (!generationCount[contentType]) {
        generationCount[contentType] = 0;
      }
      
      // Increment generation count for this content type
      generationCount[contentType]++;
      
      // Use modulo to alternate between templates (0 for first set, 1 for second set)
      const templateIndex = (generationCount[contentType] - 1) % 2;
      
      // Template sets with alternating examples
      const templateSets = {
        email: [
          `Subject: Customer Service Response\n\nDear Valued Customer,\n\nThank you for contacting our support team. We're writing to provide the information you requested.\n\n‚Ä¢ Key updates related to your request\n‚Ä¢ Next steps with clear timelines\n‚Ä¢ Resources to help you stay informed\n\nOur customer care team remains committed to delivering clear, timely communication. If you have any questions, please call 1-800-555-0199 or reply to this email.\n\nBest regards,\nCustomer Care Team`,
          `Subject: Loyalty Rewards Program Benefits\n\nDear Valued Customer,\n\nWe're excited to share some fantastic news about your rewards account! As one of our preferred customers, you now have access to enhanced benefits designed to maximize your earnings.\n\nYour Benefits Include:\n‚Ä¢ 5% cash back on rotating quarterly categories\n‚Ä¢ No annual fee on your rewards credit card\n‚Ä¢ Priority customer service access\n‚Ä¢ Exclusive travel perks and discounts\n\nLimited Time Offer: Earn double points on all purchases made before December 31st. That's 2x the rewards on every transaction!\n\nActivate your enhancements through the mobile banking app or by calling 1-800-555-0199.\n\nSincerely,\nRewards Support Team`
        ],
        social: [
          `Exciting updates from our customer experience team!\n\nWe're committed to helping you achieve your goals with thoughtful service and personalized solutions.\n\n#CustomerExperience #Support #ServiceExcellence\n\nLearn more: https://example.com/support`,
          `üí≥ Make every purchase count with our Rewards+ Card!\n\nUnlock up to 5% cash back on everyday purchases plus a $200 bonus when you spend $500 in your first 3 months.\n\nüåü What sets it apart:\n‚ú® No annual fee\n‚ú® 0% intro APR for 15 months\n‚ú® Fraud protection guarantee\n‚ú® Contactless payments accepted everywhere\n\nApply today and start earning rewards on every swipe!\n\n#RewardsPlus #CashBack #SmartSpending`
        ],
        letter: [
          `[Company Letterhead]\n\n${new Date().toLocaleDateString()}\n\nDear Recipient,\n\nThank you for your recent inquiry. As a valued customer, we want to ensure you have the most current information.\n\nSincerely,\nCustomer Experience Team`
        ],
        announcement: [
          `Subject: Important Team Update\n\nTeam,\n\nWe wanted to share some important information that affects our department.\n\n‚Ä¢ Key updates for your awareness\n‚Ä¢ Action items for implementation\n‚Ä¢ Timeline and next steps\n\nPlease review the details and reach out with any questions. Your manager will follow up with specific team-level guidance.\n\nThank you for your attention to this matter.\n\nBest regards,\nLeadership Team`,
          `Subject: Technology Upgrades & New Team Members\n\nTeam,\n\nI'm pleased to announce several positive developments that will enhance our work environment and operational efficiency.\n\n**Technology Upgrades:**\nBeginning next Monday, all workstations will receive upgraded software packages and enhanced security features. IT will provide individual setup appointments as needed.\n\n**New Team Members:**\nPlease join me in welcoming David Park and Lisa Thompson to our department. David comes to us from Phoenix, and Lisa brings five years of experience supporting enterprise clients.\n\n**Process Improvements:**\nThanks to feedback from the team, we're implementing a new streamlined approval process that will reduce turnaround times by approximately 30%.\n\n**Team Building Event:**\nSave the date! Our annual team dinner will be held on December 10th at the Grand Plaza Hotel. More details and RSVP information to follow.\n\nLooking forward to finishing the year strong together.\n\nBest,\nRobert Kim\nSenior Operations Manager`
        ],
        newsletter: [
          `Quarterly Insights\n\nQ4 2025 Market Update\n\nTeam Members,\n\nAs we close out another successful quarter, here are the key highlights and market insights that impact our business:\n\n‚Ä¢ Market performance exceeded expectations\n‚Ä¢ New product launches showing strong adoption\n‚Ä¢ Client satisfaction scores at all-time highs\n\nLooking ahead to Q1 2026, we're focused on strategic initiatives that will drive continued growth and innovation.\n\nFor more details, visit the internal portal or contact your department lead.\n\nThe Communications Team`,
          `Monthly Update\n\nNovember 2024\n\nHello Team,\n\nWhat an incredible month October has been! Our collective efforts have positioned us for an outstanding end to the year.\n\n**OCTOBER ACHIEVEMENTS**\n‚Ä¢ Record-breaking month for new account openings\n‚Ä¢ Customer retention rate reached an all-time high of 96%\n‚Ä¢ Employee satisfaction scores increased by 12%\n‚Ä¢ Successfully completed cybersecurity audit with zero findings\n\n**TEAM CELEBRATIONS**\nCongratulations to the following groups:\n- IT Security Team: Outstanding performance during the annual audit\n- Customer Relations: Highest monthly satisfaction scores ever recorded\n- Operations: 100% compliance on all regulatory requirements\n\n**TECHNOLOGY UPDATES**\nThe new client management system goes live December 1st. Training sessions are scheduled for all departments. Please confirm your session time with your supervisor.\n\n**COMMUNITY IMPACT**\nOur recent food drive collected over 2,000 items for local families. Special thanks to the volunteer coordination team for their exceptional organization.\n\n**BENEFITS UPDATE**\nDon't forget that the deadline for flexible spending account elections is November 20th. Contact HR with any questions.\n\nTogether, we continue to build something special.\n\nBest regards,\nExecutive Leadership Team`
        ]
      };
      
      // Get the appropriate template set and select based on index
      const templates = {};
      Object.keys(templateSets).forEach(key => {
        if (key === 'letter') {
          // Letter only has one template (customer letter functionality is separate)
          templates[key] = templateSets[key][0];
        } else {
          templates[key] = templateSets[key][templateIndex] || templateSets[key][0];
        }
      });
      return templates[contentType] || templates.email;
    }

    function generateEmailFromNaturalResponse(formData){
      const txt = formData.naturalResponse.toLowerCase();
      let intro = "Dear Valued Customer,";
      if(formData.originalEmail){
        const s = formData.originalEmail.toLowerCase();
        if(s.includes("mr.")||s.includes("mrs.")||s.includes("ms.")) intro = "Dear Customer,";
        else if(s.includes("business")||s.includes("company")) intro = "Dear Business Partner,";
      }
      let body = "Thank you for contacting us. We appreciate your message and want to ensure we support you promptly.\n\n";
      if(txt.includes("sorry")||txt.includes("apolog")) body = "Thank you for contacting us regarding your recent experience. We apologize for any inconvenience and are committed to making this right.\n\n";
      if(txt.includes("help")||txt.includes("assist")) body += "I will personally review your request and work with our team to provide the best resolution.\n";
      if(txt.includes("thank")) body += "We appreciate your trust in our team and value your feedback.\n";

      let next = "If you have additional questions, please call 1‚Äë800‚Äë555‚Äë0199 or reply directly to this message.";
      if(formData.tone === "empathetic" || formData.tone === "apologetic") next = "We'll follow up within 24‚Äì48 hours with a detailed update. For urgent matters, please call 1‚Äë800‚Äë555‚Äë0199.";

      return `Subject: ${subjectFrom(txt, formData)}\n\n${intro}\n\n${body}\n${next}\n\nBest regards,\nCustomer Care Team\n\n---\nThis message may contain confidential information from the Employee Response Platform.`;
    }
    function subjectFrom(txt, formData){
      if(formData.tone === "apologetic" || txt.includes("sorry")) return "Our Apologies ‚Äì Customer Care Team";
      if(txt.includes("thank")) return "Thank You ‚Äì Customer Care Team";
      return "Customer Service Response";
    }

    function generateSocialFromNatural(formData){
      const s = (formData.socialResponse||"").toLowerCase();
      const platform = (document.getElementById("socialPlatform")?.value)||"generic";
      const tone = (document.getElementById("socialTone")?.value)||"friendly";
      let hashtags = "#CustomerService #SupportTeam #HereToHelp";
      if(s.includes("help")||s.includes("assist")) hashtags = "#SupportTeam #CustomerFirst #HereToHelp";
      if(s.includes("thank")) hashtags = "#ThankYou #CommunityFirst #Grateful";
      if(s.includes("sorry")||s.includes("apolog")) hashtags = "#CustomerCare #MakingItRight #ServiceExcellence";

      let body = "Thank you for connecting with us! We're here to support you every step of the way.";
      if(s.includes("thanks")||s.includes("thank you")) body = "Thank you for being part of our community‚Äîwe appreciate you!";
      if(s.includes("sorry")||s.includes("apolog")) body = "We‚Äôre sorry for the trouble. We're committed to making this right.";
      if(s.includes("help")||s.includes("assist")) body = "Happy to help! Our team is ready to assist you.";

      const cta = platform === "twitter" ? "DM us if you need assistance!" : "Feel free to message us anytime if you need support.";
      const limit = {twitter:280,facebook:500,instagram:300,linkedin:400,generic:300}[platform]||300;
      let out = `${body} ${cta} ${hashtags}`.trim();
      if(out.length>limit) out = out.slice(0, limit-3)+"...";
      return out;
    }

    // ---------- Letter Demo ----------
    function fetchCustomerData(){
      const ref = (document.getElementById("referenceNumber").value||"").trim();
      if(!ref){ alert("Enter a reference number (demo accepts any value)."); return; }
      // Demo payload
      const demo = {
        customerName:"JOHN SMITH",
        businessName:"SMITH ENTERPRISES LLC",
        addressLine1:"123 MAIN STREET",
        addressLine2:"SUITE 200",
        customerCity:"WILMINGTON",
        customerState:"DE",
        customerZip:"19801",
        productType:"Ink"
      };
      // Populate
      Object.keys(demo).forEach(k=>{
        const el=document.getElementById(k);
        if(el) el.value = demo[k];
      });
      show("letterDataSection","letterActionsSection");
      showToast("Data Fetched Successfully!", "success");
    }

    // ---------- Global Action Handlers ----------
    function previewPrompt(){
      const data = getFormData();
      alert("Preview of prompt payload (demo):\\n\\n"+JSON.stringify(data,null,2));
    }
    function saveTemplate(){
      const data = getFormData();
      localStorage.setItem("erpTemplate", JSON.stringify(data));
      alert("Template saved locally (demo).");
    }
    function copyToClipboard(){
      navigator.clipboard.writeText(document.getElementById("contentOutput").textContent||"")
        .then(()=>showToast("Content copied to clipboard!", "success"))
        .catch(()=>showToast("Failed to copy content", "error"));
    }
    
    function showToast(message, type = "success"){
      // Remove any existing toast
      const existingToast = document.querySelector(".toast-notification");
      if(existingToast) existingToast.remove();
      
      // Create new toast
      const toast = document.createElement("div");
      toast.className = "toast-notification";
      
      if(type === "error"){
        toast.style.background = "#dc2626";
      }
      
      toast.innerHTML = `
        <span class="toast-icon">${type === "success" ? "‚úÖ" : "‚ùå"}</span>
        <span>${message}</span>
        <button class="toast-close" onclick="this.parentElement.remove()">√ó</button>
      `;
      
      document.body.appendChild(toast);
      
      // Show toast
      setTimeout(() => toast.classList.add("show"), 100);
      
      // Auto-hide after 3 seconds
      setTimeout(() => {
        toast.classList.remove("show");
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
    function regenerateContent(){
      generateContent();
    }
    function openInEmailApp(){
      const text = encodeURIComponent(document.getElementById("contentOutput").textContent||"");
      window.location.href = "mailto:?subject=Generated%20Content&body="+text;
    }
    function startNewContentItem(){
      document.getElementById("contentForm").reset();
      document.getElementById("generatedContent").classList.remove("show");
      updateAIStatus("completed");
      window.scrollTo({top:0,behavior:"smooth"});
    }

    // ---------- Letter-Specific Functions ----------
    function previewLetter(){
      const referenceNumber = document.getElementById("referenceNumber").value.trim();
      const customerName = document.getElementById("customerName").value;
      const businessName = document.getElementById("businessName").value;
      
      if (!referenceNumber || !customerName) {
        alert("Please fetch customer data first by entering a reference number.");
        return;
      }
      
      // Generate and display the letter content
      const letterContent = generateSOSDLetter();
      document.getElementById("letterContent").textContent = letterContent;
      show("letterPreviewSection");
    }

    function generateWordDocument(){
      const referenceNumber = document.getElementById("referenceNumber").value.trim();
      const customerName = document.getElementById("customerName").value;
      const businessName = document.getElementById("businessName").value;
      
      if (!referenceNumber || !customerName) {
        alert("Please fetch customer data first by entering a reference number.");
        return;
      }
      
      // Create SOSD letter content
      const letterContent = generateSOSDLetter();
      
      // For demo, create a simple download
      const blob = new Blob([letterContent], { type: "text/plain" });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `SOSD_Letter_${customerName.replace(/\s+/g, "_")}_${new Date().toISOString().slice(0,10)}.txt`;
      a.style.display = "none";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
      
      showToast("Letter Generated Successfully!", "success");
      
      console.log("SOSD letter generated for:", customerName);
    }

    function generateSOSDLetter(){
      const referenceNumber = document.getElementById("referenceNumber").value;
      const customerName = document.getElementById("customerName").value;
      const businessName = document.getElementById("businessName").value;
      const addressLine1 = document.getElementById("addressLine1").value;
      const addressLine2 = document.getElementById("addressLine2").value;
      const customerCity = document.getElementById("customerCity").value;
      const customerState = document.getElementById("customerState").value;
      const customerZip = document.getElementById("customerZip").value;
      const productType = document.getElementById("productType").value;
      
      const currentDate = new Date().toLocaleDateString("en-US", { 
        year: "numeric", 
        month: "long", 
        day: "numeric" 
      });
      
      return `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            EMPLOYEE RESPONSE PLATFORM
            SECRETARY OF STATE DECLINED LETTER
              Reference: ${referenceNumber}
                ${currentDate}
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    ${customerName}
    ${businessName}
    ${addressLine1}
    ${addressLine2 ? addressLine2 + '\n' : ''}${customerCity}, ${customerState} ${customerZip}

    Dear ${customerName},

    Thank you for your interest in the ${productType}. We have carefully reviewed your application and regret to inform you that we are unable to approve your request at this time.

    REASON FOR DECLINE:
    Secretary of State Declined ‚Äì Our verification process indicates that your business is not currently in good standing with the Secretary of State's office.

    WHAT THIS MEANS:
    Your business registration may be inactive, suspended, or have compliance issues that need to be resolved with your state's Secretary of State office.

    NEXT STEPS:
    1. Contact your Secretary of State's office to resolve any outstanding issues
    2. Ensure your business registration is active and in good standing
    3. Once resolved, you may reapply for the ${productType}

    We appreciate your interest in our business solutions and look forward to serving your needs once these requirements are met.

    If you have questions about this decision, please call our Business Customer Service line at 1-800-555-0199.

    Sincerely,

    Business Credit Review Team
    Employee Response Platform

    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    This letter was generated using the Employee Response Platform content studio.
    Reference: ${referenceNumber} | Generated: ${currentDate}
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;
    }

    function uploadToSharePoint(){
      alert("üìÇ SharePoint Upload\n\nThis would upload the generated letter to your SharePoint document library.\n\nIn production, this would:\n‚Ä¢ Upload the Word document\n‚Ä¢ Create proper metadata\n‚Ä¢ Link to the customer record\n‚Ä¢ Update tracking systems");
      console.log("SharePoint upload initiated (demo mode)");
    }

    function createSharePointFolder(){
      const referenceNumber = document.getElementById("referenceNumber").value.trim();
      const customerName = document.getElementById("customerName").value;
      
      if (!referenceNumber || !customerName) {
        alert("Please fetch customer data first.");
        return;
      }
      
      const folderName = `${referenceNumber}_${customerName.replace(/\s+/g, "_")}`;
      
      alert(`üìÅ SharePoint Folder Created\n\nFolder: ${folderName}\n\nThis would create a dedicated SharePoint folder for this customer's documents and correspondence.\n\nIn production, this would:\n‚Ä¢ Create folder structure\n‚Ä¢ Set proper permissions\n‚Ä¢ Initialize document templates\n‚Ä¢ Link to customer CRM record`);
      
      console.log("SharePoint folder creation initiated for:", folderName);
    }

    // ---------- Announcement Features ----------
    function initializeAnnouncementFeatures(){
      const dropZone = document.getElementById("dropZone");
      const fileInput = document.getElementById("announcementAttachments");
      const browseBtn = document.getElementById("browseFilesBtn");
      
      if(dropZone && fileInput && browseBtn){
        // Drag and drop handlers
        dropZone.addEventListener("dragover", (e) => {
          e.preventDefault();
          dropZone.style.borderColor = "var(--brand-primary-dark)";
          dropZone.style.backgroundColor = "rgba(0,102,178,.1)";
        });
        
        dropZone.addEventListener("dragleave", (e) => {
          e.preventDefault();
          dropZone.style.borderColor = "var(--brand-primary)";
          dropZone.style.backgroundColor = "rgba(0,102,178,.05)";
        });
        
        dropZone.addEventListener("drop", (e) => {
          e.preventDefault();
          dropZone.style.borderColor = "var(--brand-primary)";
          dropZone.style.backgroundColor = "rgba(0,102,178,.05)";
          
          const files = e.dataTransfer.files;
          fileInput.files = files;
          displaySelectedFiles(files);
        });
        
        // Click to browse
        dropZone.addEventListener("click", () => fileInput.click());
        browseBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          fileInput.click();
        });
        
        // File input change
        fileInput.addEventListener("change", (e) => {
          displaySelectedFiles(e.target.files);
        });
      }
      
      // Dynamic link inputs
      initializeDynamicLinks();
    }
    
    function displaySelectedFiles(files){
      const fileList = document.getElementById("fileList");
      const selectedFiles = document.getElementById("selectedFiles");
      
      if(files.length === 0){
        fileList.style.display = "none";
        return;
      }
      
      fileList.style.display = "block";
      selectedFiles.innerHTML = "";
      
      Array.from(files).forEach((file, index) => {
        const fileItem = document.createElement("div");
        fileItem.style.cssText = "display:flex;justify-content:space-between;align-items:center;padding:.5rem;border-bottom:1px solid #f3f4f6;";
        if(index === files.length - 1) fileItem.style.borderBottom = "none";
        
        const fileInfo = document.createElement("div");
        fileInfo.innerHTML = `<strong>${file.name}</strong> <span style="color:var(--brand-gray);font-size:.85rem;">(${formatFileSize(file.size)})</span>`;
        
        const fileType = document.createElement("span");
        fileType.textContent = getFileIcon(file.name);
        fileType.style.fontSize = "1.2rem";
        
        fileItem.appendChild(fileInfo);
        fileItem.appendChild(fileType);
        selectedFiles.appendChild(fileItem);
      });
    }
    
    function formatFileSize(bytes){
      if(bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    function getFileIcon(filename){
      const ext = filename.split('.').pop().toLowerCase();
      const icons = {
        pdf: 'üìÑ', doc: 'üìù', docx: 'üìù', xls: 'üìä', xlsx: 'üìä', 
        ppt: 'üìã', pptx: 'üìã', txt: 'üìÑ', jpg: 'üñºÔ∏è', png: 'üñºÔ∏è', gif: 'üñºÔ∏è'
      };
      return icons[ext] || 'üìé';
    }
    
    function initializeDynamicLinks(){
      // Add event listeners to existing link inputs
      for(let i = 1; i <= 5; i++){
        const linkInput = document.getElementById(`announcementLink${i}`);
        if(linkInput){
          linkInput.addEventListener("input", () => handleLinkInput(i));
        }
      }
    }
    
    function handleLinkInput(currentIndex){
      const currentInput = document.getElementById(`announcementLink${currentIndex}`);
      const nextIndex = currentIndex + 1;
      
      if(currentInput && currentInput.value.trim() && nextIndex <= 5){
        // Show next input if it doesn't exist
        if(!document.getElementById(`announcementLink${nextIndex}`)){
          createLinkInput(nextIndex);
        }
      }
    }
    
    function createLinkInput(index){
      const linkInputs = document.getElementById("linkInputs");
      
      const inputGroup = document.createElement("div");
      inputGroup.className = "link-input-group";
      inputGroup.style.marginBottom = ".5rem";
      
      const input = document.createElement("input");
      input.type = "url";
      input.id = `announcementLink${index}`;
      input.placeholder = `Enter URL ${index} (e.g., https://intranet.company.com/policy)`;
      input.style.cssText = "width:100%;padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;";
      
      input.addEventListener("input", () => handleLinkInput(index));
      
      inputGroup.appendChild(input);
      linkInputs.appendChild(inputGroup);
    }

    // ---------- Newsletter Features ----------
    function initializeNewsletterFeatures(){
      const dropZone = document.getElementById("newsletterDropZone");
      const fileInput = document.getElementById("newsletterAttachments");
      const browseBtn = document.getElementById("newsletterBrowseFilesBtn");
      
      if(dropZone && fileInput && browseBtn){
        // Drag and drop handlers
        dropZone.addEventListener("dragover", (e) => {
          e.preventDefault();
          dropZone.style.borderColor = "var(--brand-primary-dark)";
          dropZone.style.backgroundColor = "rgba(0,102,178,.1)";
        });
        
        dropZone.addEventListener("dragleave", (e) => {
          e.preventDefault();
          dropZone.style.borderColor = "var(--brand-primary)";
          dropZone.style.backgroundColor = "rgba(0,102,178,.05)";
        });
        
        dropZone.addEventListener("drop", (e) => {
          e.preventDefault();
          dropZone.style.borderColor = "var(--brand-primary)";
          dropZone.style.backgroundColor = "rgba(0,102,178,.05)";
          
          const files = e.dataTransfer.files;
          fileInput.files = files;
          displayNewsletterSelectedFiles(files);
        });
        
        // Click to browse
        dropZone.addEventListener("click", () => fileInput.click());
        browseBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          fileInput.click();
        });
        
        // File input change
        fileInput.addEventListener("change", (e) => {
          displayNewsletterSelectedFiles(e.target.files);
        });
      }
      
      // Dynamic link inputs for newsletter
      initializeNewsletterDynamicLinks();
    }
    
    function displayNewsletterSelectedFiles(files){
      const fileList = document.getElementById("newsletterFileList");
      const selectedFiles = document.getElementById("newsletterSelectedFiles");
      
      if(files.length === 0){
        fileList.style.display = "none";
        return;
      }
      
      fileList.style.display = "block";
      selectedFiles.innerHTML = "";
      
      Array.from(files).forEach((file, index) => {
        const fileItem = document.createElement("div");
        fileItem.style.cssText = "display:flex;justify-content:space-between;align-items:center;padding:.5rem;border-bottom:1px solid #f3f4f6;";
        if(index === files.length - 1) fileItem.style.borderBottom = "none";
        
        const fileInfo = document.createElement("div");
        fileInfo.innerHTML = `<strong>${file.name}</strong> <span style="color:var(--brand-gray);font-size:.85rem;">(${formatFileSize(file.size)})</span>`;
        
        const fileType = document.createElement("span");
        fileType.textContent = getFileIcon(file.name);
        fileType.style.fontSize = "1.2rem";
        
        fileItem.appendChild(fileInfo);
        fileItem.appendChild(fileType);
        selectedFiles.appendChild(fileItem);
      });
    }
    
    function initializeNewsletterDynamicLinks(){
      // Add event listeners to existing newsletter link inputs
      for(let i = 1; i <= 5; i++){
        const linkInput = document.getElementById(`newsletterLink${i}`);
        if(linkInput){
          linkInput.addEventListener("input", () => handleNewsletterLinkInput(i));
        }
      }
    }
    
    function handleNewsletterLinkInput(currentIndex){
      const currentInput = document.getElementById(`newsletterLink${currentIndex}`);
      const nextIndex = currentIndex + 1;
      
      if(currentInput && currentInput.value.trim() && nextIndex <= 5){
        // Show next input if it doesn't exist
        if(!document.getElementById(`newsletterLink${nextIndex}`)){
          createNewsletterLinkInput(nextIndex);
        }
      }
    }
    
    function createNewsletterLinkInput(index){
      const linkInputs = document.getElementById("newsletterLinkInputs");
      
      const inputGroup = document.createElement("div");
      inputGroup.className = "link-input-group";
      inputGroup.style.marginBottom = ".5rem";
      
      const input = document.createElement("input");
      input.type = "url";
      input.id = `newsletterLink${index}`;
      input.placeholder = `Enter URL ${index} (e.g., https://intranet.company.com/resource)`;
      input.style.cssText = "width:100%;padding:.7rem;border:2px solid #e5e7eb;border-radius:6px;";
      
      input.addEventListener("input", () => handleNewsletterLinkInput(index));
      
      inputGroup.appendChild(input);
      linkInputs.appendChild(inputGroup);
    }
  </script>
</body>
</html>

