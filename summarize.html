<!doctype html> <!-- HTML5 -->
<html lang="en"> <!-- Language -->
<head>
  <meta charset="utf-8" /> <!-- Encoding -->
  <meta name="viewport" content="width=device-width, initial-scale=1" /> <!-- Responsive -->
  <title>Summarize This Data</title> <!-- Tab title -->

  <style>
    /* Force visibility even if your site has global CSS elsewhere */
    html, body { height: 100%; } /* Full height */
    body {
      margin: 0; /* Remove default margin */
      background: #ffffff !important; /* Force white background */
      color: #111827 !important; /* Force dark text */
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; /* Clean font */
      display: block !important; /* Prevent body being hidden by global styles */
      visibility: visible !important; /* Prevent hidden */
      opacity: 1 !important; /* Prevent opacity 0 */
    }

    /* Debug banner to prove the page is rendering */
    .debugbar {
      background: #111827; /* Dark bar */
      color: #ffffff; /* White text */
      padding: 10px 14px; /* Spacing */
      font-size: 13px; /* Small text */
    }

    /* Layout */
    .container { max-width: 900px; margin: 28px auto; padding: 0 16px; } /* Centered page */
    .card { border: 1px solid #d1d5db; border-radius: 12px; padding: 18px; background: #fff; } /* Simple card */

    h1 { margin: 0 0 8px; font-size: 28px; } /* Title */
    p { margin: 0 0 14px; color: #4b5563; line-height: 1.4; } /* Subtitle */

    label { display: block; font-weight: 600; margin-bottom: 8px; } /* Label */
    textarea {
      width: 100%;
      min-height: 240px;
      padding: 12px;
      font-size: 14px;
      border: 1px solid #d1d5db;
      border-radius: 10px;
      box-sizing: border-box;
      background: #fff !important; /* Ensure visible */
      color: #111827 !important; /* Ensure visible */
    }

    .actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; margin-top: 12px; } /* Buttons row */
    button {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      background: #fff;
      font-weight: 600;
      cursor: pointer;
    }
    button.primary { background: #0d6efd; border-color: #0d6efd; color: #fff; } /* Primary button */
    button:disabled { opacity: 0.6; cursor: not-allowed; } /* Disabled style */

    .status { font-size: 13px; color: #6b7280; } /* Status text */
    .output {
      margin-top: 16px;
      padding: 14px;
      background: #f9fafb;
      border: 1px solid #d1d5db;
      border-radius: 10px;
      white-space: pre-wrap;
      min-height: 60px; /* So you can see the panel even before output */
      color: #111827 !important; /* Force visible */
    }

    .hint { margin-top: 10px; font-size: 12px; color: #6b7280; } /* Hint */
  </style>
</head>

<body>
  <div class="debugbar">Summarize page loaded ✅ (If you see this, HTML is rendering)</div> <!-- Debug proof -->

  <div class="container">
    <div class="card">
      <h1>Summarize this data</h1>
      <p>Paste notes, bullet points, or CSV/table-like data. Click summarize to simplify it and add context.</p>

      <label for="input">Your data</label>
      <textarea id="input" placeholder="Paste your data here..."></textarea>

      <div class="actions">
        <button id="summarizeBtn" class="primary">Summarize</button>
        <button id="clearBtn">Clear</button>
        <button id="copyBtn">Copy Output</button>
        <span id="status" class="status"></span>
      </div>

      <div id="output" class="output"></div>
      <div class="hint">Tip: Try CSV like: Month,Sales ↵ Jan,1200 ↵ Feb,1800</div>
    </div>
  </div>

  <script>
    const BACKEND_URL = "https://resume-analyzer-backend-pi.vercel.app/api/summarize"; // Your backend endpoint

    const inputEl = document.getElementById("input"); // Input box
    const outputEl = document.getElementById("output"); // Output box
    const statusEl = document.getElementById("status"); // Status label
    const summarizeBtn = document.getElementById("summarizeBtn"); // Summarize button
    const clearBtn = document.getElementById("clearBtn"); // Clear button
    const copyBtn = document.getElementById("copyBtn"); // Copy button

    function setStatus(text) { statusEl.textContent = text; } // Set status
    function setOutput(text) { outputEl.textContent = text || ""; } // Set output

    clearBtn.addEventListener("click", () => { // Clear handler
      inputEl.value = ""; // Clear input
      setOutput(""); // Clear output
      setStatus(""); // Clear status
    });

    copyBtn.addEventListener("click", async () => { // Copy handler
      try {
        await navigator.clipboard.writeText(outputEl.textContent || ""); // Copy output text
        setStatus("Copied"); // Status
        setTimeout(() => setStatus(""), 1000); // Clear status
      } catch {
        setStatus("Copy failed"); // Error status
      }
    });

    summarizeBtn.addEventListener("click", async () => { // Summarize handler
      const text = inputEl.value.trim(); // Read input
      if (!text) { setStatus("Paste something first"); return; } // Guard empty

      setStatus("Working..."); // Status
      setOutput(""); // Clear output
      summarizeBtn.disabled = true; // Disable

      try {
        const response = await fetch(BACKEND_URL, { // Call backend
          method: "POST", // POST
          headers: { "Content-Type": "application/json" }, // JSON
          body: JSON.stringify({ text }) // Send text
        });

        const data = await response.json(); // Parse JSON
        if (!response.ok) throw new Error(data.error || "Request failed"); // Handle error

        setOutput(data.output); // Show output
        setStatus("Done"); // Done
      } catch (err) {
        setOutput(err.message); // Show error
        setStatus("Error"); // Error status
      } finally {
        summarizeBtn.disabled = false; // Re-enable
      }
    });
  </script>
</body>
</html>
